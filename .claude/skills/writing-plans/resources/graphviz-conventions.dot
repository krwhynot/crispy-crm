// Style Guide for Process DSL in Implementation Plans
// Use Graphviz to visualize workflows, decision trees, and task dependencies

digraph STYLE_GUIDE {
    rankdir=TB;

    // ============================================================
    // NODE TYPES AND SHAPES
    // ============================================================

    subgraph cluster_node_types {
        label="NODE TYPES";
        style=rounded;

        // Questions are diamonds
        "Is this a question?" [shape=diamond];

        // Actions are boxes (default)
        "Take an action" [shape=box];

        // Commands are plaintext (monospace)
        "npm test" [shape=plaintext, fontname="Courier"];

        // States are ellipses
        "Current state" [shape=ellipse];

        // Warnings are octagons (red)
        "STOP: Critical warning" [shape=octagon, style=filled, fillcolor=red, fontcolor=white];

        // Entry/exit are double circles
        "Process starts" [shape=doublecircle];
        "Process complete" [shape=doublecircle];
    }

    // ============================================================
    // EDGE LABELS
    // ============================================================

    subgraph cluster_edges {
        label="EDGE LABELS";
        style=rounded;

        // Binary decisions
        "Binary?" [shape=diamond];
        "Yes path" [shape=box];
        "No path" [shape=box];

        "Binary?" -> "Yes path" [label="yes"];
        "Binary?" -> "No path" [label="no"];

        // Multiple choice
        "Multiple?" [shape=diamond];
        "Option A" [shape=box];
        "Option B" [shape=box];
        "Option C" [shape=box];

        "Multiple?" -> "Option A" [label="condition A"];
        "Multiple?" -> "Option B" [label="condition B"];
        "Multiple?" -> "Option C" [label="otherwise"];

        // Process triggers (dotted)
        "Process A done" [shape=doublecircle];
        "Process B starts" [shape=doublecircle];

        "Process A done" -> "Process B starts" [label="triggers", style=dotted];
    }

    // ============================================================
    // NAMING CONVENTIONS
    // ============================================================

    subgraph cluster_naming {
        label="NAMING PATTERNS";
        style=rounded;

        // Questions end with ?
        q1 [label="Should I do X?", shape=diamond];
        q2 [label="Is test passing?", shape=diamond];
        q3 [label="Have I read constitution?", shape=diamond];

        // Actions start with verb
        a1 [label="Write the test", shape=box];
        a2 [label="Commit changes", shape=box];
        a3 [label="Read error message", shape=box];

        // Commands are literal
        c1 [label="git status", shape=plaintext, fontname="Courier"];
        c2 [label="npm run build", shape=plaintext, fontname="Courier"];

        // States describe situation
        s1 [label="Test is failing", shape=ellipse];
        s2 [label="Build complete", shape=ellipse];
    }

    // ============================================================
    // TDD WORKFLOW EXAMPLE (for implementation plans)
    // ============================================================

    subgraph cluster_tdd {
        label="TDD WORKFLOW";
        style=rounded;
        color=blue;

        tdd_start [label="Start Task N", shape=doublecircle];
        tdd_read [label="Read constitution?", shape=diamond];
        tdd_stop1 [label="STOP: Read it first", shape=octagon, style=filled, fillcolor=red, fontcolor=white];

        tdd_write [label="Write failing test", shape=box];
        tdd_run1 [label="npm test", shape=plaintext, fontname="Courier"];
        tdd_fail [label="Does test fail?", shape=diamond];
        tdd_stop2 [label="STOP: Test must fail first", shape=octagon, style=filled, fillcolor=red, fontcolor=white];

        tdd_impl [label="Implement minimal code", shape=box];
        tdd_run2 [label="npm test", shape=plaintext, fontname="Courier"];
        tdd_pass [label="Does test pass?", shape=diamond];
        tdd_debug [label="Debug implementation", shape=box];

        tdd_check [label="Constitution compliant?", shape=diamond];
        tdd_stop3 [label="STOP: Fix violations", shape=octagon, style=filled, fillcolor=red, fontcolor=white];

        tdd_commit [label="git add && git commit", shape=plaintext, fontname="Courier"];
        tdd_done [label="Task Complete", shape=doublecircle];

        // Flow
        tdd_start -> tdd_read;
        tdd_read -> tdd_stop1 [label="no"];
        tdd_read -> tdd_write [label="yes"];
        tdd_write -> tdd_run1;
        tdd_run1 -> tdd_fail;
        tdd_fail -> tdd_stop2 [label="no (passes)"];
        tdd_fail -> tdd_impl [label="yes (fails)"];
        tdd_impl -> tdd_run2;
        tdd_run2 -> tdd_pass;
        tdd_pass -> tdd_debug [label="no"];
        tdd_pass -> tdd_check [label="yes"];
        tdd_debug -> tdd_run2;
        tdd_check -> tdd_stop3 [label="no"];
        tdd_check -> tdd_commit [label="yes"];
        tdd_commit -> tdd_done;
    }

    // ============================================================
    // SHAPE DECISION TREE
    // ============================================================

    subgraph cluster_choose_shape {
        label="CHOOSING A SHAPE";
        style=rounded;
        color=green;

        choose [label="What type of node?", shape=ellipse];

        is_decision [label="Is it a decision?", shape=diamond];
        use_diamond [label="Use diamond", shape=diamond, style=filled, fillcolor=lightblue];

        is_command [label="Is it a shell command?", shape=diamond];
        use_plaintext [label="Use plaintext", shape=plaintext];

        is_warning [label="Is it a warning?", shape=diamond];
        use_octagon [label="Use octagon (red)", shape=octagon, style=filled, fillcolor=pink];

        is_entry [label="Is it entry/exit?", shape=diamond];
        use_double [label="Use doublecircle", shape=doublecircle, style=filled, fillcolor=lightgreen];

        is_state [label="Is it a state?", shape=diamond];
        use_ellipse [label="Use ellipse", shape=ellipse, style=filled, fillcolor=lightyellow];

        use_box [label="Default: use box", shape=box, style=filled, fillcolor=lightcyan];

        choose -> is_decision;
        is_decision -> use_diamond [label="yes"];
        is_decision -> is_command [label="no"];
        is_command -> use_plaintext [label="yes"];
        is_command -> is_warning [label="no"];
        is_warning -> use_octagon [label="yes"];
        is_warning -> is_entry [label="no"];
        is_entry -> use_double [label="yes"];
        is_entry -> is_state [label="no"];
        is_state -> use_ellipse [label="yes"];
        is_state -> use_box [label="no"];
    }

    // ============================================================
    // ANTI-PATTERNS (what NOT to do)
    // ============================================================

    subgraph cluster_bad {
        label="ANTI-PATTERNS (DON'T DO THIS)";
        style=rounded;
        color=red;

        bad_1 [label="Something wrong", shape=box];  // Should be ellipse (state)
        bad_2 [label="Fix it", shape=box];  // Too vague - what specifically?
        bad_3 [label="Check", shape=box];  // Should be diamond (decision)
        bad_4 [label="Run command", shape=box];  // Should be plaintext with ACTUAL command

        bad_1 -> bad_2 [label="???"];  // No clear conditions
        bad_2 -> bad_3;
        bad_3 -> bad_4;
    }
}

// ============================================================
// QUICK REFERENCE
// ============================================================
//
// SHAPES:
//   diamond     = decision/question (ends with ?)
//   box         = action (starts with verb)
//   plaintext   = shell command (literal)
//   ellipse     = state/situation
//   octagon+red = warning/stop
//   doublecircle = entry/exit point
//
// EDGES:
//   solid       = normal flow
//   dotted      = triggers/optional
//   labels      = conditions (yes/no, specific values)
//
// NAMING:
//   Questions: "Is X true?" "Should I do Y?" "Have I done Z?"
//   Actions: "Write the test" "Commit changes" "Read error"
//   Commands: "npm test" "git status" (literal, monospace)
//   States: "Test failing" "Build complete" "Stuck on error"
//
// USAGE IN PLANS:
//   Include Graphviz in code blocks for complex workflows
//   Render with: dot -Tpng workflow.dot -o workflow.png
//   Or use online: https://dreampuf.github.io/GraphvizOnline/
