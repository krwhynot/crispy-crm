{
  "version": "1.0",
  "description": "Skill activation triggers for Crispy-CRM",
  "agents": {
    "sienna-ux": {
      "description": "UI/UX Auditor agent - audits components for accessibility, design system compliance, and UX violations",
      "requiredSkills": ["ui-ux-design-principles", "enforcing-principles"],
      "promptTriggers": {
        "keywords": [
          "sienna",
          "sienna-ux",
          "ui audit",
          "ux audit",
          "accessibility audit",
          "design audit",
          "component audit",
          "review component",
          "audit component"
        ],
        "intentPatterns": [
          "(use|invoke|ask|have).*?sienna",
          "(audit|review|check|analyze).*?(component|ui|ux|accessibility|design)",
          "sienna.*?(audit|review|check)"
        ]
      }
    }
  },
  "skills": {
    "enforcing-principles": {
      "type": "guardrail",
      "enforcement": "hybrid",
      "priority": "critical",
      "description": "Engineering Constitution enforcement - BLOCKS anti-patterns (retry logic, circuit breakers), SUGGESTS best practices (fail-fast, Zod validation, form defaults from schema)",
      "promptTriggers": {
        "keywords": [
          "implement",
          "feature",
          "error handling",
          "validation",
          "form",
          "defaults",
          "zod",
          "schema",
          "migration",
          "database",
          "retry",
          "circuit breaker",
          "resilience",
          "fallback",
          "data provider",
          "unified provider",
          "react admin",
          "interface",
          "type"
        ],
        "intentPatterns": [
          "(implement|create|build|add).*?(feature|form|validation|migration)",
          "(handle|add|implement).*?(error|resilience|retry|fallback)",
          "(create|add|modify).*?(schema|validation|zod)",
          "(set|define|add).*?(default|form)",
          "how.*?(validate|handle error|create form)",
          "(database|db|migration).*?(change|update|create)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/atomic-crm/**/*.tsx",
          "src/atomic-crm/**/*.ts",
          "src/atomic-crm/providers/**/*.ts",
          "src/atomic-crm/validation/**/*.ts",
          "supabase/migrations/**/*.sql"
        ],
        "contentPatterns": [
          "CircuitBreaker",
          "maxRetries",
          "MAX_RETRIES",
          "exponential.*backoff",
          "retry.*logic",
          "class.*CircuitBreaker",
          "graceful.*fallback",
          "catch.*return.*cached",
          "defaultValue=",
          "defaultValues:\\s*\\{",
          "validate=\\{",
          "\\.safeParse\\(",
          "z\\.object\\(",
          "import.*from.*react-admin"
        ]
      },
      "blockPatterns": {
        "description": "Anti-patterns that should BLOCK and require skill review",
        "patterns": [
          "class\\s+CircuitBreaker",
          "for\\s*\\(.*MAX_RETRIES",
          "exponential.*backoff",
          "Math\\.pow\\(2,.*\\).*\\*.*1000",
          "catch.*\\{[^}]*return.*cached",
          "state:\\s*['\"]OPEN['\"]\\s*\\|\\s*['\"]CLOSED['\"]"
        ]
      }
    },
    "skill-developer": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Meta-skill for creating and managing Claude Code skills",
      "promptTriggers": {
        "keywords": [
          "skill system",
          "create skill",
          "add skill",
          "skill triggers",
          "skill rules",
          "skill development"
        ],
        "intentPatterns": [
          "(how do|how does|explain).*?skill",
          "(create|add|modify|build).*?skill",
          "skill.*?(work|trigger|activate|system)"
        ]
      }
    },
    "ui-ux-design-principles": {
      "type": "guardrail",
      "enforcement": "suggest",
      "priority": "high",
      "description": "UI/UX design principles, UX laws (Jakob's, Hick's, Fitts's), accessibility, color theory, cognitive load, touch targets, decision matrix, Sienna protocol",
      "promptTriggers": {
        "keywords": [
          "design",
          "UX",
          "UI",
          "user experience",
          "usability",
          "accessibility",
          "a11y",
          "color",
          "contrast",
          "touch target",
          "44px",
          "cognitive load",
          "Hick's Law",
          "Fitts's Law",
          "Jakob's Law",
          "Miller's Law",
          "decision matrix",
          "audit",
          "component",
          "button",
          "form",
          "layout",
          "responsive",
          "mobile",
          "tablet",
          "desktop",
          "WCAG",
          "ARIA",
          "semantic",
          "spacing",
          "typography",
          "elevation",
          "feedback",
          "loading state",
          "toast"
        ],
        "intentPatterns": [
          "(create|build|design|implement).*?(component|ui|interface|button|form|layout)",
          "(audit|review|evaluate|assess).*?(ui|ux|design|usability|accessibility)",
          "(improve|fix|optimize).*?(accessibility|usability|ux|ui)",
          "(check|verify|ensure).*?(contrast|touch|target|accessible)",
          "(style|styling|css|tailwind).*",
          "how.*?(look|appear|design|accessible)",
          "(tablet|ipad|mobile|responsive).*?(design|layout|view)",
          "what.*?(color|spacing|size|font)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": ["src/components/**/*.tsx", "src/pages/**/*.tsx", "src/layouts/**/*.tsx", "src/atomic-crm/**/*.tsx"],
        "contentPatterns": ["className=", "tailwind", "bg-", "text-", "aria-", "role="]
      }
    },
    "writing-plans": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Use when creating implementation plans, execution plans, task plans, or agent plans. Applies TDD principles to planning - write plans that guide AI agents with zero context. Integrates with engineering constitution, uses persuasion principles for compliance, includes process visualization via Graphviz.",
      "promptTriggers": {
        "keywords": [
          "plan",
          "planning",
          "implementation plan",
          "execution plan",
          "task breakdown",
          "write plan",
          "create plan",
          "agent instructions",
          "zero context",
          "parallel agents",
          "task dependencies",
          "dependency map"
        ],
        "intentPatterns": [
          "(write|create|build|draft).*?plan",
          "(implementation|execution|task).*?plan",
          "plan.*?(feature|task|implementation)",
          "(break down|decompose).*?(task|feature|work)",
          "how.*?(plan|break down|decompose)",
          "agent.*?(instructions|execution|plan)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "docs/plans/**/*.md"
        ],
        "contentPatterns": [
          "Implementation Plan",
          "Task Dependencies",
          "Constitution Principles In Play",
          "For Executing Agent"
        ]
      }
    },
    "dispatching-parallel-agents": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Use when facing 3+ independent tasks, failures, or file changes that can be worked on without shared state - dispatches multiple Claude agents to work concurrently",
      "promptTriggers": {
        "keywords": [
          "parallel",
          "concurrent",
          "dispatch agents",
          "multiple agents",
          "parallel agents",
          "independent tasks",
          "batch fix",
          "fix all tests",
          "multiple failures",
          "multiple bugs",
          "several failures",
          "3 tests",
          "multiple test files",
          "all failing",
          "independent problems"
        ],
        "intentPatterns": [
          "(dispatch|run|launch|spawn).*?(agents?|tasks?).*?(parallel|concurrent)",
          "(parallel|concurrent).*?(agents?|tasks?|work|fix)",
          "(fix|investigate|implement).*?(all|multiple|several|3\\+?).*?(tests?|files?|bugs?|issues?|features?)",
          "(multiple|several|3\\+?).*?(independent|unrelated).*?(tasks?|problems?|issues?)",
          "work.*?on.*?(multiple|several).*?(things?|tasks?|files?).*?(at once|simultaneously|concurrently)",
          "(tests?|files?).*?failing.*?(independently|separately|unrelated)",
          "(have|got|there are|seeing).*?(\\d+|multiple|several).*?(tests?|files?).*?failing",
          "(\\d+).*?(tests?|errors?|failures?).*?(different|separate|various).*?files?"
        ]
      }
    },
    "supabase-crm": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Supabase backend patterns, RLS policies, Edge Functions, query optimization, and migration best practices",
      "promptTriggers": {
        "keywords": [
          "supabase",
          "database",
          "query",
          "RLS",
          "edge function",
          "backend",
          "api",
          "service layer",
          "migration",
          "migrate",
          "schema",
          "CREATE VIEW",
          "ALTER TABLE",
          "GRANT",
          "RLS policy",
          "database view",
          "sql migration",
          "row level security",
          "permissions",
          "postgres",
          "postgresql"
        ],
        "intentPatterns": [
          "(create|build|write).*?(query|function|api|migration|schema|view|table|policy)",
          "(database|backend|supabase).*",
          "how.*?(query|fetch|insert|update|delete)",
          "(create|write|refactor|update).*?(migration|schema|view|table)",
          "(add|modify|update|fix).*?(table|view|policy|permission)",
          "migration.*?(file|pattern|template|best practice)",
          "(deploy|push|apply).*?(migration|schema)",
          "(grant|revoke).*?(select|insert|update|delete)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/services/**/*.ts",
          "src/lib/supabase/**/*.ts",
          "supabase/functions/**/*.ts",
          "supabase/migrations/**/*.sql"
        ],
        "contentPatterns": [
          "import.*supabase",
          "\\.from\\(",
          "\\.select\\(",
          "createClient",
          "RLS",
          "CREATE (TABLE|VIEW|FUNCTION|POLICY|INDEX)",
          "ALTER (TABLE|VIEW)",
          "GRANT (SELECT|INSERT|UPDATE|DELETE)",
          "ROW LEVEL SECURITY",
          "ENABLE ROW LEVEL SECURITY",
          "-- ====="
        ]
      }
    }
  }
}
