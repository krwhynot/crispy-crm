{
  "version": "1.0",
  "description": "Skill activation triggers for Crispy-CRM",
  "agents": {
    "sienna-ux": {
      "description": "UI/UX Auditor agent - audits components for accessibility, design system compliance, and UX violations",
      "requiredSkills": ["ui-ux-design-principles", "enforcing-principles"],
      "promptTriggers": {
        "keywords": [
          "sienna",
          "sienna-ux",
          "ui audit",
          "ux audit",
          "accessibility audit",
          "design audit",
          "component audit",
          "review component",
          "audit component"
        ],
        "intentPatterns": [
          "(use|invoke|ask|have).*?sienna",
          "(audit|review|check|analyze).*?(component|ui|ux|accessibility|design)",
          "sienna.*?(audit|review|check)"
        ]
      }
    }
  },
  "skills": {
    "enforcing-principles": {
      "type": "guardrail",
      "enforcement": "hybrid",
      "priority": "critical",
      "description": "Engineering Constitution enforcement - BLOCKS anti-patterns (retry logic, circuit breakers), SUGGESTS best practices (fail-fast, Zod validation, form defaults from schema)",
      "promptTriggers": {
        "keywords": [
          "implement",
          "feature",
          "error handling",
          "validation",
          "form",
          "defaults",
          "zod",
          "schema",
          "migration",
          "database",
          "retry",
          "circuit breaker",
          "resilience",
          "fallback",
          "data provider",
          "unified provider",
          "react admin",
          "interface",
          "type"
        ],
        "intentPatterns": [
          "(implement|create|build|add).*?(feature|form|validation|migration)",
          "(handle|add|implement).*?(error|resilience|retry|fallback)",
          "(create|add|modify).*?(schema|validation|zod)",
          "(set|define|add).*?(default|form)",
          "how.*?(validate|handle error|create form)",
          "(database|db|migration).*?(change|update|create)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/atomic-crm/**/*.tsx",
          "src/atomic-crm/**/*.ts",
          "src/atomic-crm/providers/**/*.ts",
          "src/atomic-crm/validation/**/*.ts",
          "supabase/migrations/**/*.sql"
        ],
        "contentPatterns": [
          "CircuitBreaker",
          "maxRetries",
          "MAX_RETRIES",
          "exponential.*backoff",
          "retry.*logic",
          "class.*CircuitBreaker",
          "graceful.*fallback",
          "catch.*return.*cached",
          "defaultValue=",
          "defaultValues:\\s*\\{",
          "validate=\\{",
          "\\.safeParse\\(",
          "z\\.object\\(",
          "import.*from.*react-admin"
        ]
      },
      "blockPatterns": {
        "description": "Anti-patterns that should BLOCK and require skill review",
        "patterns": [
          "class\\s+CircuitBreaker",
          "for\\s*\\(.*MAX_RETRIES",
          "exponential.*backoff",
          "Math\\.pow\\(2,.*\\).*\\*.*1000",
          "catch.*\\{[^}]*return.*cached",
          "state:\\s*['\"]OPEN['\"]\\s*\\|\\s*['\"]CLOSED['\"]"
        ]
      }
    },
    "skill-developer": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Meta-skill for creating and managing Claude Code skills",
      "promptTriggers": {
        "keywords": [
          "skill system",
          "create skill",
          "add skill",
          "skill triggers",
          "skill rules",
          "skill development"
        ],
        "intentPatterns": [
          "(how do|how does|explain).*?skill",
          "(create|add|modify|build).*?skill",
          "skill.*?(work|trigger|activate|system)"
        ]
      }
    },
    "ui-ux-design-principles": {
      "type": "guardrail",
      "enforcement": "suggest",
      "priority": "high",
      "description": "UI/UX design principles, UX laws (Jakob's, Hick's, Fitts's), accessibility, color theory, cognitive load, touch targets, decision matrix, Sienna protocol",
      "promptTriggers": {
        "keywords": [
          "design",
          "UX",
          "UI",
          "user experience",
          "usability",
          "accessibility",
          "a11y",
          "color",
          "contrast",
          "touch target",
          "44px",
          "cognitive load",
          "Hick's Law",
          "Fitts's Law",
          "Jakob's Law",
          "Miller's Law",
          "decision matrix",
          "audit",
          "component",
          "button",
          "form",
          "layout",
          "responsive",
          "mobile",
          "tablet",
          "desktop",
          "WCAG",
          "ARIA",
          "semantic",
          "spacing",
          "typography",
          "elevation",
          "feedback",
          "loading state",
          "toast"
        ],
        "intentPatterns": [
          "(create|build|design|implement).*?(component|ui|interface|button|form|layout)",
          "(audit|review|evaluate|assess).*?(ui|ux|design|usability|accessibility)",
          "(improve|fix|optimize).*?(accessibility|usability|ux|ui)",
          "(check|verify|ensure).*?(contrast|touch|target|accessible)",
          "(style|styling|css|tailwind).*",
          "how.*?(look|appear|design|accessible)",
          "(tablet|ipad|mobile|responsive).*?(design|layout|view)",
          "what.*?(color|spacing|size|font)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": ["src/components/**/*.tsx", "src/pages/**/*.tsx", "src/layouts/**/*.tsx", "src/atomic-crm/**/*.tsx"],
        "contentPatterns": ["className=", "tailwind", "bg-", "text-", "aria-", "role="]
      }
    },
    "writing-plans": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Use when creating implementation plans, execution plans, task plans, or agent plans. Applies TDD principles to planning - write plans that guide AI agents with zero context. Integrates with engineering constitution, uses persuasion principles for compliance, includes process visualization via Graphviz.",
      "promptTriggers": {
        "keywords": [
          "plan",
          "planning",
          "implementation plan",
          "execution plan",
          "task breakdown",
          "write plan",
          "create plan",
          "agent instructions",
          "zero context",
          "parallel agents",
          "task dependencies",
          "dependency map"
        ],
        "intentPatterns": [
          "(write|create|build|draft).*?plan",
          "(implementation|execution|task).*?plan",
          "plan.*?(feature|task|implementation)",
          "(break down|decompose).*?(task|feature|work)",
          "how.*?(plan|break down|decompose)",
          "agent.*?(instructions|execution|plan)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "docs/plans/**/*.md"
        ],
        "contentPatterns": [
          "Implementation Plan",
          "Task Dependencies",
          "Constitution Principles In Play",
          "For Executing Agent"
        ]
      }
    },
    "dispatching-parallel-agents": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Use when facing 3+ independent tasks, failures, or file changes that can be worked on without shared state - dispatches multiple Claude agents to work concurrently",
      "promptTriggers": {
        "keywords": [
          "parallel",
          "concurrent",
          "dispatch agents",
          "multiple agents",
          "parallel agents",
          "independent tasks",
          "batch fix",
          "fix all tests",
          "multiple failures",
          "multiple bugs",
          "several failures",
          "3 tests",
          "multiple test files",
          "all failing",
          "independent problems"
        ],
        "intentPatterns": [
          "(dispatch|run|launch|spawn).*?(agents?|tasks?).*?(parallel|concurrent)",
          "(parallel|concurrent).*?(agents?|tasks?|work|fix)",
          "(fix|investigate|implement).*?(all|multiple|several|3\\+?).*?(tests?|files?|bugs?|issues?|features?)",
          "(multiple|several|3\\+?).*?(independent|unrelated).*?(tasks?|problems?|issues?)",
          "work.*?on.*?(multiple|several).*?(things?|tasks?|files?).*?(at once|simultaneously|concurrently)",
          "(tests?|files?).*?failing.*?(independently|separately|unrelated)",
          "(have|got|there are|seeing).*?(\\d+|multiple|several).*?(tests?|files?).*?failing",
          "(\\d+).*?(tests?|errors?|failures?).*?(different|separate|various).*?files?"
        ]
      }
    },
    "executing-plans": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Use when executing implementation plans, running plan tasks, working through planned work. Provides batch execution with smart dependency grouping, Zen MCP integration for blockers, and constitution compliance checkpoints. Pairs with writing-plans skill.",
      "requiredSkills": ["enforcing-principles"],
      "promptTriggers": {
        "keywords": [
          "execute plan",
          "run plan",
          "implement plan",
          "work through tasks",
          "follow plan",
          "plan execution",
          "batch execution",
          "checkpoint",
          "blocker",
          "run the plan",
          "execute the plan",
          "start execution",
          "continue plan",
          "resume plan",
          "next batch",
          "proceed with plan"
        ],
        "intentPatterns": [
          "(execute|run|implement|start|begin|continue|resume).*?plan",
          "(work|go) through.*?(plan|tasks?)",
          "(follow|use).*?plan.*?(step|task)",
          "plan.*?(execution|implementation)",
          "(next|continue|proceed).*?batch",
          "checkpoint.*?(report|review|approval)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "docs/plans/**/*.md"
        ],
        "contentPatterns": [
          "Implementation Plan",
          "Task Dependencies",
          "For Executing Agent",
          "Batch [A-Z]:",
          "Tasks \\[\\d"
        ]
      }
    },
    "subagent-driven-development": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Execute implementation plans by dispatching fresh subagents per task with code review between feature areas. TDD-first, quality gates, full test verification.",
      "requiredSkills": ["writing-plans", "enforcing-principles"],
      "promptTriggers": {
        "keywords": [
          "subagent",
          "dispatch subagent",
          "fresh agent",
          "execute plan with subagents",
          "subagent-driven",
          "quality gates",
          "task execution",
          "dispatch task",
          "implement with subagent",
          "fresh context",
          "context pollution",
          "TDD execution",
          "execute tasks sequentially"
        ],
        "intentPatterns": [
          "(dispatch|spawn|launch).*?(subagent|fresh agent|new agent).*?task",
          "(execute|implement|run).*?plan.*?(subagent|fresh agent|quality)",
          "subagent.*?(per|each|every).*?task",
          "(fresh|clean|new).*?(context|agent).*?(task|implementation)",
          "(avoid|prevent).*?context.*?pollution",
          "(review|check).*?(between|after).*?(task|feature)",
          "quality.*?gate.*?(task|implementation)"
        ]
      }
    },
    "brainstorming": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Use when creating or developing features, before writing code - refines rough ideas into fully-formed designs through collaborative multiple-choice questioning, alternative exploration (3-5 options), and incremental validation. MFB CRM domain-aware. Hands off to /write-plan.",
      "requiredSkills": ["enforcing-principles"],
      "promptTriggers": {
        "keywords": [
          "brainstorm",
          "brainstorming",
          "ideate",
          "ideation",
          "design feature",
          "explore options",
          "thinking about",
          "want to build",
          "want to add",
          "new feature",
          "feature idea",
          "how should we",
          "what if we",
          "consider alternatives",
          "rough idea",
          "concept",
          "before coding",
          "before implementing"
        ],
        "intentPatterns": [
          "(brainstorm|ideate|explore|think about).*?(feature|idea|concept|approach)",
          "(i'm|i am|we're|we are).*?thinking about.*?(adding|building|creating)",
          "(want|need|should) to (build|add|create|implement).*?(feature|capability)",
          "(how|what) (should|could|would) we.*?(implement|build|design|approach)",
          "(explore|consider|evaluate).*?(options|alternatives|approaches)",
          "before (coding|implementing|writing code).*?(want|need|should)",
          "(new|rough|initial).*?(idea|concept|feature).*?(for|about)",
          "(design|plan|architect).*?before.*?(implement|code|build)"
        ]
      }
    },
    "data-integrity-guards": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Defense-in-depth validation pattern - validates data at EVERY layer: API boundary (Zod), form state (schema defaults), database (RLS/soft-delete), and logging. Makes bugs structurally impossible.",
      "promptTriggers": {
        "keywords": [
          "validation",
          "data flow",
          "integrity",
          "security",
          "guards",
          "layers",
          "defense in depth",
          "multi-layer",
          "Zod",
          "RLS",
          "form defaults",
          "soft delete",
          "audit",
          "data corruption",
          "sanitize",
          "boundary",
          "checkpoint"
        ],
        "intentPatterns": [
          "(validate|check|verify).*?(data|input|form|request)",
          "(add|implement|create).*?(validation|guard|check)",
          "(data|input).*?(flow|path|journey)",
          "(where|how).*?(validate|check|verify)",
          "(prevent|stop|catch).*?(invalid|bad|corrupt).*?data",
          "(ensure|guarantee|enforce).*?(integrity|valid|correct)",
          "defense.*?in.*?depth",
          "(multiple|multi).*?layer.*?(validation|check)",
          "(zod|schema).*?(validate|boundary|api)",
          "(rls|row level security).*?(policy|check)",
          "(soft|hard).*?delete"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/atomic-crm/providers/**/*.ts",
          "src/atomic-crm/validation/**/*.ts",
          "src/atomic-crm/**/*Create.tsx",
          "src/atomic-crm/**/*Edit.tsx",
          "src/atomic-crm/**/*Form.tsx",
          "supabase/functions/**/*.ts",
          "supabase/migrations/**/*.sql"
        ],
        "contentPatterns": [
          "z\\.object\\(",
          "\\.safeParse\\(",
          "\\.parse\\(",
          "superRefine",
          "ValidationService",
          "validateContactForm",
          "validateOrganization",
          "partial\\(\\)\\.parse",
          "defaultValues",
          "CREATE POLICY",
          "ROW LEVEL SECURITY",
          "deleted_at",
          "logger\\.error"
        ]
      }
    },
    "supabase-crm": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Supabase backend patterns, RLS policies, Edge Functions, query optimization, and migration best practices",
      "promptTriggers": {
        "keywords": [
          "supabase",
          "database",
          "query",
          "RLS",
          "edge function",
          "backend",
          "api",
          "service layer",
          "migration",
          "migrate",
          "schema",
          "CREATE VIEW",
          "ALTER TABLE",
          "GRANT",
          "RLS policy",
          "database view",
          "sql migration",
          "row level security",
          "permissions",
          "postgres",
          "postgresql"
        ],
        "intentPatterns": [
          "(create|build|write).*?(query|function|api|migration|schema|view|table|policy)",
          "(database|backend|supabase).*",
          "how.*?(query|fetch|insert|update|delete)",
          "(create|write|refactor|update).*?(migration|schema|view|table)",
          "(add|modify|update|fix).*?(table|view|policy|permission)",
          "migration.*?(file|pattern|template|best practice)",
          "(deploy|push|apply).*?(migration|schema)",
          "(grant|revoke).*?(select|insert|update|delete)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/services/**/*.ts",
          "src/lib/supabase/**/*.ts",
          "supabase/functions/**/*.ts",
          "supabase/migrations/**/*.sql"
        ],
        "contentPatterns": [
          "import.*supabase",
          "\\.from\\(",
          "\\.select\\(",
          "createClient",
          "RLS",
          "CREATE (TABLE|VIEW|FUNCTION|POLICY|INDEX)",
          "ALTER (TABLE|VIEW)",
          "GRANT (SELECT|INSERT|UPDATE|DELETE)",
          "ROW LEVEL SECURITY",
          "ENABLE ROW LEVEL SECURITY",
          "-- ====="
        ]
      }
    }
  }
}
