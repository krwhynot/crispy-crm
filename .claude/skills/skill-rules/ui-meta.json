{
  "domain": "ui-meta",
  "description": "Skills for UI/UX design, data providers, skill development, feedback, and testing",
  "skills": {
    "ui-ux-design-principles": {
      "type": "guardrail",
      "enforcement": "suggest",
      "priority": "high",
      "description": "UI/UX design principles, UX laws (Jakob's, Hick's, Fitts's), accessibility, color theory, cognitive load, touch targets. NEW: Form accessibility (aria-invalid, role='alert', aria-describedby, focus management).",
      "promptTriggers": {
        "keywords": [
          "design",
          "UX",
          "UI",
          "user experience",
          "usability",
          "accessibility",
          "a11y",
          "color",
          "contrast",
          "touch target",
          "44px",
          "cognitive load",
          "Hick's Law",
          "Fitts's Law",
          "Jakob's Law",
          "Miller's Law",
          "decision matrix",
          "audit",
          "component",
          "button",
          "form",
          "layout",
          "responsive",
          "mobile",
          "tablet",
          "desktop",
          "WCAG",
          "ARIA",
          "semantic",
          "spacing",
          "typography",
          "elevation",
          "feedback",
          "loading state",
          "toast",
          "aria-invalid",
          "aria-describedby",
          "role alert",
          "screen reader",
          "form error",
          "validation error",
          "error message",
          "focus management",
          "label",
          "htmlFor"
        ],
        "intentPatterns": [
          "(create|build|design|implement).*?(component|ui|interface|button|form|layout)",
          "(audit|review|evaluate|assess).*?(ui|ux|design|usability|accessibility)",
          "(improve|fix|optimize).*?(accessibility|usability|ux|ui)",
          "(check|verify|ensure).*?(contrast|touch|target|accessible)",
          "(style|styling|css|tailwind).*",
          "how.*?(look|appear|design|accessible)",
          "(tablet|ipad|mobile|responsive).*?(design|layout|view)",
          "what.*?(color|spacing|size|font)",
          "(form|input|field).*?(accessibility|accessible|aria|screen reader)",
          "(error|validation).*?(message|display|announce|accessible)",
          "(focus|keyboard).*?(management|navigation|trap)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/components/**/*.tsx",
          "src/pages/**/*.tsx",
          "src/layouts/**/*.tsx",
          "src/atomic-crm/**/*.tsx"
        ],
        "contentPatterns": ["className=", "tailwind", "bg-", "text-", "aria-", "role="]
      }
    },
    "crispy-data-provider": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Data Provider architecture rules - Strangler Fig migration (new resources in handlers/, shrink unifiedDataProvider.ts), View/Table duality (read from views, write to tables), validation at Handler boundary (Zod, not forms), Service layer encapsulation, soft deletes, explicit handler composition.",
      "requiredSkills": ["enforcing-principles", "data-integrity-guards"],
      "promptTriggers": {
        "keywords": [
          "data provider",
          "data handler",
          "unifiedDataProvider",
          "unified provider",
          "composedDataProvider",
          "composed provider",
          "create handler",
          "add handler",
          "new resource",
          "add resource",
          "CRUD",
          "getList",
          "getOne",
          "create",
          "update",
          "delete",
          "React Admin handler",
          "react-admin handler",
          "Supabase query",
          "supabase handler",
          "strangler fig",
          "migration pattern",
          "view table",
          "view duality",
          "read from view",
          "write to table",
          "computed fields",
          "strip fields",
          "service layer",
          "soft delete",
          "handler composition",
          "withValidation",
          "withErrorLogging",
          "withLifecycleCallbacks",
          "lifecycle callbacks",
          "HttpError",
          "data provider error",
          "service",
          "business logic",
          "workflow",
          "orchestrate",
          "multi-step",
          "zod",
          "schema",
          "validation",
          "parse",
          "safeParse",
          "rpc",
          "postgres function",
          "raw query",
          "supabase.rpc",
          "call function",
          "database function"
        ],
        "intentPatterns": [
          "(create|add|implement|build).*?(data provider|handler|resource)",
          "(modify|update|change|fix).*?(data provider|unifiedDataProvider|handler)",
          "(add|create|implement).*?(CRUD|getList|getOne|create|update|delete)",
          "(migrate|move|extract).*?(resource|handler|provider)",
          "(read|query|fetch).*?(from|view|table)",
          "(write|insert|update).*?(to|table)",
          "(strip|remove|clean).*?(computed|view).*?field",
          "(compose|wrap|decorate).*?handler",
          "(service|business).*?layer",
          "(soft|hard).*?delete",
          "how.*?(data provider|handler|resource).*?(work|implement|create)",
          "(strangler|migration).*?(fig|pattern)",
          "(view|table).*?(duality|separation|pattern)",
          "(put|place|add).*?(logic|workflow|sync).*?(handler|provider|service)",
          "(where|how).*?(business logic|workflow|orchestrat)",
          "(call|invoke|use).*?(rpc|postgres function|database function)",
          "(validate|parse|check).*?(schema|zod|input)",
          "(sync|coordinate|multi-step).*?(operation|workflow|action)"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/atomic-crm/providers/**/*.ts",
          "src/atomic-crm/providers/supabase/**/*.ts",
          "src/providers/**/*.ts",
          "src/services/**/*.ts"
        ],
        "contentPatterns": [
          "unifiedDataProvider",
          "composedDataProvider",
          "getList.*?params",
          "getOne.*?params",
          "create.*?params",
          "update.*?params",
          "\\.from\\(['\"]\\w+_summary['\"]\\)",
          "withValidation",
          "withErrorLogging",
          "withLifecycleCallbacks",
          "HttpError",
          "deleted_at.*?new Date",
          "stripComputedFields",
          "TransformService",
          "\\.rpc\\(",
          "z\\.object\\(",
          "\\.safeParse\\(",
          "\\.parse\\(",
          "supabase\\.rpc",
          "ZodError"
        ]
      },
      "antiPatterns": {
        "description": "Patterns that violate data provider architecture - trigger warning",
        "patterns": [
          "unifiedDataProvider.*?=.*?\\{",
          "\\.from\\(['\"]\\w+_summary['\"]\\)\\.insert",
          "\\.from\\(['\"]\\w+_summary['\"]\\)\\.update",
          "\\.delete\\(\\)",
          "createAutoHandler",
          "magicCRUD",
          "supabase\\.rpc.*?\\w+Handler",
          "\\.rpc\\(['\"]\\w+['\"]\\)(?!.*Service)"
        ]
      },
      "architectureWarnings": {
        "rpcDuplication": {
          "description": "RPC calls should be wrapped in Services to avoid duplication",
          "pattern": "\\.rpc\\(",
          "recommendation": "Check if this RPC is already wrapped in a Service before calling directly"
        },
        "validationInHandler": {
          "description": "Validation should use withValidation wrapper, not inline",
          "pattern": "z\\.object\\(.*?\\)\\.parse\\(",
          "recommendation": "Use withValidation(handler, schema) wrapper for consistent error handling"
        },
        "businessLogicInProvider": {
          "description": "Multi-step operations should be in Service layer",
          "pattern": "await.*?await.*?await",
          "recommendation": "Consider extracting to a Service class for testability and reuse"
        }
      },
      "codeReviewChecklist": [
        "New logic in handlers/ (not unifiedDataProvider.ts)?",
        "Writes target Base Table (not View)?",
        "Zod validation at Handler boundary?",
        "Business logic in Service layer?",
        "Errors mapped to React Admin format?",
        "Soft delete used (not hard delete)?",
        "Handler composition is explicit?"
      ]
    },
    "skill-developer": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Meta-skill for creating and managing Claude Code skills",
      "promptTriggers": {
        "keywords": [
          "skill system",
          "create skill",
          "add skill",
          "skill triggers",
          "skill rules",
          "skill development"
        ],
        "intentPatterns": [
          "(how do|how does|explain).*?skill",
          "(create|add|modify|build).*?skill",
          "skill.*?(work|trigger|activate|system)"
        ]
      }
    },
    "technical-feedback": {
      "type": "domain",
      "enforcement": "suggest",
      "priority": "high",
      "description": "Bidirectional code review protocol - receiving feedback (verify before implementing, push back on principle violations) and giving feedback (prioritize project principles, actionable critique). Embeds Crispy CRM principles (fail-fast, Zod boundary, design system).",
      "requiredSkills": ["enforcing-principles"],
      "promptTriggers": {
        "keywords": [
          "code review",
          "review feedback",
          "PR comments",
          "review suggestions",
          "feedback",
          "suggestions",
          "changes requested",
          "fix this",
          "implement this",
          "make these changes",
          "address comments",
          "apply feedback",
          "receiving review",
          "giving review",
          "review my code",
          "check this code",
          "pushback",
          "disagree with",
          "wrong suggestion",
          "PR approval",
          "merge request",
          "GitHub comments",
          "requested changes",
          "LGTM",
          "approve PR",
          "reject PR",
          "nitpick",
          "Copilot suggested",
          "Copilot says",
          "Zen said",
          "Zen recommended",
          "AI suggested",
          "AI recommended",
          "external model",
          "GPT said",
          "this is wrong",
          "bad approach",
          "should instead",
          "why did you",
          "reconsider",
          "doesn't look right",
          "I disagree",
          "that's incorrect",
          "not the right way",
          "eslint error",
          "lint warning",
          "lint error",
          "type error",
          "TypeScript error",
          "TS error",
          "test failed",
          "test failure",
          "assertion error",
          "expect received",
          "failing test",
          "build error",
          "compile error"
        ],
        "intentPatterns": [
          "(receive|got|have).*?(feedback|review|comments|suggestions)",
          "(implement|apply|address|fix).*?(feedback|review|comments|suggestions)",
          "(review|check|evaluate).*?(code|changes|PR|pull request)",
          "(give|provide|write).*?(feedback|review|comments)",
          "(push back|disagree|reject).*?(suggestion|feedback|review)",
          "(this|that).*?(suggestion|feedback).*?(wrong|incorrect|violates)",
          "(code|PR).*?review.*?(feedback|comments)",
          "(address|fix|implement).*?(PR|pull request).*?comments",
          "(copilot|zen|gpt|ai|model).*?(said|suggested|recommended|thinks)",
          "(approve|reject|merge).*?(PR|pull request|MR|merge request)",
          "(requested|asking for).*?changes",
          "(this|that|it).*?(is|seems|looks).*?(wrong|incorrect|off|bad)",
          "(why|how come).*?(did you|would you|are you).*?(do|use|implement)",
          "(should|could|would).*?(instead|rather|better)",
          "(reconsider|rethink|redo).*?(approach|implementation|design)",
          "(eslint|lint|tsc|typescript).*?(error|warning|issue)",
          "(test|spec|assertion).*?(fail|error|broke)",
          "(fix|address|resolve).*?(lint|type|test|build).*?(error|warning|failure)",
          "failing.*?(test|build|lint|type check)"
        ]
      }
    },
    "testing-patterns": {
      "type": "domain",
      "enforcement": "contextual",
      "priority": "high",
      "description": "TDD and unit testing guidance for Crispy CRM. Covers Vitest patterns, React Admin component testing with renderWithAdminContext, Zod schema validation testing, Supabase mocking, and E2E with Playwright. Integrates with verification-before-completion.",
      "requiredSkills": ["verification-before-completion"],
      "contextualEnforcement": {
        "block": {
          "pathPatterns": [
            "src/atomic-crm/**/*.tsx",
            "src/atomic-crm/**/*.ts"
          ],
          "excludePatterns": [
            "**/*.test.ts",
            "**/*.test.tsx",
            "**/*.spec.ts",
            "**/__tests__/**"
          ],
          "reason": "Production code in atomic-crm requires test coverage - TDD enforcement"
        },
        "suggest": {
          "pathPatterns": [
            "src/**/__tests__/**/*.ts",
            "src/**/__tests__/**/*.tsx",
            "src/**/*.test.ts",
            "src/**/*.test.tsx",
            "src/**/*.spec.ts",
            "tests/**/*.ts"
          ],
          "reason": "Test files - guidance available but not enforced"
        }
      },
      "promptTriggers": {
        "keywords": [
          "test",
          "tests",
          "testing",
          "TDD",
          "test-driven",
          "unit test",
          "integration test",
          "e2e",
          "end-to-end",
          "vitest",
          "playwright",
          "jest",
          "coverage",
          "mock",
          "mocking",
          "stub",
          "spy",
          "assertion",
          "expect",
          "describe",
          "it",
          "beforeEach",
          "afterEach",
          "test failure",
          "test failing",
          "test passes",
          "red-green-refactor",
          "pgTAP",
          "database test",
          "component test",
          "render test",
          "snapshot",
          "test file",
          "spec file",
          "__tests__",
          ".test.ts",
          ".test.tsx",
          ".spec.ts"
        ],
        "intentPatterns": [
          "(write|create|add|implement).*?test",
          "(test|testing).*?(component|hook|schema|validation|form|feature)",
          "(run|execute|debug).*?test",
          "(fix|debug|investigate).*?(test|spec).*?(fail|error|broken)",
          "(mock|stub|spy).*?(supabase|api|service|provider)",
          "(setup|configure).*?(test|vitest|playwright|jest)",
          "TDD.*?(workflow|cycle|approach)",
          "(red|green|refactor).*?(cycle|phase)",
          "(coverage|cover).*?(code|test|report)",
          "how.*?(test|mock|assert)",
          "(renderWithAdminContext|render.*?admin)",
          "(e2e|end-to-end|playwright).*?(test|scenario|journey)",
          "(pgTAP|database).*?test",
          "why.*?test.*?(fail|broken|error)",
          "(implement|create|build).*?(without|skip|later).*?test",
          "test.*?later",
          "skip.*?test"
        ]
      },
      "fileTriggers": {
        "pathPatterns": [
          "src/**/__tests__/**/*.ts",
          "src/**/__tests__/**/*.tsx",
          "src/**/*.test.ts",
          "src/**/*.test.tsx",
          "src/**/*.spec.ts",
          "tests/**/*.ts",
          "tests/**/*.spec.ts",
          "supabase/tests/**/*.sql"
        ],
        "contentPatterns": [
          "describe\\(",
          "it\\(",
          "test\\(",
          "expect\\(",
          "vi\\.mock",
          "vi\\.fn",
          "vi\\.spyOn",
          "renderWithAdminContext",
          "@testing-library",
          "@playwright",
          "SELECT plan\\(",
          "SELECT ok\\(",
          "beforeEach",
          "afterEach"
        ]
      },
      "testCommands": {
        "unit": "just test",
        "watch": "just test:watch",
        "coverage": "just test:coverage",
        "e2e": "npx playwright test",
        "database": "npx supabase test db"
      }
    }
  }
}
