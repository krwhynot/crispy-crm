{
  "lastAudit": "2026-01-11",
  "lastMode": "full",
  "scope": "src/",
  "findings": {
    "critical": [
      {
        "id": "WF-C1-001",
        "check": "WF-C1",
        "type": "silent-status-default",
        "location": "src/atomic-crm/reports/tabs/OverviewTab.tsx:255",
        "description": "Hardcoded stage comparison that could mask silent defaults",
        "firstSeen": "2026-01-11"
      },
      {
        "id": "WF-C2-001",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/providers/supabase/callbacks/contactsCallbacks.ts:109",
        "description": "Contact first_name uses empty string fallback",
        "firstSeen": "2026-01-11",
        "e2eResult": "MITIGATED",
        "e2eNote": "Form validation catches empty names before reaching callback - defense-in-depth code, not exploitable via UI",
        "severity": "low"
      },
      {
        "id": "WF-C2-002",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/providers/supabase/callbacks/contactsCallbacks.ts:110",
        "description": "Contact last_name uses empty string fallback",
        "firstSeen": "2026-01-11",
        "e2eResult": "MITIGATED",
        "e2eNote": "Form validation catches empty names before reaching callback - defense-in-depth code, not exploitable via UI",
        "severity": "low"
      },
      {
        "id": "WF-C2-003",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/providers/supabase/services/TransformService.ts:182",
        "description": "Name concatenation with empty string fallback",
        "firstSeen": "2026-01-11"
      },
      {
        "id": "WF-C2-004",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/utils/saleOptionRenderer.ts:9",
        "description": "Display logic using empty string fallback for names",
        "firstSeen": "2026-01-11"
      },
      {
        "id": "WF-C2-005",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/opportunities/kanban/QuickAddOpportunity.tsx:68",
        "description": "Organization name fallback in opportunity creation",
        "firstSeen": "2026-01-11"
      },
      {
        "id": "WF-C2-006",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/opportunities/WorkflowManagementSection.tsx:34",
        "description": "Next action workflow field fallback",
        "firstSeen": "2026-01-11"
      },
      {
        "id": "WF-C2-007",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/opportunities/WorkflowManagementSection.tsx:35",
        "description": "Next action date workflow field fallback",
        "firstSeen": "2026-01-11"
      },
      {
        "id": "WF-C2-008",
        "check": "WF-C2",
        "type": "required-field-fallback",
        "location": "src/atomic-crm/opportunities/WorkflowManagementSection.tsx:36",
        "description": "Decision criteria workflow field fallback",
        "firstSeen": "2026-01-11"
      }
    ],
    "high": [
      {
        "id": "WF-H2-001",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/opportunities/kanban/QuickAddOpportunity.tsx:60",
        "description": "Opportunity creation does not log activity",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "92%"
      },
      {
        "id": "WF-H2-002",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/opportunities/components/ArchiveActions.tsx:23",
        "description": "Archive operation leaves no audit trail",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "92%"
      },
      {
        "id": "WF-H2-003",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/opportunities/kanban/OpportunityCardActions.tsx:127",
        "description": "Delete operation leaves no audit trail",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "92%"
      },
      {
        "id": "WF-H2-004",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/contacts/ContactCreate.tsx",
        "description": "Contact creation not logged - no audit trail",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "95%"
      },
      {
        "id": "WF-H2-005",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/contacts/LinkOpportunityModal.tsx:51",
        "description": "Contact-opportunity linking not logged",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "95%"
      },
      {
        "id": "WF-H2-006",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/contacts/UnlinkConfirmDialog.tsx:34",
        "description": "Contact-opportunity unlinking not logged",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "95%"
      },
      {
        "id": "WF-H2-007",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/providers/supabase/callbacks/contactsCallbacks.ts:135",
        "description": "Contact soft delete not logged - no record of who archived",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "95%"
      },
      {
        "id": "WF-H2-008",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/contacts/QuickCreateContactPopover.tsx:59",
        "description": "Quick create contact not logged",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "95%"
      },
      {
        "id": "WF-H2-009",
        "check": "WF-H2",
        "type": "missing-service-layer",
        "location": "src/atomic-crm/contacts/",
        "description": "No ContactsService exists - violates PROVIDER_RULES.md Rule #4",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "95%"
      },
      {
        "id": "WF-H2-010",
        "check": "WF-H2",
        "type": "missing-activity-logging",
        "location": "src/atomic-crm/opportunities/OpportunityCreateWizard.tsx:203",
        "description": "Create wizard does not log activity",
        "firstSeen": "2026-01-11",
        "verified": true,
        "confidence": "92%"
      }
    ],
    "medium": []
  },
  "activityLoggingAudit": {
    "opportunities": {
      "coverage": "45%",
      "mutationPoints": 11,
      "logged": 5,
      "gaps": [
        "QuickAddOpportunity",
        "OpportunityCreateWizard",
        "ArchiveActions",
        "Delete",
        "WorkflowFields",
        "SlideOverUpdates",
        "ProductsSync"
      ]
    },
    "contacts": {
      "coverage": "0%",
      "mutationPoints": 9,
      "logged": 0,
      "gaps": [
        "ContactCreate",
        "QuickCreate",
        "Updates",
        "LinkOpportunity",
        "UnlinkOpportunity",
        "SoftDelete",
        "TagChanges"
      ]
    }
  },
  "dbFindings": {
    "orphanedOpportunities": 0,
    "invalidStages": 0,
    "unlinkedContacts": 0,
    "missingCloseReasons": 0,
    "activitiesWithoutType": 0,
    "stateTransitionAnomalies": 0,
    "opportunitiesWithoutActivities": 372,
    "missingAccountManager": 369,
    "missingOwner": 369,
    "overdueCloseDate": 369,
    "defaultPriority": 372,
    "orphanedActivities": 125,
    "emptyNotes": 372
  },
  "counts": {
    "critical": 7,
    "criticalMitigated": 2,
    "high": 10,
    "medium": 38
  },
  "verification": {
    "allCriticalVerified": true,
    "activityLoggingAuditComplete": true,
    "confidence": "92%",
    "verificationDate": "2026-01-11"
  },
  "e2eVerification": {
    "status": "in_progress",
    "testsCompleted": 1.5,
    "testsTotal": 20,
    "results": {
      "test1_WF-C2-001-002": {
        "expected": "BUG",
        "actual": "MITIGATED",
        "reason": "Form validation prevents empty names - code is defense-in-depth",
        "reclassified": "critical -> low"
      },
      "test4_WF-H2-001": {
        "expected": "NO_ACTIVITY_LOGGED",
        "actual": "BLOCKED_BY_UI_BUG",
        "reason": "Quick Add form missing principal_organization_id field - cannot complete creation",
        "newFinding": "WF-E2E-001"
      }
    },
    "falsePositives": 2,
    "confirmedBugs": 0,
    "newBugsDiscovered": 1,
    "pendingTests": ["Test 5-10 (Bug Confirmation)", "Test 11-20 (Blind Spot Detection)"],
    "priorityRecommendation": "Use SQL-direct testing to validate activity logging - bypasses UI bugs"
  },
  "e2eDiscoveredBugs": [
    {
      "id": "WF-E2E-001",
      "severity": "high",
      "type": "missing-form-field",
      "location": "src/atomic-crm/opportunities/kanban/QuickAddOpportunity.tsx",
      "description": "Quick Add Opportunity modal missing required principal_organization_id field - users cannot create opportunities via Kanban columns",
      "impact": "UX blocker - Quick Add feature is non-functional",
      "discoveredVia": "E2E Test 4",
      "firstSeen": "2026-01-11"
    }
  ],
  "notes": {
    "totalOpportunities": 372,
    "closedWon": 0,
    "closedLost": 0,
    "schemaValidation": {
      "principalOrganizationIdNotNull": true,
      "customerOrganizationIdNotNull": true,
      "contactOrganizationIdNotNull": true
    },
    "regression": "58 new findings detected after verification - includes 10 activity logging gaps"
  }
}
