{
  "lastAudit": "2026-01-20",
  "lastAuditTime": "09:10",
  "mode": "full",
  "duration_minutes": 15,
  "totals": {
    "critical": 32,
    "high": 145,
    "medium": 220
  },
  "by_category": {
    "security": { "critical": 1, "high": 23, "medium": 6 },
    "data-integrity": { "critical": 0, "high": 1, "medium": 2 },
    "error-handling": { "critical": 0, "high": 7, "medium": 14 },
    "db-hardening": { "critical": 1, "high": 27, "medium": 72 },
    "stale-state": { "critical": 2, "high": 4, "medium": 5 },
    "workflow-gaps": { "critical": 2, "high": 5, "medium": 8 },
    "architecture": { "critical": 0, "high": 1, "medium": 3 },
    "typescript": { "critical": 0, "high": 18, "medium": 27 },
    "accessibility": { "critical": 0, "high": 3, "medium": 6 },
    "performance": { "critical": 2, "high": 5, "medium": 8 },
    "code-quality": { "critical": 24, "high": 51, "medium": 69 }
  },
  "critical_findings": [
    {
      "source_audit": "security",
      "id": "SEC-001",
      "severity": "critical",
      "check": "SECURITY DEFINER View",
      "location": "public.entity_timeline",
      "description": "View bypasses RLS for querying user",
      "firstSeen": "2026-01-20",
      "status": "open"
    },
    {
      "source_audit": "stale-state",
      "id": "SS-001",
      "severity": "critical",
      "check": "Missing Cache Invalidation",
      "location": "src/atomic-crm/sales/SalesCreate.tsx:49",
      "description": "New users don't appear until manual refresh",
      "firstSeen": "2026-01-20",
      "status": "open"
    },
    {
      "source_audit": "stale-state",
      "id": "SS-002",
      "severity": "critical",
      "check": "Missing Cache Invalidation",
      "location": "src/atomic-crm/opportunities/components/ArchiveActions.tsx:31,70",
      "description": "Archive/unarchive doesn't update dashboard/kanban",
      "firstSeen": "2026-01-20",
      "status": "open"
    },
    {
      "source_audit": "workflow-gaps",
      "id": "WG-001",
      "severity": "critical",
      "check": "Silent Status Default",
      "location": "src/atomic-crm/services/productDistributors.service.ts:217",
      "description": "status || 'active' masks validation failures",
      "firstSeen": "2026-01-20",
      "status": "open"
    },
    {
      "source_audit": "workflow-gaps",
      "id": "WG-002",
      "severity": "critical",
      "check": "Test Pattern Propagation",
      "location": "src/atomic-crm/providers/supabase/callbacks/createResourceCallbacks.test.ts:238",
      "description": "Test shows fallback pattern that may be copied",
      "firstSeen": "2026-01-20",
      "status": "open"
    },
    {
      "source_audit": "performance",
      "id": "PERF-001",
      "severity": "critical",
      "check": "Large Pagination",
      "location": "src/atomic-crm/reports/hooks/useReportData.ts:111",
      "description": "perPage: 1000 in centralized report hook",
      "firstSeen": "2026-01-18",
      "status": "open"
    },
    {
      "source_audit": "performance",
      "id": "PERF-002",
      "severity": "critical",
      "check": "Large Pagination",
      "location": "src/atomic-crm/opportunities/OpportunityArchivedList.tsx:25",
      "description": "perPage: 1000 for archived opportunities list",
      "firstSeen": "2026-01-18",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-001",
      "severity": "critical",
      "check": "Large Files",
      "location": "src/atomic-crm/validation/activities.ts:759",
      "description": "Validation file exceeds 500 lines (759 lines)",
      "firstSeen": "2026-01-17",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-002",
      "severity": "critical",
      "check": "Large Files",
      "location": "src/components/ui/sidebar.tsx:673",
      "description": "UI component exceeds 500 lines (673 lines)",
      "firstSeen": "2026-01-17",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-003",
      "severity": "critical",
      "check": "Large Files",
      "location": "src/atomic-crm/activities/QuickLogActivityDialog.tsx:609",
      "description": "Dialog component exceeds 500 lines",
      "firstSeen": "2026-01-17",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-004",
      "severity": "critical",
      "check": "Large Files",
      "location": "src/atomic-crm/reports/OpportunitiesByPrincipalReport.tsx:603",
      "description": "Report component exceeds 500 lines",
      "firstSeen": "2026-01-17",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-005",
      "severity": "critical",
      "check": "Large Files",
      "location": "src/atomic-crm/opportunities/quick-add/QuickAddForm.tsx:620",
      "description": "Form component exceeds 500 lines",
      "firstSeen": "2026-01-17",
      "status": "open"
    }
  ],
  "fixed_findings": [
    {
      "source_audit": "security",
      "id": "SEC-OLD-001",
      "severity": "critical",
      "check": "Hardcoded Secrets",
      "location": ".env.cloud",
      "description": "Supabase credentials in git-tracked file - FIXED",
      "firstSeen": "2026-01-15",
      "fixedDate": "2026-01-17",
      "status": "fixed"
    },
    {
      "source_audit": "architecture",
      "id": "ARCH-OLD-001",
      "severity": "critical",
      "check": "Direct Supabase Import",
      "location": "src/atomic-crm/dashboard/v3/components/QuickLogForm.tsx:5",
      "description": "Direct import of supabase client - FIXED: now uses dataProvider",
      "firstSeen": "2026-01-12",
      "fixedDate": "2026-01-15",
      "status": "fixed"
    },
    {
      "source_audit": "stale-state",
      "id": "SS-OLD-001",
      "severity": "critical",
      "check": "Missing Refetch",
      "location": "src/atomic-crm/organizations/ActivitiesTab.tsx:17",
      "description": "staleTime now configured",
      "firstSeen": "2026-01-15",
      "fixedDate": "2026-01-17",
      "status": "fixed"
    },
    {
      "source_audit": "stale-state",
      "id": "SS-OLD-002",
      "severity": "critical",
      "check": "Inconsistent Query Keys",
      "location": "TaskList.tsx:151 vs Task.tsx:115",
      "description": "Query keys now use taskKeys factory consistently",
      "firstSeen": "2026-01-15",
      "fixedDate": "2026-01-17",
      "status": "fixed"
    }
  ],
  "strangler_fig_status": {
    "unifiedDataProvider_lines": 0,
    "composedDataProvider_lines": 260,
    "handler_count": 18,
    "status": "COMPLETED"
  },
  "excellence_areas": [
    "Strangler Fig: 100% COMPLETE - 18 composed handlers",
    "RLS Coverage: 100% on all 27+ tables",
    "Fail-Fast: 90%+ compliant",
    "Form Validation: Constitution compliant - onSubmit/onBlur modes",
    "Data Integrity: 100% - Soft delete enforced",
    "TypeScript: 99.98% type safety in production (0.02 issues/file)",
    "Error Typing: 100% catch blocks use error: unknown",
    "useWatch() Adoption: 92 occurrences - proper form optimization",
    "React.memo: Applied to critical kanban components",
    "Accessibility: WCAG 2.1 AA PASS - centralized ARIA patterns"
  ],
  "trend": {
    "direction": "EXPANDED_SCOPE",
    "note": "Total increased from 237 to 397 due to NEW audits (stale-state, workflow-gaps) and EXPANDED scope (typescript, code-quality). Core functionality stable.",
    "previous_critical": 16,
    "current_critical": 32,
    "critical_fixed": 4,
    "critical_new": 20,
    "new_audits_added": ["stale-state", "workflow-gaps"],
    "expanded_audits": ["typescript", "code-quality"]
  }
}
