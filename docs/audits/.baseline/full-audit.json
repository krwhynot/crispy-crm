{
  "lastAudit": "2026-01-23",
  "lastAuditTime": "16:10",
  "mode": "quick",
  "duration_minutes": 12,
  "totals": {
    "critical": 9,
    "high": 87,
    "medium": 19
  },
  "by_layer": {
    "L1_database": { "critical": 3, "high": 5, "status": "CRITICAL" },
    "L2_domain": { "critical": 1, "high": 69, "status": "CRITICAL" },
    "L3_provider": { "critical": 1, "high": 6, "status": "CRITICAL" },
    "L4_ui_foundation": { "critical": 0, "high": 0, "status": "OK" },
    "L5_features": { "critical": 4, "high": 7, "status": "CRITICAL" }
  },
  "by_category": {
    "security": { "critical": 0, "high": 0, "medium": 0 },
    "data-integrity": { "critical": 1, "high": 3, "medium": 3 },
    "error-handling": { "critical": 1, "high": 3, "medium": 2 },
    "db-hardening": { "critical": 3, "high": 5, "medium": 2 },
    "stale-state": { "critical": 0, "high": 1, "medium": 2 },
    "workflow-gaps": { "critical": 1, "high": 3, "medium": 2 },
    "architecture": { "critical": 0, "high": 0, "medium": 0 },
    "typescript": { "critical": 1, "high": 69, "medium": 0 },
    "accessibility": { "critical": 0, "high": 0, "medium": 0 },
    "performance": { "critical": 0, "high": 3, "medium": 4 },
    "code-quality": { "critical": 3, "high": 8, "medium": 4 }
  },
  "critical_findings": [
    {
      "source_audit": "db-hardening",
      "id": "DB-CRIT-001",
      "severity": "critical",
      "layer": "L1",
      "check": "Permissive RLS policies",
      "location": "20251215054822_08_create_product_distributors.sql:42-51",
      "description": "product_distributors table has ALL RLS policies using USING (true)",
      "firstSeen": "2026-01-23",
      "status": "open"
    },
    {
      "source_audit": "db-hardening",
      "id": "DB-CRIT-002",
      "severity": "critical",
      "layer": "L1",
      "check": "Missing RLS access control",
      "location": "20260122231125_enable_rls_task_id_mapping.sql:22-26",
      "description": "task_id_mapping SELECT policy uses USING (true)",
      "firstSeen": "2026-01-23",
      "status": "open"
    },
    {
      "source_audit": "data-integrity",
      "id": "DI-001",
      "severity": "critical",
      "layer": "L1",
      "check": "Segments RLS gap",
      "location": "20251018152315_cloud_schema_fresh.sql:2804",
      "description": "Segments table SELECT policy leaks deleted records",
      "firstSeen": "2026-01-23",
      "status": "open"
    },
    {
      "source_audit": "typescript",
      "id": "TS-DOUBLE-CAST-001",
      "severity": "critical",
      "layer": "L2",
      "check": "Double-cast pattern documented as debt",
      "location": "zodErrorFormatting.ts:137",
      "description": "69 as unknown as casts in test utilities",
      "firstSeen": "2026-01-22",
      "status": "open"
    },
    {
      "source_audit": "error-handling",
      "id": "EH-001",
      "severity": "critical",
      "layer": "L3",
      "check": "Fire-and-forget cleanup",
      "location": "organizationsCallbacks.ts:124-143",
      "description": "Storage cleanup errors silently ignored - GDPR compliance risk",
      "firstSeen": "2026-01-22",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-001",
      "severity": "critical",
      "layer": "L5",
      "check": "Dead code",
      "location": "src/atomic-crm/admin/index.tsx:1-13",
      "description": "Admin module marked DEPRECATED but not removed",
      "firstSeen": "2026-01-23",
      "status": "open"
    },
    {
      "source_audit": "code-quality",
      "id": "CQ-003",
      "severity": "critical",
      "layer": "L5",
      "check": "Unused dependency",
      "location": "package.json",
      "description": "@nivo/bar installed but never imported",
      "firstSeen": "2026-01-23",
      "status": "open"
    },
    {
      "source_audit": "workflow-gaps",
      "id": "WG-001",
      "severity": "critical",
      "layer": "L5",
      "check": "Nullable Required FK",
      "location": "opportunities.principal_organization_id",
      "description": "principal_organization_id may lack NOT NULL constraint",
      "firstSeen": "2026-01-23",
      "status": "verify"
    },
    {
      "source_audit": "workflow-gaps",
      "id": "WG-002",
      "severity": "critical",
      "layer": "L5",
      "check": "Win/Loss DB validation",
      "location": "opportunities table CHECK constraints",
      "description": "Win/loss CHECK constraints need verification",
      "firstSeen": "2026-01-23",
      "status": "verify"
    }
  ],
  "strangler_fig_status": {
    "unifiedDataProvider_lines": 0,
    "composedDataProvider_lines": 260,
    "handler_count": 15,
    "status": "COMPLETED"
  },
  "excellence_areas": [
    "Security: ZERO issues - fully clean",
    "Architecture: FULLY COMPLIANT - three-tier separation perfect",
    "Accessibility: WCAG 2.1 AA compliant - zero issues",
    "Strangler Fig: 100% COMPLETE - 15 composed handlers",
    "RLS Coverage: 31/31 tables (100%)",
    "Fail-Fast: NO retry logic found",
    "Form Validation: onSubmit/onBlur mode (not onChange)"
  ],
  "trend": {
    "direction": "IMPROVING",
    "note": "Critical reduced from 28 to 9 (-68%). Security, Architecture, Accessibility all clean. Quick mode may understate some DB issues.",
    "previous_critical": 28,
    "current_critical": 9,
    "previous_high": 51,
    "current_high": 87,
    "previous_medium": 99,
    "current_medium": 19
  },
  "delta_summary": {
    "fixed": [
      "Security: 26 issues resolved (100%)",
      "Architecture: 6 issues resolved (100%)",
      "Accessibility: 10 issues resolved (100%)"
    ],
    "new": [
      "CQ-001: Dead admin module",
      "CQ-003: Unused @nivo/bar dependency"
    ],
    "unchanged": [
      "EH-001: Fire-and-forget storage cleanup",
      "TS-DOUBLE-CAST-001: TypeScript cast patterns",
      "DB-CRIT-001: product_distributors RLS"
    ]
  }
}
