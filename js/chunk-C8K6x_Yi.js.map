{"version":3,"file":"chunk-C8K6x_Yi.js","sources":["../../src/components/admin/FloatingCreateButton.tsx","../../src/components/ui/list-skeleton.tsx","../../src/hooks/useListKeyboardNavigation.ts","../../src/atomic-crm/hooks/useFilterCleanup.ts"],"sourcesContent":["/**\n * FloatingCreateButton Component\n *\n * A floating action button (FAB) for quick record creation.\n * Appears in the bottom-right corner of list views and navigates\n * to the create form for the current resource context.\n *\n * Design specifications:\n * - Size: 56px diameter (desktop), 64px (mobile/tablet)\n * - Color: Primary action color using semantic variables\n * - Position: Fixed bottom-right corner, 24px from edges (desktop), 16px (mobile)\n * - Icon: Plus symbol, white on colored background\n * - Keyboard accessible via Tab navigation\n * - ARIA labeled for screen readers\n */\n\nimport React from \"react\";\nimport { Plus } from \"lucide-react\";\nimport { useCreatePath, useResourceContext } from \"ra-core\";\nimport { Link } from \"react-router-dom\";\nimport { cn } from \"@/lib/utils\";\n\nexport interface FloatingCreateButtonProps {\n  /**\n   * Optional resource name to override the current context.\n   * If not provided, uses the resource from ResourceContext.\n   */\n  resource?: string;\n\n  /**\n   * Additional CSS classes to apply to the button\n   */\n  className?: string;\n}\n\nexport const FloatingCreateButton: React.FC<FloatingCreateButtonProps> = ({\n  resource: targetResource,\n  className,\n}) => {\n  const contextResource = useResourceContext();\n  const createPath = useCreatePath();\n  const resourceName = targetResource ?? contextResource;\n\n  const link = createPath({\n    resource: resourceName,\n    type: \"create\",\n  });\n\n  return (\n    <Link\n      to={link}\n      onClick={stopPropagation}\n      aria-label={`Create new ${resourceName?.replace(/_/g, \" \")}`}\n      className={cn(\n        // Base FAB styles\n        \"fixed z-50 flex items-center justify-center\",\n        // Positioning - closer on mobile\n        \"bottom-4 right-4 md:bottom-6 md:right-6\",\n        // Size - larger on mobile for better touch targets\n        \"size-16 md:size-14\",\n        // Shape\n        \"rounded-full\",\n        // Colors - using brand primary for maximum visibility (7:1+ contrast)\n        \"bg-primary hover:bg-primary/90\",\n        \"text-primary-foreground\",\n        // Shadow for elevation\n        \"shadow-lg hover:shadow-xl\",\n        // Standardized 150ms transition timing with smooth easing\n        \"transition-[box-shadow,transform,background-color] duration-150 ease-out\",\n        // Focus states for accessibility\n        \"focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-primary/30\",\n        // Active state\n        \"active:scale-95\",\n        className\n      )}\n    >\n      <Plus className=\"size-6\" />\n    </Link>\n  );\n};\n\n/**\n * Prevents click events from bubbling up to parent elements.\n * Useful when FAB is inside a DataGrid with rowClick behavior.\n */\nconst stopPropagation = (e: React.MouseEvent) => e.stopPropagation();\n","import { Skeleton } from \"./skeleton\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * ListSkeleton - Loading placeholder for list views\n *\n * Provides skeleton UI that matches the shape of PremiumDatagrid rows.\n * Used during initial data load to prevent layout shift and indicate loading state.\n *\n * Design System Compliance:\n * - Uses semantic spacing (gap-4 = 16px, p-4 = 16px)\n * - Skeleton heights match actual row content\n * - Responsive column visibility mirrors actual datagrid\n */\n\ninterface ListSkeletonProps {\n  /** Number of skeleton rows to display */\n  rows?: number;\n  /** Number of columns (affects skeleton layout) */\n  columns?: number;\n  /** Show avatar placeholder in first column */\n  showAvatar?: boolean;\n}\n\nexport function ListSkeleton({ rows = 5, columns = 6, showAvatar = false }: ListSkeletonProps) {\n  return (\n    <div className=\"w-full\" role=\"status\" aria-label=\"Loading list\">\n      {/* Header skeleton */}\n      <div className=\"flex items-center gap-4 p-4 border-b border-border bg-muted/30\">\n        {showAvatar && <Skeleton className=\"h-5 w-10 hidden md:block\" />}\n        {Array.from({ length: columns - (showAvatar ? 1 : 0) }).map((_, i) => (\n          <Skeleton\n            key={i}\n            className={cn(\"h-5\", i === 0 ? \"w-32\" : \"w-24\", i > 3 && \"hidden lg:block\")}\n          />\n        ))}\n      </div>\n\n      {/* Row skeletons */}\n      {Array.from({ length: rows }).map((_, rowIndex) => (\n        <div\n          key={rowIndex}\n          className=\"flex items-center gap-4 p-4 border-b border-border hover:bg-muted/20 transition-colors\"\n        >\n          {/* Avatar column (optional) */}\n          {showAvatar && <Skeleton className=\"h-10 w-10 rounded-full hidden md:block shrink-0\" />}\n\n          {/* Data columns */}\n          {Array.from({ length: columns - (showAvatar ? 1 : 0) }).map((_, colIndex) => {\n            // Vary widths for visual interest\n            const widths = [\"w-40\", \"w-32\", \"w-24\", \"w-20\", \"w-16\", \"w-28\"];\n            const width = widths[colIndex % widths.length];\n\n            // Hide later columns on smaller screens (mirror actual datagrid)\n            const responsiveClass =\n              colIndex > 4 ? \"hidden lg:block\" : colIndex > 2 ? \"hidden md:block\" : \"\";\n\n            return <Skeleton key={colIndex} className={cn(\"h-5\", width, responsiveClass)} />;\n          })}\n        </div>\n      ))}\n\n      {/* Screen reader text */}\n      <span className=\"sr-only\">Loading content...</span>\n    </div>\n  );\n}\n\n/**\n * ContactListSkeleton - Pre-configured skeleton for ContactList\n */\nexport function ContactListSkeleton() {\n  return <ListSkeleton rows={10} columns={7} showAvatar />;\n}\n\n/**\n * OrganizationListSkeleton - Pre-configured skeleton for OrganizationList\n */\nexport function OrganizationListSkeleton() {\n  return <ListSkeleton rows={10} columns={6} showAvatar={false} />;\n}\n\n/**\n * ProductListSkeleton - Pre-configured skeleton for ProductList\n */\nexport function ProductListSkeleton() {\n  return <ListSkeleton rows={10} columns={6} showAvatar={false} />;\n}\n\n/**\n * TaskListSkeleton - Pre-configured skeleton for TaskList\n */\nexport function TaskListSkeleton() {\n  return <ListSkeleton rows={10} columns={5} showAvatar={false} />;\n}\n\n/**\n * ActivityListSkeleton - Pre-configured skeleton for ActivityList\n */\nexport function ActivityListSkeleton() {\n  return <ListSkeleton rows={10} columns={5} showAvatar={false} />;\n}\n\n/**\n * SalesListSkeleton - Pre-configured skeleton for SalesList\n */\nexport function SalesListSkeleton() {\n  return <ListSkeleton rows={10} columns={5} showAvatar />;\n}\n\n/**\n * SlideOverSkeleton - Loading placeholder for slide-over detail views\n *\n * Matches the shape of field groups in detail tabs.\n */\nexport function SlideOverSkeleton() {\n  return (\n    <div className=\"space-y-6\" role=\"status\" aria-label=\"Loading details\">\n      {/* Field groups */}\n      {[1, 2, 3].map((group) => (\n        <div key={group} className=\"space-y-4\">\n          {/* Section header */}\n          <Skeleton className=\"h-5 w-24\" />\n\n          {/* Field rows */}\n          {[1, 2, 3].map((field) => (\n            <div key={field} className=\"flex items-center gap-4\">\n              <Skeleton className=\"h-4 w-20 shrink-0\" />\n              <Skeleton className=\"h-4 flex-1 max-w-xs\" />\n            </div>\n          ))}\n        </div>\n      ))}\n\n      {/* Screen reader text */}\n      <span className=\"sr-only\">Loading details...</span>\n    </div>\n  );\n}\n\n// ============================================================================\n// Resource-Specific Detail View Skeletons\n// ============================================================================\n\n/**\n * FieldSkeleton - Label + value pair skeleton for detail views.\n * Reusable building block for form-like layouts.\n */\nexport function FieldSkeleton({\n  labelWidth = \"w-20\",\n  valueWidth = \"w-32\",\n}: {\n  labelWidth?: string;\n  valueWidth?: string;\n}) {\n  return (\n    <div className=\"space-y-1.5\">\n      <Skeleton className={`h-3 ${labelWidth}`} />\n      <Skeleton className={`h-5 ${valueWidth}`} />\n    </div>\n  );\n}\n\n/**\n * ContactDetailSkeleton - Matches ContactDetailsTab structure.\n *\n * Skeleton shape mirrors:\n * - Header with avatar\n * - Contact info grid (email, phone, org, department)\n * - Status badges\n * - Notes area\n */\nexport function ContactDetailSkeleton() {\n  return (\n    <div className=\"space-y-6\" role=\"status\" aria-label=\"Loading contact details\">\n      {/* Header section with avatar */}\n      <div className=\"flex items-start gap-4\">\n        <Skeleton className=\"h-16 w-16 rounded-full shrink-0\" />\n        <div className=\"space-y-2 flex-1\">\n          <Skeleton className=\"h-6 w-48\" /> {/* Name */}\n          <Skeleton className=\"h-4 w-32\" /> {/* Title */}\n        </div>\n      </div>\n\n      {/* Contact info section */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n        <FieldSkeleton labelWidth=\"w-12\" valueWidth=\"w-40\" /> {/* Email */}\n        <FieldSkeleton labelWidth=\"w-14\" valueWidth=\"w-28\" /> {/* Phone */}\n        <FieldSkeleton labelWidth=\"w-24\" valueWidth=\"w-36\" /> {/* Organization */}\n        <FieldSkeleton labelWidth=\"w-20\" valueWidth=\"w-24\" /> {/* Department */}\n      </div>\n\n      {/* Status section */}\n      <div className=\"flex gap-4\">\n        <Skeleton className=\"h-6 w-20 rounded-full\" /> {/* Status badge */}\n        <Skeleton className=\"h-6 w-24 rounded-full\" /> {/* Tag */}\n      </div>\n\n      {/* Notes section */}\n      <div className=\"space-y-2\">\n        <Skeleton className=\"h-4 w-16\" /> {/* Label */}\n        <Skeleton className=\"h-20 w-full\" /> {/* Notes area */}\n      </div>\n\n      <span className=\"sr-only\">Loading contact details...</span>\n    </div>\n  );\n}\n\n/**\n * OrganizationDetailSkeleton - Matches OrganizationMainTab structure.\n *\n * Skeleton shape mirrors:\n * - Header with type/priority badges\n * - Info grid (website, phone, email, segment)\n * - Address section\n * - Stats (contacts, opportunities counts)\n */\nexport function OrganizationDetailSkeleton() {\n  return (\n    <div className=\"space-y-6\" role=\"status\" aria-label=\"Loading organization details\">\n      {/* Header section */}\n      <div className=\"space-y-2\">\n        <Skeleton className=\"h-7 w-56\" /> {/* Name */}\n        <div className=\"flex gap-2\">\n          <Skeleton className=\"h-5 w-20 rounded-full\" /> {/* Type badge */}\n          <Skeleton className=\"h-5 w-16 rounded-full\" /> {/* Priority badge */}\n        </div>\n      </div>\n\n      {/* Info grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n        <FieldSkeleton labelWidth=\"w-16\" valueWidth=\"w-36\" /> {/* Website */}\n        <FieldSkeleton labelWidth=\"w-14\" valueWidth=\"w-28\" /> {/* Phone */}\n        <FieldSkeleton labelWidth=\"w-12\" valueWidth=\"w-40\" /> {/* Email */}\n        <FieldSkeleton labelWidth=\"w-20\" valueWidth=\"w-24\" /> {/* Segment */}\n      </div>\n\n      {/* Address section */}\n      <div className=\"space-y-2\">\n        <Skeleton className=\"h-4 w-16\" /> {/* Label */}\n        <Skeleton className=\"h-4 w-48\" /> {/* Address line 1 */}\n        <Skeleton className=\"h-4 w-36\" /> {/* City, State */}\n      </div>\n\n      {/* Stats section */}\n      <div className=\"flex gap-6\">\n        <div className=\"space-y-1\">\n          <Skeleton className=\"h-3 w-16\" />\n          <Skeleton className=\"h-6 w-8\" />\n        </div>\n        <div className=\"space-y-1\">\n          <Skeleton className=\"h-3 w-24\" />\n          <Skeleton className=\"h-6 w-8\" />\n        </div>\n      </div>\n\n      <span className=\"sr-only\">Loading organization details...</span>\n    </div>\n  );\n}\n\n/**\n * ActivityTimelineSkeleton - Loading skeleton for activity timeline tabs.\n */\nexport function ActivityTimelineSkeleton({ items = 3 }: { items?: number }) {\n  return (\n    <div className=\"space-y-4\" role=\"status\" aria-label=\"Loading activities\">\n      {Array.from({ length: items }).map((_, i) => (\n        <div key={i} className=\"flex gap-3\">\n          <Skeleton className=\"h-8 w-8 rounded-full shrink-0\" />\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"flex items-center gap-2\">\n              <Skeleton className=\"h-4 w-24\" /> {/* Activity type */}\n              <Skeleton className=\"h-3 w-20\" /> {/* Date */}\n            </div>\n            <Skeleton className=\"h-4 w-full max-w-md\" /> {/* Description */}\n          </div>\n        </div>\n      ))}\n      <span className=\"sr-only\">Loading activities...</span>\n    </div>\n  );\n}\n\n/**\n * NotesListSkeleton - Loading skeleton for notes tab.\n */\nexport function NotesListSkeleton({ items = 2 }: { items?: number }) {\n  return (\n    <div className=\"space-y-4\" role=\"status\" aria-label=\"Loading notes\">\n      {Array.from({ length: items }).map((_, i) => (\n        <div key={i} className=\"border border-border rounded-lg p-4 space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <Skeleton className=\"h-4 w-32\" /> {/* Author */}\n            <Skeleton className=\"h-3 w-20\" /> {/* Date */}\n          </div>\n          <Skeleton className=\"h-16 w-full\" /> {/* Note content */}\n        </div>\n      ))}\n      <span className=\"sr-only\">Loading notes...</span>\n    </div>\n  );\n}\n","import { useState, useCallback, useEffect } from \"react\";\nimport { useListContext, useCreatePath, useResourceContext } from \"ra-core\";\nimport { useNavigate } from \"react-router-dom\";\n\n/**\n * Detect if running on Mac for Cmd vs Ctrl\n */\nconst isMac = (): boolean => {\n  return typeof window !== \"undefined\" && /Mac|iPhone|iPod|iPad/.test(navigator.platform);\n};\n\n/**\n * Check if target element should prevent shortcuts\n * Returns true if shortcuts should be blocked (e.g., user is typing in an input)\n */\nconst shouldPreventShortcut = (target: EventTarget | null): boolean => {\n  if (!(target instanceof HTMLElement)) return false;\n\n  const tagName = target.tagName.toLowerCase();\n  const isContentEditable = target.isContentEditable;\n\n  // Block shortcuts in inputs, textareas, selects, and contenteditable elements\n  if (tagName === \"input\" || tagName === \"textarea\" || tagName === \"select\" || isContentEditable) {\n    return true;\n  }\n\n  // Check if inside a contenteditable parent\n  let element: HTMLElement | null = target;\n  while (element) {\n    if (element.isContentEditable) return true;\n    element = element.parentElement;\n  }\n\n  // Check for ARIA text input roles\n  const role = target.getAttribute(\"role\");\n  if (role === \"textbox\" || role === \"searchbox\" || role === \"combobox\") {\n    return true;\n  }\n\n  return false;\n};\n\nexport interface UseListKeyboardNavigationOptions {\n  /**\n   * Callback when a row is selected (via Enter key)\n   * If not provided, defaults to opening the row in view mode\n   */\n  onSelect?: (id: number | string) => void;\n\n  /**\n   * Whether keyboard navigation is enabled\n   * Useful for disabling when a modal/slide-over is open\n   * @default true\n   */\n  enabled?: boolean;\n}\n\nexport interface UseListKeyboardNavigationReturn {\n  /** Currently focused row index (-1 if none) */\n  focusedIndex: number;\n  /** ID of the currently focused record */\n  focusedId: number | string | null;\n  /** Set focus to a specific index */\n  setFocusedIndex: (index: number) => void;\n  /** Clear focus */\n  clearFocus: () => void;\n  /** Whether keyboard shortcuts are active (Mac detection) */\n  isMac: boolean;\n  /** The modifier key name (⌘ or Ctrl) */\n  modifierKey: string;\n}\n\n/**\n * Hook for keyboard navigation in list views\n *\n * Provides:\n * - Arrow Up/Down: Navigate between rows\n * - Enter: Open selected row (or trigger custom onSelect)\n * - Cmd/Ctrl + N: Navigate to create form\n * - Cmd/Ctrl + K or /: Focus search input\n *\n * @example\n * ```tsx\n * const { focusedIndex, focusedId } = useListKeyboardNavigation({\n *   onSelect: (id) => openSlideOver(Number(id), \"view\"),\n *   enabled: !isSlideOverOpen,\n * });\n * ```\n */\nexport function useListKeyboardNavigation({\n  onSelect,\n  enabled = true,\n}: UseListKeyboardNavigationOptions = {}): UseListKeyboardNavigationReturn {\n  const { data } = useListContext();\n  const resource = useResourceContext();\n  const createPath = useCreatePath();\n  const navigate = useNavigate();\n\n  const [focusedIndex, setFocusedIndex] = useState<number>(-1);\n\n  // Get the ID of the currently focused record\n  const focusedId =\n    data && focusedIndex >= 0 && focusedIndex < data.length ? data[focusedIndex].id : null;\n\n  const clearFocus = useCallback(() => {\n    setFocusedIndex(-1);\n  }, []);\n\n  // Navigate to create form\n  const handleCreate = useCallback(() => {\n    if (!resource) return;\n    const path = createPath({ resource, type: \"create\" });\n    navigate(path);\n  }, [resource, createPath, navigate]);\n\n  // Focus search input\n  const handleSearch = useCallback(() => {\n    const searchInput = document.querySelector<HTMLInputElement>(\n      'input[type=\"search\"], input[placeholder*=\"Search\" i], input[aria-label*=\"Search\" i]'\n    );\n    searchInput?.focus();\n  }, []);\n\n  // Handle keyboard events\n  useEffect(() => {\n    if (!enabled) return;\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      const { key } = event;\n      const target = event.target;\n      const isModifier = isMac() ? event.metaKey : event.ctrlKey;\n\n      // Cmd/Ctrl + N: Create new record\n      if (key === \"n\" && isModifier) {\n        if (!shouldPreventShortcut(target)) {\n          event.preventDefault();\n          handleCreate();\n        }\n        return;\n      }\n\n      // Cmd/Ctrl + K or /: Focus search\n      if ((key === \"k\" && isModifier) || (key === \"/\" && !shouldPreventShortcut(target))) {\n        event.preventDefault();\n        handleSearch();\n        return;\n      }\n\n      // Arrow navigation - only when not in input fields\n      if (shouldPreventShortcut(target)) return;\n      if (!data || data.length === 0) return;\n\n      // Arrow Up: Move focus up\n      if (key === \"ArrowUp\") {\n        event.preventDefault();\n        setFocusedIndex((prev) => {\n          if (prev <= 0) return data.length - 1; // Wrap to bottom\n          return prev - 1;\n        });\n        return;\n      }\n\n      // Arrow Down: Move focus down\n      if (key === \"ArrowDown\") {\n        event.preventDefault();\n        setFocusedIndex((prev) => {\n          if (prev < 0 || prev >= data.length - 1) return 0; // Wrap to top\n          return prev + 1;\n        });\n        return;\n      }\n\n      // Enter: Open selected row\n      if (key === \"Enter\" && focusedIndex >= 0 && focusedIndex < data.length) {\n        event.preventDefault();\n        const id = data[focusedIndex].id;\n        if (onSelect) {\n          onSelect(id);\n        } else {\n          // Default: navigate to show view\n          const path = createPath({ resource, type: \"show\", id });\n          navigate(path);\n        }\n        return;\n      }\n\n      // Home: Jump to first row\n      if (key === \"Home\") {\n        event.preventDefault();\n        setFocusedIndex(0);\n        return;\n      }\n\n      // End: Jump to last row\n      if (key === \"End\") {\n        event.preventDefault();\n        setFocusedIndex(data.length - 1);\n        return;\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [\n    enabled,\n    data,\n    focusedIndex,\n    onSelect,\n    handleCreate,\n    handleSearch,\n    resource,\n    createPath,\n    navigate,\n  ]);\n\n  // Reset focus when data changes (e.g., pagination, filtering)\n  useEffect(() => {\n    setFocusedIndex(-1);\n  }, [data]);\n\n  return {\n    focusedIndex,\n    focusedId,\n    setFocusedIndex,\n    clearFocus,\n    isMac: isMac(),\n    modifierKey: isMac() ? \"⌘\" : \"Ctrl\",\n  };\n}\n","import { useEffect } from \"react\";\nimport { useStore } from \"ra-core\";\nimport { isValidFilterField } from \"../providers/supabase/filterRegistry\";\n\n/**\n * Default sort fields for each resource when stale sort is detected\n * Falls back to \"id\" if resource not in map\n */\nconst DEFAULT_SORT_FIELDS: Record<string, string> = {\n  contacts: \"last_seen\",\n  organizations: \"name\",\n  opportunities: \"created_at\",\n  activities: \"activity_date\",\n  tasks: \"due_date\",\n  sales: \"first_name\",\n  tags: \"name\",\n};\n\n/**\n * useFilterCleanup Hook - Client-side Filter & Sort Validation\n *\n * Proactively cleans stale cached filters AND sorts from localStorage and React Admin's\n * internal store for a given resource. This prevents UI inconsistencies and\n * ensures that filters and sorts are always valid.\n *\n * This hook complements the dataProvider-level validation (which prevents API errors)\n * by maintaining clean localStorage state across page loads and navigation.\n *\n * Usage:\n * ```typescript\n * export const ContactList = () => {\n *   useFilterCleanup('contacts');\n *   // ... rest of component\n * };\n * ```\n *\n * @param resource The React Admin resource name (e.g., 'contacts', 'organizations')\n *\n * Note: This hook runs on component mount and whenever the resource changes.\n * It modifies both localStorage and the React Admin store to trigger a re-render\n * if invalid filters or sorts are detected and removed.\n */\nexport const useFilterCleanup = (resource: string) => {\n  const [, storeApi] = useStore();\n\n  useEffect(() => {\n    // IMPORTANT: Key must match the store name initialized in CRM.tsx (line 123)\n    // where React Admin store is configured with storeName=\"CRM\", resulting in\n    // localStorage keys like \"RaStoreCRM.{resource}.listParams\"\n    const key = `RaStoreCRM.${resource}.listParams`;\n    const storedParams = localStorage.getItem(key);\n\n    if (!storedParams) {\n      return; // No stored params, nothing to clean\n    }\n\n    try {\n      const params = JSON.parse(storedParams);\n\n      if (!params?.filter) {\n        return; // No filters, nothing to clean\n      }\n\n      const cleanedFilter: Record<string, any> = {};\n      let modified = false;\n\n      // Iterate through all filter keys and validate each one\n      for (const filterKey in params.filter) {\n        if (Object.prototype.hasOwnProperty.call(params.filter, filterKey)) {\n          if (isValidFilterField(resource, filterKey)) {\n            // Valid filter - keep it\n            cleanedFilter[filterKey] = params.filter[filterKey];\n          } else {\n            // Invalid filter - log and remove\n            console.warn(\n              `[useFilterCleanup] Resource \"${resource}\" found stale filter \"${filterKey}\" in localStorage. ` +\n                `This field no longer exists in the database schema. Removing it.`\n            );\n            modified = true;\n          }\n        }\n      }\n\n      // Check sort field validity\n      // Sort fields should be valid filterable fields (they're columns in the DB)\n      if (params.sort?.field) {\n        const sortField = params.sort.field;\n        if (!isValidFilterField(resource, sortField)) {\n          console.warn(\n            `[useFilterCleanup] Resource \"${resource}\" found stale sort field \"${sortField}\" in localStorage. ` +\n              `This field no longer exists in the database schema. Resetting to default.`\n          );\n          params.sort = {\n            field: DEFAULT_SORT_FIELDS[resource] || \"id\",\n            order: params.sort.order || \"DESC\",\n          };\n          modified = true;\n        }\n      }\n\n      // Only update if we actually removed something\n      if (modified) {\n        params.filter = cleanedFilter;\n        localStorage.setItem(key, JSON.stringify(params));\n        storeApi.setItem(key, params);\n\n        console.info(\n          `[useFilterCleanup] Cleaned stale filters/sort for resource \"${resource}\". ` +\n            `localStorage and React Admin store updated.`\n        );\n      }\n    } catch (error) {\n      console.error(\n        `[useFilterCleanup] Error parsing localStorage for resource \"${resource}\":`,\n        error\n      );\n      // Don't throw - fail gracefully and let the app continue\n      // Optionally, could clear the corrupted key: localStorage.removeItem(key);\n    }\n  }, [resource, storeApi]);\n};\n"],"names":["FloatingCreateButton","__name","resource","targetResource","className","contextResource","useResourceContext","resourceName","link","useCreatePath","createPath","type","jsx","Link","to","onClick","stopPropagation","replace","cn","children","Plus","e","ListSkeleton","rows","columns","showAvatar","role","jsxs","Skeleton","Array","from","length","map","_","i","rowIndex","colIndex","widths","width","responsiveClass","ContactListSkeleton","OrganizationListSkeleton","ProductListSkeleton","TaskListSkeleton","ActivityListSkeleton","SalesListSkeleton","SlideOverSkeleton","group","field","FieldSkeleton","labelWidth","valueWidth","ContactDetailSkeleton","OrganizationDetailSkeleton","isMac","window","test","navigator","platform","shouldPreventShortcut","target","HTMLElement","tagName","toLowerCase","isContentEditable","element","parentElement","getAttribute","useListKeyboardNavigation","onSelect","enabled","data","useListContext","navigate","useNavigate","focusedIndex","setFocusedIndex","useState","focusedId","id","clearFocus","useCallback","handleCreate","path","handleSearch","searchInput","document","querySelector","focus","useEffect","handleKeyDown","event","key","isModifier","metaKey","ctrlKey","preventDefault","prev","addEventListener","removeEventListener","modifierKey","DEFAULT_SORT_FIELDS","contacts","organizations","opportunities","activities","tasks","sales","tags","useFilterCleanup","storeApi","useStore","storedParams","localStorage","getItem","params","JSON","parse","filter","cleanedFilter","modified","filterKey","Object","prototype","hasOwnProperty","call","isValidFilterField","sort","sortField","order","setItem","stringify","error"],"mappings":"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"}