var e=Object.defineProperty,s=(s,t)=>e(s,"name",{value:t,configurable:!0});import{U as t,j as a}from"./chunk-ByJg_QQB.js";import{r as i}from"./chunk-1NZFT-6z.js";import{S as r,B as n,ay as l,az as c,aA as o,q as m}from"../assets/index-BoLku8RR.js";import{o as d,aa as x,b2 as u,ap as h,a_ as f,a9 as p,$ as j,m as v,b3 as g,a$ as N,U as y,z as b,ad as w,J as _,ae as k}from"./chunk-Bc6KM1xM.js";import"./chunk-JxeXaC9i.js";import"./chunk-DwAffUXc.js";import"./chunk-knA4lag3.js";import"./chunk-Tyyhsnez.js";import"./chunk-XoqkUGE_.js";import"./chunk-CRKBdUTG.js";function $(e=15){const{data:s=[],isPending:a,error:r,refetch:n}=t("activities",{pagination:{page:1,perPage:e},sort:{field:"activity_date",order:"DESC"},filter:{"deleted_at@is":null},meta:{select:"\n          id,\n          type,\n          subject,\n          activity_date,\n          description,\n          created_by,\n          contact_id,\n          organization_id,\n          opportunity_id,\n          sales:created_by (\n            id,\n            first_name,\n            last_name,\n            email,\n            avatar_url\n          )\n        "}},{staleTime:3e5});return{activities:s,loading:a,error:r?new Error(String(r)):null,refetch:i.useCallback(async()=>{await n()},[n])}}function A(e){const s=e.trim().toLowerCase();return{call:w,email:b,meeting:y,demo:N,proposal:g,follow_up:v,trade_show:j,site_visit:p,contract_review:f,check_in:h,social:u,note:x,sample:d}[s]??x}function T(e){return e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function C(e){const s=m(e);if(!s)return"Unknown";const t=(new Date).getTime()-s.getTime(),a=Math.floor(t/1e3),i=Math.floor(a/60),r=Math.floor(i/60),n=Math.floor(r/24);return a<60?"Just now":i<60?`${i} min${i>1?"s":""} ago`:r<24?`${r} hour${r>1?"s":""} ago`:1===n?"Yesterday":n<7?`${n} days ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function M(e,s){return`${e?.[0]||""}${s?.[0]||""}`.toUpperCase()||"?"}function S(e,s,t){return e&&s?`${e} ${s}`:e||s?e||s||"":t?t.split("@")[0]:"Team Member"}function U({limit:e=15}){const{activities:t,loading:l,error:c}=$(e),o=i.useMemo(()=>t.length,[t]);return l?a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("div",{className:"border-b border-border px-4 py-3",children:[a.jsx(r,{className:"mb-2 h-6 w-32"}),a.jsx(r,{className:"h-4 w-48"})]}),a.jsx("div",{className:"flex-1 p-4",children:a.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(e=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(r,{className:"h-10 w-10 rounded-full"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(r,{className:"h-4 w-3/4"}),a.jsx(r,{className:"h-3 w-1/2"})]})]},e))})})]}):c?a.jsxs("div",{className:"flex flex-col p-4",children:[a.jsxs("h3",{className:"flex items-center gap-2 text-lg font-semibold",children:[a.jsx(_,{className:"h-5 w-5"}),"Team Activity"]}),a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive",children:"Failed to load activities"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:c.message})]})})]}):a.jsxs("div",{className:"flex flex-col","data-tutorial":"dashboard-activity-feed",children:[a.jsxs("div",{className:"border-b border-border px-4 py-3",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"flex items-center gap-2 text-lg font-semibold",children:[a.jsx(_,{className:"h-5 w-5 text-primary"}),"Team Activity"]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Recent activities across the team"})]}),a.jsxs(n,{variant:"ghost",size:"sm",className:"h-11 gap-1 text-primary hover:text-primary/80",onClick:s(()=>{window.location.href="/#/activities"},"onClick"),"aria-label":"View all activities",children:["View All",a.jsx(k,{className:"h-4 w-4"})]})]}),o>0&&a.jsxs("p",{className:"mt-2 text-xs text-muted-foreground",children:["Showing ",o," recent activities"]})]}),a.jsx("div",{children:0===t.length?a.jsx("div",{className:"flex h-full items-center justify-center p-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_,{className:"mx-auto h-12 w-12 text-muted-foreground/50"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"No recent activities"}),a.jsx("p",{className:"text-xs text-muted-foreground/70",children:"Activities will appear here as your team logs them"})]})}):a.jsx("div",{className:"divide-y divide-border",children:t.map(e=>a.jsx(z,{activity:e},e.id))})})]})}s($,"useTeamActivities"),s(A,"getActivityIcon"),s(T,"formatActivityType"),s(C,"formatRelativeTime"),s(M,"getInitials"),s(S,"getDisplayName"),s(U,"ActivityFeedPanel");const z=i.memo(s(function({activity:e}){const s=A(e.type),t=e.sales,i=S(t?.first_name||null,t?.last_name||null,t?.email||null),r=M(t?.first_name||null,t?.last_name||null),n=C(e.activity_date),m=T(e.type);return a.jsxs("div",{className:"interactive-card flex items-start gap-3 px-4 py-3 transition-colors hover:bg-muted/50",role:"article","aria-label":`${m} by ${i}: ${e.subject}`,children:[a.jsxs(l,{className:"h-10 w-10 flex-shrink-0",children:[a.jsx(c,{src:t?.avatar_url||void 0,alt:i}),a.jsx(o,{className:"bg-primary/10 text-sm font-medium text-primary",children:r})]}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-muted",title:m,children:a.jsx(s,{className:"h-3.5 w-3.5 text-muted-foreground"})}),a.jsx("span",{className:"truncate text-sm font-medium text-foreground",children:i}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"â€¢"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:m})]}),a.jsx("p",{className:"mt-0.5 truncate text-sm text-foreground/80",children:e.subject}),a.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:n})]})]})},"ActivityItem2"));export{U as ActivityFeedPanel,U as default};
