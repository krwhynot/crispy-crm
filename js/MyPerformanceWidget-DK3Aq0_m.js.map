{"version":3,"file":"MyPerformanceWidget-DK3Aq0_m.js","sources":["../../src/atomic-crm/dashboard/v3/hooks/useMyPerformance.ts","../../src/atomic-crm/dashboard/v3/components/MyPerformanceWidget.tsx"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\nimport { useDataProvider } from \"react-admin\";\nimport { startOfWeek, endOfWeek, subWeeks, startOfDay } from \"date-fns\";\nimport { useCurrentSale } from \"./useCurrentSale\";\n\n/**\n * My Performance Metrics for Dashboard Widget (PRD v1.18)\n *\n * Fetches user-specific performance metrics with week-over-week trends:\n * 1. Activities This Week - count logged by current user\n * 2. Deals Moved - opportunities with stage changes this week\n * 3. Tasks Completed - count completed by current user this week\n * 4. Open Opportunities - count owned by current user\n *\n * Trends calculated by comparing current week to previous week.\n * Uses Promise.allSettled for resilient parallel fetching.\n */\n\nexport interface PerformanceMetric {\n  /** Current period value */\n  value: number;\n  /** Previous period value for trend calculation */\n  previousValue: number;\n  /** Percentage change from previous period */\n  trend: number;\n  /** Direction indicator for styling */\n  direction: \"up\" | \"down\" | \"flat\";\n}\n\nexport interface MyPerformanceMetrics {\n  activitiesThisWeek: PerformanceMetric;\n  dealsMoved: PerformanceMetric;\n  tasksCompleted: PerformanceMetric;\n  openOpportunities: PerformanceMetric;\n}\n\ninterface UseMyPerformanceReturn {\n  metrics: MyPerformanceMetrics;\n  loading: boolean;\n  error: Error | null;\n  refetch: () => void;\n}\n\n/**\n * Calculate trend direction and percentage\n */\nfunction calculateTrend(\n  current: number,\n  previous: number\n): Pick<PerformanceMetric, \"trend\" | \"direction\"> {\n  if (previous === 0) {\n    // Avoid division by zero - show flat or positive if we have current activity\n    return {\n      trend: current > 0 ? 100 : 0,\n      direction: current > 0 ? \"up\" : \"flat\",\n    };\n  }\n\n  const percentChange = ((current - previous) / previous) * 100;\n\n  return {\n    trend: Math.round(percentChange),\n    direction: percentChange > 0 ? \"up\" : percentChange < 0 ? \"down\" : \"flat\",\n  };\n}\n\n/**\n * Create a metric object with trend data\n */\nfunction createMetric(current: number, previous: number): PerformanceMetric {\n  const { trend, direction } = calculateTrend(current, previous);\n  return {\n    value: current,\n    previousValue: previous,\n    trend,\n    direction,\n  };\n}\n\n// Stable default metrics to avoid new reference on each render\nconst DEFAULT_METRICS: MyPerformanceMetrics = {\n  activitiesThisWeek: { value: 0, previousValue: 0, trend: 0, direction: \"flat\" },\n  dealsMoved: { value: 0, previousValue: 0, trend: 0, direction: \"flat\" },\n  tasksCompleted: { value: 0, previousValue: 0, trend: 0, direction: \"flat\" },\n  openOpportunities: { value: 0, previousValue: 0, trend: 0, direction: \"flat\" },\n};\n\nexport function useMyPerformance(): UseMyPerformanceReturn {\n  const dataProvider = useDataProvider();\n  const { salesId, loading: salesLoading } = useCurrentSale();\n  const [metrics, setMetrics] = useState<MyPerformanceMetrics>(DEFAULT_METRICS);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [refetchTrigger, setRefetchTrigger] = useState(0);\n\n  // Track previous salesId to avoid unnecessary fetches\n  const prevSalesIdRef = useRef<number | null>(null);\n\n  useEffect(() => {\n    const fetchMetrics = async () => {\n      // Wait for sales data to load\n      if (salesLoading) {\n        return;\n      }\n\n      if (!salesId) {\n        // No user - show empty metrics\n        if (prevSalesIdRef.current !== null) {\n          setMetrics(DEFAULT_METRICS);\n          prevSalesIdRef.current = null;\n        }\n        setLoading(false);\n        return;\n      }\n\n      prevSalesIdRef.current = salesId;\n\n      try {\n        setLoading(true);\n        setError(null);\n\n        const today = startOfDay(new Date());\n        const thisWeekStart = startOfWeek(today, { weekStartsOn: 1 }); // Monday\n        const thisWeekEnd = endOfWeek(today, { weekStartsOn: 1 }); // Sunday\n        const lastWeekStart = subWeeks(thisWeekStart, 1);\n        const lastWeekEnd = subWeeks(thisWeekEnd, 1);\n\n        // Fetch all metrics in parallel using Promise.allSettled\n        // This ensures partial failures don't break the entire widget\n        const [\n          // Current week data\n          activitiesThisWeekResult,\n          tasksCompletedThisWeekResult,\n          dealsMovedThisWeekResult,\n          openOpportunitiesResult,\n          // Previous week data (for trends)\n          activitiesLastWeekResult,\n          tasksCompletedLastWeekResult,\n          dealsMovedLastWeekResult,\n          openOpportunitiesLastWeekResult,\n        ] = await Promise.allSettled([\n          // 1. Activities this week (by current user)\n          // Note: activities table uses created_by, not sales_id\n          dataProvider.getList(\"activities\", {\n            filter: {\n              created_by: salesId,\n              \"activity_date@gte\": thisWeekStart.toISOString(),\n              \"activity_date@lte\": thisWeekEnd.toISOString(),\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 }, // Only need count\n          }),\n\n          // 2. Tasks completed this week (by current user)\n          dataProvider.getList(\"tasks\", {\n            filter: {\n              sales_id: salesId,\n              completed: true,\n              \"completed_at@gte\": thisWeekStart.toISOString(),\n              \"completed_at@lte\": thisWeekEnd.toISOString(),\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 }, // Only need count\n          }),\n\n          // 3. Deals moved this week (stage changes by current user)\n          // We check for opportunities updated this week that aren't closed\n          // Note: opportunities table uses opportunity_owner_id, not sales_id\n          dataProvider.getList(\"opportunities\", {\n            filter: {\n              opportunity_owner_id: salesId,\n              \"updated_at@gte\": thisWeekStart.toISOString(),\n              \"updated_at@lte\": thisWeekEnd.toISOString(),\n              \"stage@not_in\": [\"closed_won\", \"closed_lost\"],\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 }, // Only need count\n          }),\n\n          // 4. Open opportunities (by current user)\n          // Note: opportunities table uses opportunity_owner_id, not sales_id\n          dataProvider.getList(\"opportunities\", {\n            filter: {\n              opportunity_owner_id: salesId,\n              \"stage@not_in\": [\"closed_won\", \"closed_lost\"],\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 }, // Only need count\n          }),\n\n          // Previous week comparisons\n          // 5. Activities last week\n          // Note: activities table uses created_by, not sales_id\n          dataProvider.getList(\"activities\", {\n            filter: {\n              created_by: salesId,\n              \"activity_date@gte\": lastWeekStart.toISOString(),\n              \"activity_date@lte\": lastWeekEnd.toISOString(),\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 },\n          }),\n\n          // 6. Tasks completed last week\n          dataProvider.getList(\"tasks\", {\n            filter: {\n              sales_id: salesId,\n              completed: true,\n              \"completed_at@gte\": lastWeekStart.toISOString(),\n              \"completed_at@lte\": lastWeekEnd.toISOString(),\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 },\n          }),\n\n          // 7. Deals moved last week\n          // Note: opportunities table uses opportunity_owner_id, not sales_id\n          dataProvider.getList(\"opportunities\", {\n            filter: {\n              opportunity_owner_id: salesId,\n              \"updated_at@gte\": lastWeekStart.toISOString(),\n              \"updated_at@lte\": lastWeekEnd.toISOString(),\n              \"stage@not_in\": [\"closed_won\", \"closed_lost\"],\n            },\n            sort: { field: \"id\", order: \"ASC\" },\n            pagination: { page: 1, perPage: 1 },\n          }),\n\n          // 8. Historical snapshot from last week\n          // Query dashboard_snapshots table for accurate week-over-week comparison\n          dataProvider.getList(\"dashboard_snapshots\", {\n            filter: {\n              sales_id: salesId,\n              snapshot_date: lastWeekEnd.toISOString().split(\"T\")[0], // Date only\n            },\n            sort: { field: \"id\", order: \"DESC\" },\n            pagination: { page: 1, perPage: 1 },\n          }),\n        ]);\n\n        // Extract counts from results, using 0 for failures\n        const getCount = (result: PromiseSettledResult<{ total?: number }>): number => {\n          if (result.status === \"fulfilled\") {\n            return result.value.total || 0;\n          }\n          return 0;\n        };\n\n        const activitiesThisWeek = getCount(activitiesThisWeekResult);\n        const activitiesLastWeek = getCount(activitiesLastWeekResult);\n        const tasksCompletedThisWeek = getCount(tasksCompletedThisWeekResult);\n        const tasksCompletedLastWeek = getCount(tasksCompletedLastWeekResult);\n        const dealsMovedThisWeek = getCount(dealsMovedThisWeekResult);\n        const dealsMovedLastWeek = getCount(dealsMovedLastWeekResult);\n        const openOpportunities = getCount(openOpportunitiesResult);\n\n        // Extract historical snapshot data for open opportunities\n        let openOpportunitiesLastWeek = openOpportunities; // Fallback to current count\n        if (openOpportunitiesLastWeekResult.status === \"fulfilled\") {\n          const snapshot = openOpportunitiesLastWeekResult.value.data?.[0];\n          if (snapshot && typeof snapshot.open_opportunities_count === \"number\") {\n            openOpportunitiesLastWeek = snapshot.open_opportunities_count;\n          }\n        }\n\n        // Log any failures for debugging\n        [\n          activitiesThisWeekResult,\n          tasksCompletedThisWeekResult,\n          dealsMovedThisWeekResult,\n          openOpportunitiesResult,\n        ].forEach((result, index) => {\n          if (result.status === \"rejected\") {\n            console.error(`Failed to fetch metric ${index}:`, result.reason);\n          }\n        });\n\n        setMetrics({\n          activitiesThisWeek: createMetric(activitiesThisWeek, activitiesLastWeek),\n          tasksCompleted: createMetric(tasksCompletedThisWeek, tasksCompletedLastWeek),\n          dealsMoved: createMetric(dealsMovedThisWeek, dealsMovedLastWeek),\n          openOpportunities: createMetric(openOpportunities, openOpportunitiesLastWeek),\n        });\n      } catch (err) {\n        console.error(\"Failed to fetch performance metrics:\", err);\n        setError(err as Error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchMetrics();\n  }, [dataProvider, salesId, salesLoading, refetchTrigger]);\n\n  const refetch = () => {\n    setRefetchTrigger((prev) => prev + 1);\n  };\n\n  return { metrics, loading, error, refetch };\n}\n","// Card wrapper removed - parent DashboardTabPanel provides container\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  Activity,\n  ArrowUpRight,\n  ArrowDownRight,\n  Minus,\n  CheckCircle2,\n  TrendingUp,\n  Briefcase,\n  type LucideIcon,\n} from \"lucide-react\";\nimport { useMyPerformance, type PerformanceMetric } from \"../hooks/useMyPerformance\";\n\n/**\n * Performance metric type identifiers for configuration lookup\n */\ntype PerformanceMetricType =\n  | \"activitiesThisWeek\"\n  | \"dealsMoved\"\n  | \"tasksCompleted\"\n  | \"openOpportunities\";\n\n/**\n * Configuration for each performance metric type\n * Per PRD v1.18 - personal performance tracking for sales reps\n */\nconst METRIC_CONFIG: Record<\n  PerformanceMetricType,\n  {\n    icon: LucideIcon;\n    label: string;\n    shortLabel: string;\n  }\n> = {\n  activitiesThisWeek: {\n    icon: Activity,\n    label: \"Activities This Week\",\n    shortLabel: \"Activities\",\n  },\n  dealsMoved: {\n    icon: TrendingUp,\n    label: \"Deals Moved\",\n    shortLabel: \"Deals Moved\",\n  },\n  tasksCompleted: {\n    icon: CheckCircle2,\n    label: \"Tasks Completed\",\n    shortLabel: \"Tasks Done\",\n  },\n  openOpportunities: {\n    icon: Briefcase,\n    label: \"Open Opportunities\",\n    shortLabel: \"Open Opps\",\n  },\n};\n\ninterface MetricCardProps {\n  type: PerformanceMetricType;\n  metric: PerformanceMetric;\n  loading?: boolean;\n}\n\n/**\n * Individual metric display within the performance widget\n *\n * Features:\n * - Value with trend arrow indicator\n * - text-success (green) for positive trends\n * - text-destructive (red) for negative trends\n * - Compact layout for widget embedding\n */\nfunction MetricCard({ type, metric, loading }: MetricCardProps) {\n  const config = METRIC_CONFIG[type];\n  const Icon = config.icon;\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center gap-3 p-3\" aria-busy=\"true\">\n        <Skeleton className=\"h-9 w-9 rounded-lg shrink-0\" />\n        <div className=\"flex-1 space-y-1.5\">\n          <Skeleton className=\"h-3 w-16\" />\n          <Skeleton className=\"h-5 w-12\" />\n        </div>\n      </div>\n    );\n  }\n\n  // Determine trend icon and styling per P8 constraint\n  const TrendIcon =\n    metric.direction === \"up\" ? ArrowUpRight : metric.direction === \"down\" ? ArrowDownRight : Minus;\n\n  const trendColorClass =\n    metric.direction === \"up\"\n      ? \"text-success\"\n      : metric.direction === \"down\"\n        ? \"text-destructive\"\n        : \"text-muted-foreground\";\n\n  return (\n    <div\n      className=\"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/50 transition-colors\"\n      role=\"group\"\n      aria-label={`${config.label}: ${metric.value}`}\n    >\n      {/* Icon - 36px container for compact layout */}\n      <div className=\"flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10 text-primary shrink-0\">\n        <Icon className=\"h-4 w-4\" aria-hidden=\"true\" />\n      </div>\n\n      {/* Metric content */}\n      <div className=\"flex-1 min-w-0\">\n        {/* Label */}\n        <p className=\"text-xs text-muted-foreground truncate\">{config.shortLabel}</p>\n        {/* Value and trend */}\n        <div className=\"flex items-center gap-1.5\">\n          <span className=\"text-lg font-semibold text-foreground\">\n            {metric.value.toLocaleString()}\n          </span>\n          {/* Trend indicator - only show if there's a meaningful comparison */}\n          {(metric.previousValue > 0 || metric.value > 0) && (\n            <span\n              className={cn(\"flex items-center text-xs font-medium\", trendColorClass)}\n              aria-label={`${metric.direction === \"up\" ? \"increased\" : metric.direction === \"down\" ? \"decreased\" : \"unchanged\"} by ${Math.abs(metric.trend)}%`}\n            >\n              <TrendIcon className=\"h-3.5 w-3.5\" aria-hidden=\"true\" />\n              {metric.direction !== \"flat\" && (\n                <span className=\"ml-0.5\">{Math.abs(metric.trend)}%</span>\n              )}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/**\n * MyPerformanceWidget - Personal performance metrics summary\n *\n * Displays 4 key personal performance metrics with week-over-week trends:\n * 1. Activities This Week - activities logged by current user\n * 2. Deals Moved - opportunities with stage changes\n * 3. Tasks Completed - tasks marked complete this week\n * 4. Open Opportunities - current pipeline count\n *\n * Layout:\n * - Card container with 2x2 grid of metrics\n * - Trend arrows use semantic colors (text-success/text-destructive)\n * - Compact design for dashboard embedding\n *\n * Accessibility:\n * - Semantic structure with role=\"group\"\n * - Screen reader labels for trends\n * - Keyboard navigable (inherits from Card)\n */\nfunction MyPerformanceWidget() {\n  const { metrics, loading } = useMyPerformance();\n\n  return (\n    <div className=\"p-4\" data-tutorial=\"dashboard-performance-widget\">\n      <div className=\"mb-3\">\n        <h3 className=\"text-base font-semibold\">My Performance</h3>\n      </div>\n      {/* 2x2 grid on mobile, 2x2 on desktop for compact widget */}\n      <div\n        className=\"grid grid-cols-2 gap-1\"\n        role=\"region\"\n        aria-label=\"Personal performance metrics\"\n      >\n        <MetricCard\n          type=\"activitiesThisWeek\"\n          metric={metrics.activitiesThisWeek}\n          loading={loading}\n        />\n        <MetricCard type=\"dealsMoved\" metric={metrics.dealsMoved} loading={loading} />\n        <MetricCard type=\"tasksCompleted\" metric={metrics.tasksCompleted} loading={loading} />\n        <MetricCard type=\"openOpportunities\" metric={metrics.openOpportunities} loading={loading} />\n      </div>\n\n      {/* Week comparison note */}\n      <p className=\"text-xs text-muted-foreground mt-3 text-center\">Compared to last week</p>\n    </div>\n  );\n}\n\n// Named export for barrel, default export for lazy loading\nexport { MyPerformanceWidget };\nexport default MyPerformanceWidget;\n"],"names":["calculateTrend","current","previous","trend","direction","percentChange","Math","round","createMetric","value","previousValue","__name","DEFAULT_METRICS","activitiesThisWeek","dealsMoved","tasksCompleted","openOpportunities","useMyPerformance","dataProvider","useDataProvider","salesId","loading","salesLoading","useCurrentSale","metrics","setMetrics","useState","setLoading","error","setError","refetchTrigger","setRefetchTrigger","prevSalesIdRef","useRef","useEffect","async","today","startOfDay","Date","thisWeekStart","startOfWeek","weekStartsOn","thisWeekEnd","endOfWeek","lastWeekStart","subWeeks","lastWeekEnd","activitiesThisWeekResult","tasksCompletedThisWeekResult","dealsMovedThisWeekResult","openOpportunitiesResult","activitiesLastWeekResult","tasksCompletedLastWeekResult","dealsMovedLastWeekResult","openOpportunitiesLastWeekResult","Promise","allSettled","getList","filter","created_by","toISOString","sort","field","order","pagination","page","perPage","sales_id","completed","opportunity_owner_id","snapshot_date","split","getCount","result","status","total","activitiesLastWeek","tasksCompletedThisWeek","tasksCompletedLastWeek","dealsMovedThisWeek","dealsMovedLastWeek","openOpportunitiesLastWeek","snapshot","data","open_opportunities_count","forEach","index","err","fetchMetrics","refetch","prev","METRIC_CONFIG","icon","Activity","label","shortLabel","TrendingUp","CheckCircle2","Briefcase","MetricCard","type","metric","config","Icon","jsxs","className","children","jsx","Skeleton","TrendIcon","ArrowUpRight","ArrowDownRight","Minus","trendColorClass","role","toLocaleString","cn","abs","MyPerformanceWidget"],"mappings":"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"}