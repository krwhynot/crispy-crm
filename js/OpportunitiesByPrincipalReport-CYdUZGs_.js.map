{"version":3,"file":"OpportunitiesByPrincipalReport-CYdUZGs_.js","sources":["../../src/components/admin/multi-select-input.tsx","../../src/atomic-crm/reports/OpportunitiesByPrincipalReport.tsx"],"sourcesContent":["import { useCallback } from \"react\";\nimport type { InputProps } from \"ra-core\";\nimport { FieldTitle, useChoicesContext, useInput, useTranslate, type ChoicesProps } from \"ra-core\";\nimport { X } from \"lucide-react\";\n\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuCheckboxItem,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n} from \"@/components/ui/dropdown-menu\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { FormField, FormLabel, FormError } from \"@/components/admin/form\";\nimport { InputHelperText } from \"@/components/admin/input-helper-text\";\nimport { cn } from \"@/lib/utils\";\n\nexport const MultiSelectInput = (props: MultiSelectInputProps) => {\n  const {\n    choices: choicesProp,\n    resource: resourceProp,\n    source: sourceProp,\n\n    optionText,\n    optionValue,\n    translateChoice,\n\n    defaultValue = [],\n    label,\n    helperText,\n    validate,\n    disabled,\n\n    emptyText = \"Select items\",\n\n    ...rest\n  } = props;\n  const translate = useTranslate();\n\n  const { allChoices, source } = useChoicesContext({\n    choices: choicesProp,\n    resource: resourceProp,\n    source: sourceProp,\n  });\n\n  const {\n    field,\n    fieldState: { error },\n  } = useInput({\n    defaultValue,\n    resource: resourceProp,\n    source,\n    validate,\n    ...rest,\n  });\n\n  const handleChange = useCallback(\n    (choiceId: any, checked: boolean) => {\n      const currentValue = field.value || [];\n      const newValue = checked\n        ? [...currentValue, choiceId]\n        : currentValue.filter((v: any) => v !== choiceId);\n      field.onChange(newValue);\n    },\n    [field]\n  );\n\n  const handleClearAll = useCallback(\n    (e: React.MouseEvent) => {\n      e.stopPropagation();\n      field.onChange([]);\n    },\n    [field]\n  );\n\n  const selectedCount = field.value?.length || 0;\n  const displayText = selectedCount > 0 ? `${emptyText} (${selectedCount} selected)` : emptyText;\n\n  return (\n    <FormField>\n      {label !== false && (\n        <FormLabel htmlFor={field.name}>\n          <FieldTitle label={label} source={source} resource={resourceProp} />\n        </FormLabel>\n      )}\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant=\"outline\"\n            className={cn(\n              \"w-full justify-between\",\n              selectedCount > 0 && !disabled && \"border-primary text-primary\"\n            )}\n            disabled={disabled}\n          >\n            <span>{displayText}</span>\n            {selectedCount > 0 && (\n              <Badge variant=\"secondary\" className=\"ml-2\">\n                {selectedCount}\n              </Badge>\n            )}\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent className=\"w-56\">\n          {selectedCount > 0 && (\n            <>\n              <DropdownMenuItem onClick={handleClearAll}>\n                <X className=\"mr-2 h-4 w-4\" />\n                Clear all\n              </DropdownMenuItem>\n              <DropdownMenuSeparator />\n            </>\n          )}\n          {allChoices?.map((choice) => {\n            const choiceId = choice[optionValue ?? \"id\"];\n            const choiceLabel = choice[optionText ?? \"name\"];\n            const isChecked = field.value?.includes(choiceId) || false;\n\n            return (\n              <DropdownMenuCheckboxItem\n                key={choiceId}\n                checked={isChecked}\n                onCheckedChange={(checked) => handleChange(choiceId, checked)}\n              >\n                {translateChoice ? translate(choiceLabel, { _: choiceLabel }) : choiceLabel}\n              </DropdownMenuCheckboxItem>\n            );\n          })}\n        </DropdownMenuContent>\n      </DropdownMenu>\n      <InputHelperText helperText={helperText} />\n      {error && <FormError>{error.message}</FormError>}\n    </FormField>\n  );\n};\n\nexport type MultiSelectInputProps = ChoicesProps &\n  Partial<InputProps> & {\n    emptyText?: string;\n  };\n","import { useState, useMemo, useEffect } from \"react\";\nimport { useGetList, useNotify, downloadCSV } from \"ra-core\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useForm, FormProvider } from \"react-hook-form\";\nimport jsonExport from \"jsonexport/dist\";\nimport { format } from \"date-fns\";\nimport { ReportLayout } from \"./ReportLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronDown, ChevronRight, ExternalLink } from \"lucide-react\";\nimport { MultiSelectInput } from \"@/components/admin/multi-select-input\";\nimport { ReferenceInput } from \"@/components/admin/reference-input\";\nimport { AutocompleteArrayInput } from \"@/components/admin/autocomplete-array-input\";\nimport { OPPORTUNITY_STAGE_CHOICES } from \"../opportunities/constants/stageConstants\";\nimport { sanitizeCsvValue } from \"@/atomic-crm/utils/csvUploadValidator\";\nimport type { Opportunity, Sale } from \"../types\";\nimport { parseDateSafely } from \"@/lib/date-utils\";\n\ninterface PrincipalGroup {\n  principalId: string | null;\n  principalName: string;\n  opportunities: Opportunity[];\n  totalCount: number;\n  stageBreakdown: Record<string, number>;\n}\n\ninterface FilterValues {\n  principal_organization_id: string | null;\n  stage: string[];\n  opportunity_owner_id: string | null;\n  startDate: string | null;\n  endDate: string | null;\n}\n\ninterface FilterToolbarProps {\n  filters: FilterValues;\n  onFiltersChange: (filters: FilterValues) => void;\n}\n\n/**\n * Filter toolbar with form context for React Admin inputs\n * Wraps ReferenceInput components in FormProvider to provide required React Hook Form context\n */\nfunction FilterToolbar({ filters, onFiltersChange }: FilterToolbarProps) {\n  const form = useForm<FilterValues>({\n    defaultValues: filters,\n  });\n\n  // Watch form values and sync to parent state using subscription pattern\n  // This avoids infinite loops - form.watch() returns new object each render,\n  // but the subscription only fires when actual values change\n  useEffect(() => {\n    const subscription = form.watch((value) => {\n      onFiltersChange(value as FilterValues);\n    });\n    return () => subscription.unsubscribe();\n  }, [form, onFiltersChange]);\n\n  const hasActiveFilters =\n    filters.principal_organization_id ||\n    filters.stage.length > 0 ||\n    filters.opportunity_owner_id ||\n    filters.startDate ||\n    filters.endDate;\n\n  const clearFilters = () => {\n    form.reset({\n      principal_organization_id: null,\n      stage: [],\n      opportunity_owner_id: null,\n      startDate: null,\n      endDate: null,\n    });\n  };\n\n  return (\n    <FormProvider {...form}>\n      <form className=\"flex flex-wrap items-center gap-2\">\n        {/* Principal Filter */}\n        <ReferenceInput\n          source=\"principal_organization_id\"\n          reference=\"organizations\"\n          filter={{ organization_type: \"principal\" }}\n        >\n          <AutocompleteArrayInput\n            label={false}\n            placeholder=\"Filter by Principal\"\n            sx={{ minWidth: 200 }}\n          />\n        </ReferenceInput>\n\n        {/* Stage Filter */}\n        <MultiSelectInput\n          source=\"stage\"\n          emptyText=\"All Stages\"\n          choices={OPPORTUNITY_STAGE_CHOICES}\n          sx={{ minWidth: 150 }}\n        />\n\n        {/* Sales Rep Filter */}\n        <ReferenceInput source=\"opportunity_owner_id\" reference=\"sales\">\n          <AutocompleteArrayInput\n            label={false}\n            placeholder=\"Filter by Sales Rep\"\n            sx={{ minWidth: 200 }}\n          />\n        </ReferenceInput>\n\n        {/* Date Range */}\n        <div className=\"flex items-center gap-2\">\n          <input\n            type=\"date\"\n            {...form.register(\"startDate\")}\n            className=\"h-11 px-3 py-2 border border-border rounded text-sm\"\n            placeholder=\"From Date\"\n            aria-label=\"Filter from date\"\n          />\n          <span className=\"text-muted-foreground\">to</span>\n          <input\n            type=\"date\"\n            {...form.register(\"endDate\")}\n            className=\"h-11 px-3 py-2 border border-border rounded text-sm\"\n            placeholder=\"To Date\"\n            aria-label=\"Filter to date\"\n          />\n        </div>\n\n        {/* Clear Filters */}\n        {hasActiveFilters && (\n          <Button variant=\"ghost\" size=\"sm\" onClick={clearFilters} type=\"button\" className=\"h-11\">\n            Clear Filters\n          </Button>\n        )}\n      </form>\n    </FormProvider>\n  );\n}\n\n/**\n * Opportunities by Principal Report\n *\n * Full detailed report showing all opportunities grouped by principal organization.\n * Provides detailed view with opportunity details, filters, and CSV export.\n *\n * Features:\n * - Groups opportunities by principal organization\n * - Shows opportunity details: name, organization, stage, close date, rep\n * - Filters: principal, stage, sales rep, date range\n * - CSV export with all fields sanitized\n * - Expandable/collapsible principal sections\n * - Click-through to individual opportunities\n */\nexport default function OpportunitiesByPrincipalReport() {\n  const navigate = useNavigate();\n  const notify = useNotify();\n\n  // Filter state\n  const [filters, setFilters] = useState<FilterValues>({\n    principal_organization_id: null,\n    stage: [],\n    opportunity_owner_id: null,\n    startDate: null,\n    endDate: null,\n  });\n\n  // Track expanded principals\n  const [expandedPrincipals, setExpandedPrincipals] = useState<Set<string>>(new Set());\n\n  // Build filter object for API\n  const apiFilter = useMemo(() => {\n    const filter: any = {\n      \"deleted_at@is\": null,\n      status: \"active\",\n    };\n\n    if (filters.principal_organization_id) {\n      filter.principal_organization_id = filters.principal_organization_id;\n    }\n\n    if (filters.stage.length > 0) {\n      filter.stage = filters.stage;\n    }\n\n    if (filters.opportunity_owner_id) {\n      filter.opportunity_owner_id = filters.opportunity_owner_id;\n    }\n\n    if (filters.startDate) {\n      filter[\"estimated_close_date@gte\"] = filters.startDate;\n    }\n\n    if (filters.endDate) {\n      filter[\"estimated_close_date@lte\"] = filters.endDate;\n    }\n\n    return filter;\n  }, [filters]);\n\n  // Fetch opportunities\n  const { data: opportunities, isPending: opportunitiesPending } = useGetList<Opportunity>(\n    \"opportunities_summary\",\n    {\n      pagination: { page: 1, perPage: 10000 },\n      filter: apiFilter,\n      sort: { field: \"estimated_close_date\", order: \"ASC\" },\n    }\n  );\n\n  // Fetch sales reps for filter and display\n  const ownerIds = useMemo(\n    () =>\n      Array.from(new Set((opportunities || []).map((o) => o.opportunity_owner_id).filter(Boolean))),\n    [opportunities]\n  );\n\n  const { data: salesReps } = useGetList<Sale>(\"sales\", {\n    pagination: { page: 1, perPage: 1000 },\n    filter: ownerIds.length > 0 ? { id: ownerIds } : undefined,\n  });\n\n  const salesMap = useMemo(\n    () => new Map((salesReps || []).map((s) => [s.id, `${s.first_name} ${s.last_name}`])),\n    [salesReps]\n  );\n\n  // Group opportunities by principal\n  const principalGroups = useMemo(() => {\n    if (!opportunities) return [];\n\n    // Group by principal_organization_id\n    const grouped = new Map<string | null, PrincipalGroup>();\n\n    opportunities.forEach((opp) => {\n      const principalId = opp.principal_organization_id?.toString() || null;\n      const principalName = opp.principal_organization_name || \"No Principal Assigned\";\n\n      if (!grouped.has(principalId)) {\n        grouped.set(principalId, {\n          principalId,\n          principalName,\n          opportunities: [],\n          totalCount: 0,\n          stageBreakdown: {},\n        });\n      }\n\n      const group = grouped.get(principalId)!;\n      group.opportunities.push(opp);\n      group.totalCount += 1;\n\n      // Track stage breakdown\n      const stage = opp.stage || \"Unknown\";\n      group.stageBreakdown[stage] = (group.stageBreakdown[stage] || 0) + 1;\n    });\n\n    // Convert to array and sort by total count (descending)\n    const groups = Array.from(grouped.values()).sort((a, b) => b.totalCount - a.totalCount);\n\n    // Auto-expand first 3 principals\n    if (expandedPrincipals.size === 0 && groups.length > 0) {\n      const initialExpanded = new Set(groups.slice(0, 3).map((g) => g.principalId || \"null\"));\n      setExpandedPrincipals(initialExpanded);\n    }\n\n    return groups;\n  }, [opportunities, expandedPrincipals.size]);\n\n  // Toggle principal expansion\n  const togglePrincipalExpansion = (principalId: string | null) => {\n    const key = principalId || \"null\";\n    const newExpanded = new Set(expandedPrincipals);\n    if (newExpanded.has(key)) {\n      newExpanded.delete(key);\n    } else {\n      newExpanded.add(key);\n    }\n    setExpandedPrincipals(newExpanded);\n  };\n\n  // Handle CSV export\n  const handleExport = () => {\n    const exportData: any[] = [];\n\n    principalGroups.forEach((group) => {\n      group.opportunities.forEach((opp) => {\n        const closeDateObj = opp.estimated_close_date\n          ? parseDateSafely(opp.estimated_close_date)\n          : null;\n        exportData.push({\n          principal: sanitizeCsvValue(group.principalName),\n          opportunity: sanitizeCsvValue(opp.name),\n          organization: sanitizeCsvValue(opp.customer_organization_name || \"\"),\n          stage: sanitizeCsvValue(opp.stage),\n          close_date: closeDateObj ? format(closeDateObj, \"yyyy-MM-dd\") : \"\",\n          sales_rep: sanitizeCsvValue(salesMap.get(opp.opportunity_owner_id!) || \"Unassigned\"),\n          priority: sanitizeCsvValue(opp.priority || \"medium\"),\n          status: sanitizeCsvValue(opp.status),\n          days_in_stage: opp.days_in_stage || 0,\n        });\n      });\n    });\n\n    if (exportData.length === 0) {\n      notify(\"No data to export\", { type: \"warning\" });\n      return;\n    }\n\n    jsonExport(exportData, (err, csv) => {\n      if (err) {\n        console.error(\"Export error:\", err);\n        notify(\"Export failed. Please try again.\", { type: \"error\" });\n        return;\n      }\n      downloadCSV(csv, `opportunities-by-principal-${format(new Date(), \"yyyy-MM-dd\")}`);\n      notify(\"Report exported successfully\", { type: \"success\" });\n    });\n  };\n\n  // Navigate to opportunity detail\n  const handleOpportunityClick = (oppId: string | number) => {\n    navigate(`/opportunities/${oppId}/show`);\n  };\n\n  // Loading state\n  if (opportunitiesPending) {\n    return (\n      <ReportLayout title=\"Opportunities by Principal\">\n        <p className=\"text-muted-foreground\">Loading opportunities...</p>\n      </ReportLayout>\n    );\n  }\n\n  const totalOpportunities = opportunities?.length || 0;\n  const totalPrincipals = principalGroups.length;\n\n  return (\n    <ReportLayout\n      title=\"Opportunities by Principal\"\n      onExport={handleExport}\n      actions={<FilterToolbar filters={filters} onFiltersChange={setFilters} />}\n    >\n      <div className=\"space-y-section\">\n        {/* Summary Stats */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-content\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-muted-foreground\">Total Opportunities</p>\n              <p className=\"text-2xl font-bold\">{totalOpportunities}</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-muted-foreground\">Principals</p>\n              <p className=\"text-2xl font-bold\">{totalPrincipals}</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-muted-foreground\">Avg per Principal</p>\n              <p className=\"text-2xl font-bold\">\n                {totalPrincipals > 0 ? Math.round(totalOpportunities / totalPrincipals) : 0}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Principal Groups */}\n        {principalGroups.length === 0 ? (\n          <p className=\"text-center text-muted-foreground py-8\">\n            No opportunities found matching the selected filters\n          </p>\n        ) : (\n          <div className=\"space-y-content\">\n            {principalGroups.map((group) => (\n              <PrincipalGroupCard\n                key={group.principalId || \"null\"}\n                group={group}\n                isExpanded={expandedPrincipals.has(group.principalId || \"null\")}\n                onToggle={() => togglePrincipalExpansion(group.principalId)}\n                onOpportunityClick={handleOpportunityClick}\n                salesMap={salesMap}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    </ReportLayout>\n  );\n}\n\ninterface PrincipalGroupCardProps {\n  group: PrincipalGroup;\n  isExpanded: boolean;\n  onToggle: () => void;\n  onOpportunityClick: (id: string | number) => void;\n  salesMap: Map<string | number, string>;\n}\n\nfunction PrincipalGroupCard({\n  group,\n  isExpanded,\n  onToggle,\n  onOpportunityClick,\n  salesMap,\n}: PrincipalGroupCardProps) {\n  // Get stage summary\n  const stageSummary = Object.entries(group.stageBreakdown)\n    .sort(([, a], [, b]) => b - a)\n    .slice(0, 3)\n    .map(([stage, count]) => `${stage}: ${count}`)\n    .join(\", \");\n\n  return (\n    <Card>\n      <CardHeader\n        className=\"cursor-pointer hover:bg-accent/50 transition-colors\"\n        onClick={onToggle}\n      >\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            {isExpanded ? (\n              <ChevronDown className=\"w-5 h-5\" />\n            ) : (\n              <ChevronRight className=\"w-5 h-5\" />\n            )}\n            <span>{group.principalName}</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Badge variant=\"secondary\">\n              {group.totalCount} {group.totalCount === 1 ? \"opportunity\" : \"opportunities\"}\n            </Badge>\n            {stageSummary && (\n              <span className=\"text-sm text-muted-foreground hidden md:inline\">\n                ({stageSummary})\n              </span>\n            )}\n          </div>\n        </CardTitle>\n      </CardHeader>\n\n      {isExpanded && (\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b text-sm text-muted-foreground\">\n                  <th className=\"text-left py-2 px-2 min-w-[200px]\">Opportunity</th>\n                  <th className=\"text-left py-2 px-2 min-w-[150px]\">Organization</th>\n                  <th className=\"text-left py-2 px-2 min-w-[120px]\">Stage</th>\n                  <th className=\"text-left py-2 px-2 min-w-[100px]\">Close Date</th>\n                  <th className=\"text-left py-2 px-2 min-w-[100px]\">Sales Rep</th>\n                  <th className=\"text-center py-2 px-2 min-w-[50px]\">Action</th>\n                </tr>\n              </thead>\n              <tbody>\n                {group.opportunities.map((opp) => (\n                  <tr key={opp.id} className=\"border-b hover:bg-accent/30 transition-colors\">\n                    <td className=\"py-2 px-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"font-medium\">{opp.name}</span>\n                        {opp.priority === \"high\" && (\n                          <Badge variant=\"outline\" className=\"text-xs bg-warning-light\">\n                            High\n                          </Badge>\n                        )}\n                        {opp.priority === \"critical\" && (\n                          <Badge variant=\"outline\" className=\"text-xs bg-destructive-light\">\n                            Critical\n                          </Badge>\n                        )}\n                        {opp.days_in_stage && opp.days_in_stage > 14 && (\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {opp.days_in_stage} days\n                          </Badge>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"py-2 px-2\">{opp.customer_organization_name || \"-\"}</td>\n                    <td className=\"py-2 px-2\">\n                      <Badge variant=\"outline\">{opp.stage}</Badge>\n                    </td>\n                    <td className=\"py-2 px-2\">\n                      {opp.estimated_close_date && parseDateSafely(opp.estimated_close_date)\n                        ? format(parseDateSafely(opp.estimated_close_date)!, \"MMM dd, yyyy\")\n                        : \"-\"}\n                    </td>\n                    <td className=\"py-2 px-2\">\n                      {salesMap.get(opp.opportunity_owner_id!) || \"Unassigned\"}\n                    </td>\n                    <td className=\"py-2 px-2 text-center\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onOpportunityClick(opp.id);\n                        }}\n                      >\n                        <ExternalLink className=\"w-4 h-4\" />\n                      </Button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      )}\n    </Card>\n  );\n}\n"],"names":["MultiSelectInput","props","choices","choicesProp","resource","resourceProp","source","sourceProp","optionText","optionValue","translateChoice","defaultValue","label","helperText","validate","disabled","emptyText","rest","translate","useTranslate","allChoices","useChoicesContext","field","fieldState","error","useInput","handleChange","useCallback","choiceId","checked","currentValue","value","newValue","filter","v","onChange","handleClearAll","e","stopPropagation","selectedCount","length","displayText","FormField","children","jsx","FormLabel","htmlFor","name","FieldTitle","DropdownMenu","DropdownMenuTrigger","asChild","jsxs","Button","variant","className","cn","Badge","DropdownMenuContent","Fragment","DropdownMenuItem","onClick","X","DropdownMenuSeparator","map","choice","choiceLabel","isChecked","includes","DropdownMenuCheckboxItem","onCheckedChange","__name","_","InputHelperText","FormError","message","FilterToolbar","filters","onFiltersChange","form","useForm","defaultValues","useEffect","subscription","watch","unsubscribe","hasActiveFilters","principal_organization_id","stage","opportunity_owner_id","startDate","endDate","clearFilters","reset","FormProvider","ReferenceInput","reference","organization_type","AutocompleteArrayInput","placeholder","sx","minWidth","OPPORTUNITY_STAGE_CHOICES","type","register","size","OpportunitiesByPrincipalReport","navigate","useNavigate","notify","useNotify","setFilters","useState","expandedPrincipals","setExpandedPrincipals","Set","apiFilter","useMemo","status","data","opportunities","isPending","opportunitiesPending","useGetList","pagination","page","perPage","sort","order","ownerIds","Array","from","o","Boolean","salesReps","id","salesMap","Map","s","first_name","last_name","principalGroups","grouped","forEach","opp","principalId","toString","principalName","principal_organization_name","has","set","totalCount","stageBreakdown","group","get","push","groups","values","a","b","initialExpanded","slice","g","togglePrincipalExpansion","key","newExpanded","delete","add","handleExport","exportData","closeDateObj","estimated_close_date","parseDateSafely","principal","sanitizeCsvValue","opportunity","organization","customer_organization_name","close_date","format","sales_rep","priority","days_in_stage","jsonExport","err","csv","downloadCSV","Date","handleOpportunityClick","oppId","ReportLayout","title","totalOpportunities","totalPrincipals","onExport","actions","Card","CardContent","Math","round","PrincipalGroupCard","isExpanded","onToggle","onOpportunityClick","stageSummary","Object","entries","count","join","CardHeader","CardTitle","ChevronDown","ChevronRight","ExternalLink"],"mappings":"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"}