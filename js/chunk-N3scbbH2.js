var e=Object.defineProperty,a=(a,s)=>e(a,"name",{value:s,configurable:!0});import{ak as s,u as l,aB as r,bq as i,j as t,al as n,ay as o}from"./chunk-DWisBx5Y.js";import{i as c,j as d,k as m,l as h,P as x,m as p,g as u,n as g,o as j,p as b,q as f,r as y,s as v,t as k,v as N,B as w,w as C,x as T,y as S,I as P}from"../assets/index-BMLg8LT4.js";import{A as _,S as L}from"./chunk-BZFU79a7.js";import{r as O}from"./chunk-CPNr-gD1.js";import{m as D,C as $,k as z}from"./chunk-BePsjq0D.js";import{T as A,a as I,b as R,c as q}from"./chunk-CQf6o72Z.js";import{b as F}from"./chunk-DAbVPE3R.js";const B=a(e=>{const{field:o}=s(e),w=l(),[C,T]=O.useState(""),[S,P]=O.useState(!1),{data:_,isLoading:L}=r("segments",{pagination:{page:1,perPage:100},sort:{field:"name",order:"ASC"}}),[A,{isLoading:I}]=i("segments"),R=a(async e=>{try{const a=await A("segments",{data:{name:e}},{returnPromise:!0});o.onChange(a.id),w("Segment created successfully",{type:"success"}),P(!1),T("")}catch{w("Failed to create segment",{type:"error"})}},"handleCreateSegment"),q=_?.find(e=>e.id===o.value),F=_?.filter(e=>e.name.toLowerCase().includes(C.toLowerCase()))||[],B=F.some(e=>e.name.toLowerCase()===C.toLowerCase()),G=""!==C.trim()&&!B;return t.jsxs(c,{id:o.name,className:d("w-full",e.className),name:o.name,children:[!1!==e.label&&t.jsx(m,{children:t.jsx(n,{label:e.label,source:e.source,resource:"organizations"})}),t.jsx(h,{children:t.jsxs(x,{open:S,onOpenChange:P,children:[t.jsx(p,{asChild:!0,children:t.jsxs(u,{variant:"outline",role:"combobox","aria-expanded":S,className:"w-full justify-between h-9 font-normal",disabled:L||I,children:[q?q.name:t.jsx("span",{className:"text-muted-foreground",children:"Select or create segment..."}),t.jsx(D,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),t.jsx(g,{className:"w-full p-0",children:t.jsxs(j,{shouldFilter:!1,children:[t.jsx(b,{placeholder:"Search segments...",value:C,onValueChange:T}),t.jsx(f,{children:L||I?t.jsx(y,{children:"Loading..."}):t.jsxs(t.Fragment,{children:[0===F.length&&!G&&t.jsx(y,{children:"No segment found."}),t.jsxs(v,{children:[F.map(e=>t.jsxs(k,{value:e.id,onSelect:a(()=>{o.onChange(e.id===o.value?"":e.id),P(!1),T("")},"onSelect"),children:[t.jsx($,{className:d("mr-2 h-4 w-4",o.value===e.id?"opacity-100":"opacity-0")}),e.name]},e.id)),G&&t.jsxs(k,{value:`create-${C}`,onSelect:a(()=>R(C),"onSelect"),className:"text-primary",children:[t.jsx(z,{className:"mr-2 h-4 w-4"}),'Create "',C,'"']})]})]})})]})})]})}),t.jsx(N,{})]})},"SegmentComboboxInput"),G=[{key:"general",label:"General",fields:["name","logo","organization_type","description","sales_id"]},{key:"details",label:"Details",fields:["segment_id","priority","address","city","postal_code","state","phone"]},{key:"other",label:"Other",fields:["website","linkedin_url","context_links"]}],U=a(()=>{const{errors:e}=F(),a=Object.keys(e||{}),s={general:a.filter(e=>G[0].fields.includes(e)).length,details:a.filter(e=>G[1].fields.includes(e)).length,other:a.filter(e=>G[2].fields.includes(e)).length};return t.jsxs(A,{defaultValue:"general",className:"w-full",children:[t.jsxs(I,{children:[t.jsxs(R,{value:"general","aria-label":s.general>0?`General tab, ${s.general} error${s.general>1?"s":""}`:"General tab",children:["General",s.general>0&&t.jsx(w,{variant:"destructive",className:"ml-2","aria-hidden":"true",children:s.general})]}),t.jsxs(R,{value:"details","aria-label":s.details>0?`Details tab, ${s.details} error${s.details>1?"s":""}`:"Details tab",children:["Details",s.details>0&&t.jsx(w,{variant:"destructive",className:"ml-2","aria-hidden":"true",children:s.details})]}),t.jsxs(R,{value:"other","aria-label":s.other>0?`Other tab, ${s.other} error${s.other>1?"s":""}`:"Other tab",children:["Other",s.other>0&&t.jsx(w,{variant:"destructive",className:"ml-2","aria-hidden":"true",children:s.other})]})]}),t.jsx(q,{value:"general",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6 p-4",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(H,{})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsx(C,{source:"organization_type",label:"Organization Type *",choices:[{id:"customer",name:"Customer"},{id:"prospect",name:"Prospect"},{id:"partner",name:"Partner"},{id:"principal",name:"Principal"},{id:"distributor",name:"Distributor"},{id:"unknown",name:"Unknown"}],helperText:"Required field",emptyText:"Select organization type"})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsx(T,{source:"description",multiline:!0,helperText:!1,label:"Description"})}),t.jsx(S,{source:"sales_id",reference:"sales",filter:{"disabled@neq":!0},children:t.jsx(C,{label:"Account manager",helperText:!1,optionText:M})})]})}),t.jsx(q,{value:"details",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6 p-4",children:[t.jsx(B,{source:"segment_id",label:"Segment"}),t.jsx(C,{source:"priority",choices:[{id:"A",name:"A - High Priority"},{id:"B",name:"B - Medium-High Priority"},{id:"C",name:"C - Medium Priority"},{id:"D",name:"D - Low Priority"}],helperText:!1,emptyText:"Select priority level"}),t.jsx(T,{source:"phone",helperText:!1,label:"Phone"}),t.jsx(T,{source:"address",helperText:!1,label:"Address"}),t.jsx(T,{source:"city",helperText:!1,label:"City"}),t.jsx(T,{source:"postal_code",label:"Postal Code",helperText:!1}),t.jsx(T,{source:"state",label:"State",helperText:!1})]})}),t.jsx(q,{value:"other",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6 p-4",children:[t.jsx(T,{source:"website",helperText:"Format: https://example.com",label:"Website"}),t.jsx(T,{source:"linkedin_url",label:"LinkedIn URL",helperText:"Format: https://linkedin.com/company/name"}),t.jsx("div",{className:"lg:col-span-2",children:t.jsx(_,{source:"context_links",helperText:!1,label:"Context Links",children:t.jsx(L,{disableReordering:!0,fullWidth:!0,getItemLabel:!1,children:t.jsx(T,{source:"",label:!1,helperText:"Enter a valid URL"})})})})]})})]})},"OrganizationInputs"),H=a(()=>{const e=o();return t.jsxs("div",{className:"flex gap-4 flex-1 flex-row",children:[t.jsx(P,{source:"logo",type:"avatar",width:60,height:60,emptyText:e?.name.charAt(0),linkPosition:"bottom"}),t.jsx(T,{source:"name",className:"w-full h-fit",helperText:"Required field",placeholder:"Organization name",label:"Name *"})]})},"OrganizationDisplayInputs"),M=a(e=>`${e.first_name} ${e.last_name}`,"saleOptionRenderer");export{U as O};
