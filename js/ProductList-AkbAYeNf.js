var e=Object.defineProperty,s=(s,t)=>e(s,"name",{value:t,configurable:!0});import{U as t,j as r,al as a,W as i,u as n,aj as o,J as c,i as l,ak as d}from"./chunk-ByJg_QQB.js";import{S as u,C as m,L as p}from"./chunk-BBQ6yJWi.js";import{aD as x,aE as j,T as h,C as f,a as g,d as y,r as b}from"../assets/index-BoLku8RR.js";import{R as N}from"./chunk-DbeoRBEW.js";import{S as v}from"./chunk-DDhuYt5_.js";import{u as k,P as _,F as S,b as C}from"./chunk-C8K6x_Yi.js";import{B as w}from"./chunk-BndLoydo.js";import{v as P,S as O,F as D}from"./chunk-A2EVsQEK.js";import{P as F}from"./chunk-CKWniV73.js";import{T as A}from"./chunk-BtJ7Qrct.js";import{R as T,u as L}from"./chunk-a4jA-31v.js";import"./chunk-1NZFT-6z.js";import"./chunk-CFj7NhUg.js";import{P as R,a as z,b as U}from"./chunk-C_u3nriX.js";import{C as G}from"./chunk-C0a-ooKP.js";import{F as I,T as B}from"./chunk-C6dCzd_-.js";import{W as M,o as W,a4 as V,aJ as E}from"./chunk-Bc6KM1xM.js";import{S as $}from"./chunk-C5fZsuMg.js";import{R as J}from"./chunk-D6FmavVW.js";import{A as q}from"./chunk-nUtrHAIa.js";import{A as K}from"./chunk-BY7AmvEs.js";import"./chunk-CRKBdUTG.js";import{D as Q}from"./chunk-DkiUngdk.js";import{P as X,F as Y}from"./chunk-Nds5IV03.js";import"./chunk-JxeXaC9i.js";import"./chunk-Dc4zIuSl.js";import"./chunk-B1s-jt27.js";import"./chunk-knA4lag3.js";import"./chunk-Tyyhsnez.js";import"./chunk-DwAffUXc.js";import"./chunk-XoqkUGE_.js";import"./chunk-DA1DYucv.js";import"./chunk-UKb2nn92.js";import"./chunk-DHnjrG--.js";import"./chunk-B5Y5c6gs.js";import"./chunk-CMQLDEz_.js";const H=s(()=>{const{data:e}=t("organizations",{filter:{organization_type:"principal"},pagination:{page:1,perPage:100},sort:{field:"name",order:"ASC"}},{staleTime:3e5,gcTime:9e5,refetchOnWindowFocus:!1}),{data:s,isLoading:i}=t("distinct_product_categories",{pagination:{page:1,perPage:100},sort:{field:"name",order:"ASC"}},{staleTime:3e5,gcTime:9e5,refetchOnWindowFocus:!1});return r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsx(a,{children:r.jsx(u,{source:"q",placeholder:"Search products..."})}),r.jsx(I,{icon:r.jsx(M,{className:"h-4 w-4"}),label:"Product Status",children:[{id:"active",name:"Active"},{id:"discontinued",name:"Discontinued"},{id:"coming_soon",name:"Coming Soon"}].map(e=>r.jsx(B,{className:"w-full justify-between",label:e.name,value:{status:e.id}},e.id))}),r.jsx(I,{icon:r.jsx(W,{className:"h-4 w-4"}),label:"Category",children:i?r.jsx("div",{className:"text-sm text-muted-foreground px-3 py-1",children:"Loading..."}):s?.map(e=>r.jsx(B,{className:"w-full justify-between",label:e.name,value:{category:e.id}},e.id))}),e&&e.length>0&&r.jsx(I,{icon:r.jsx(V,{className:"h-4 w-4"}),label:"Principal/Supplier",children:e.map(e=>r.jsx(B,{className:"w-full justify-between",label:e.name,value:{principal_id:e.id}},e.id))})]})},"ProductListFilter"),Z={usf_code:"US Foods",sysco_code:"Sysco",gfs_code:"GFS",pfg_code:"PFG",greco_code:"Greco",gofo_code:"GOFO",rdp_code:"RDP",wilkens_code:"Wilkens"};function ee(e){return Object.keys(Z).some(s=>e[s])}function se({record:e,mode:t,onModeToggle:a}){const[l]=i(),d=n(),u=s(async s=>{try{await l("products",{id:e.id,data:s,previousData:e}),d("Product updated successfully",{type:"success"}),a?.()}catch(t){d("Error updating product",{type:"error"})}},"handleSave");if("edit"===t){const t=x.map(e=>({id:e,name:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})),a=j.map(e=>({id:e,name:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})),i=s(e=>{if(e)return{id:e,name:e}},"handleCreateCategory");return r.jsx(o,{value:e,children:r.jsx(c,{id:"slide-over-edit-form",onSubmit:u,record:e,children:r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx(h,{source:"name",label:"Product Name"}),r.jsx(h,{source:"description",label:"Description",multiline:!0,rows:3}),r.jsx(q,{source:"category",label:"Category",choices:t,onCreate:i,createItemLabel:"Add custom category: %{item}"}),r.jsx($,{source:"status",label:"Status",choices:a}),r.jsx(J,{source:"principal_id",reference:"organizations",label:"Principal/Supplier",filter:{organization_type:"principal"},children:r.jsx(q,{optionText:"name"})})]})})})})}return r.jsx(o,{value:e,children:r.jsxs("div",{className:"space-y-6",children:[r.jsx(K,{title:"Product Details",children:r.jsx(f,{children:r.jsxs(g,{className:"p-4 space-y-3",children:[r.jsx("div",{children:r.jsx("h3",{className:"text-lg font-semibold",children:e.name})}),e.description&&r.jsx("div",{children:r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.description})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Category:"}),r.jsx(y,{variant:"outline",children:e.category.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Status:"}),r.jsx(te,{status:e.status})]})]})})}),r.jsx(K,{title:"Principal/Supplier",children:r.jsx(f,{children:r.jsx(g,{className:"p-4",children:r.jsx(N,{source:"principal_id",reference:"organizations",link:"show",children:r.jsx(b,{source:"name",className:"font-medium"})})})})}),ee(e)&&r.jsx(K,{title:"Distributor Codes",children:r.jsx(f,{children:r.jsx(g,{className:"p-4",children:r.jsx("div",{className:"grid grid-cols-2 gap-2 p-3 bg-muted/50 rounded-md",children:Object.entries(Z).map(([s,t])=>{const a=e[s];return a?r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:[t,":"]}),r.jsx("span",{className:"text-sm font-mono",children:a})]},s):null})})})})})]})})}function te({status:e}){let s="default";switch(e){case"active":s="default";break;case"discontinued":s="destructive";break;case"coming_soon":s="secondary";break;default:s="outline"}return r.jsx(y,{variant:s,children:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})}function re({record:e}){const{data:s,isLoading:a}=t("opportunity_products",{filter:{product_id_reference:e.id},pagination:{page:1,perPage:100},sort:{field:"created_at",order:"DESC"}});return r.jsx(o,{value:e,children:r.jsxs("div",{className:"space-y-6",children:[e.principal_id&&r.jsx(K,{title:"Principal/Supplier",children:r.jsx(f,{children:r.jsx(g,{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(V,{className:"size-4 text-muted-foreground"}),r.jsx(N,{source:"principal_id",reference:"organizations",link:"show",children:r.jsx(b,{source:"name",className:"font-medium"})})]})})})}),r.jsx(K,{title:"Related Opportunities",children:r.jsx(f,{children:r.jsxs(g,{className:"p-4",children:[a&&r.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading opportunities..."}),!a&&(!s||0===s.length)&&r.jsx("div",{className:"text-sm text-muted-foreground",children:"No opportunities using this product yet."}),!a&&s&&s.length>0&&r.jsxs("div",{className:"space-y-2",children:[s.map(e=>r.jsx("div",{className:"border-b border-border pb-2 last:border-0 last:pb-0",children:r.jsxs(o,{value:e,children:[r.jsx(N,{source:"opportunity_id",reference:"opportunities",link:"show",children:r.jsx(b,{source:"title",className:"text-sm font-medium"})}),e.notes&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e.notes})]})},e.id)),s.length>5&&r.jsxs("div",{className:"text-xs text-muted-foreground pt-2",children:["Showing ",s.length," opportunit",1===s.length?"y":"ies"]})]})]})})}),r.jsx(K,{title:"Metadata",children:r.jsxs("div",{className:"space-y-2",children:[e.created_at&&r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Created on "}),r.jsx(Q,{source:"created_at",options:{year:"numeric",month:"long",day:"numeric"}})]}),e.updated_at&&r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Last updated on "}),r.jsx(Q,{source:"updated_at",options:{year:"numeric",month:"long",day:"numeric"}})]})]})})]})})}function ae({recordId:e,isOpen:t,onClose:a,mode:i,onModeToggle:n}){const o=[{key:"details",label:"Details",component:se,icon:W},{key:"relationships",label:"Relationships",component:re,icon:E}],c=s(e=>e.name||`Product #${e.id}`,"recordRepresentation");return r.jsx(T,{resource:"products",recordId:e,isOpen:t,onClose:a,mode:i,onModeToggle:n,tabs:o,recordRepresentation:c})}s(ee,"hasDistributorCodes$1"),s(se,"ProductDetailsTab"),s(te,"StatusBadge$1"),s(re,"ProductRelationshipsTab"),s(ae,"ProductSlideOver");const ie=s(()=>r.jsx(f,{className:"max-w-md mx-auto mt-16",children:r.jsxs(g,{className:"flex flex-col items-center justify-center p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:r.jsx(W,{className:"w-8 h-8 text-primary"})}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Products Yet"}),r.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Start building your product catalog. Add your first product to track inventory and sales opportunities."}),r.jsx(m,{label:"Add First Product"})]})}),"ProductEmpty"),ne=P([{key:"status",label:"Status",type:"select",choices:[{id:"active",name:"Active"},{id:"discontinued",name:"Discontinued"},{id:"coming_soon",name:"Coming Soon"}]},{key:"category",label:"Category",type:"select",reference:"categories"},{key:"principal_id",label:"Principal",type:"reference",reference:"organizations"}]),oe={usf_code:"USF",sysco_code:"Sysco",gfs_code:"GFS",pfg_code:"PFG",greco_code:"Greco",gofo_code:"GOFO",rdp_code:"RDP",wilkens_code:"Wilkens"};function ce(e){return Object.keys(oe).some(s=>e[s])}function le({record:e}){if(!ce(e))return r.jsx("span",{className:"text-muted-foreground",children:"—"});const s=Object.entries(oe).filter(([s])=>e[s]).map(([s,t])=>({label:t,value:e[s]}));return r.jsxs(R,{children:[r.jsx(z,{asChild:!0,children:r.jsxs("button",{className:"flex items-center gap-1 text-primary hover:text-primary/80",children:[r.jsx(W,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-xs",children:[s.length," codes"]})]})}),r.jsx(U,{className:"w-64",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium text-sm",children:"Distributor Codes"}),r.jsx("div",{className:"space-y-1",children:s.map(({label:e,value:s})=>r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{className:"text-muted-foreground",children:[e,":"]}),r.jsx("span",{className:"font-mono",children:s})]},e))})]})})]})}s(ce,"hasDistributorCodes"),s(le,"DistributorCodesPopover");const de=s(()=>{const{data:e,isPending:s}=l(),{slideOverId:t,isOpen:a,mode:i,openSlideOver:n,closeSlideOver:o,toggleMode:c}=L();return k("products"),s?r.jsx(_,{}):e?r.jsxs(r.Fragment,{children:[r.jsx("div",{"data-tutorial":"products-list",children:r.jsxs(p,{title:!1,actions:r.jsx(me,{}),perPage:25,sort:{field:"name",order:"ASC"},children:[r.jsx(ue,{openSlideOver:n,isSlideOverOpen:a}),r.jsx(S,{})]})}),r.jsx(ae,{recordId:t,isOpen:a,mode:i,onClose:o,onModeToggle:c}),r.jsx(X,{chapter:"products",position:"bottom-left"})]}):null},"ProductList"),ue=s(({openSlideOver:e,isSlideOverOpen:t})=>{const{data:a,isPending:i,filterValues:n}=d(),{focusedIndex:o}=C({onSelect:s(s=>e(Number(s),"view"),"onSelect"),enabled:!t}),c=n&&Object.keys(n).length>0;return i?r.jsx(O,{resource:"products",filterComponent:r.jsx(H,{}),children:r.jsx(_,{})}):a?.length||c?r.jsxs(r.Fragment,{children:[r.jsxs(O,{resource:"products",filterComponent:r.jsx(H,{}),children:[r.jsx(D,{filterConfig:ne}),r.jsxs(F,{onRowClick:s(s=>e(Number(s),"view"),"onRowClick"),focusedIndex:o,children:[r.jsx(b,{source:"name",label:"Product Name",...G.alwaysVisible}),r.jsx(Y,{label:"Dist. Codes",sortable:!1,render:s(e=>r.jsx(le,{record:e}),"render"),...G.alwaysVisible}),r.jsx(Y,{label:"Category",sortBy:"category",render:s(e=>r.jsx(pe,{category:e.category}),"render"),...G.alwaysVisible}),r.jsx(Y,{label:"Status",sortBy:"status",render:s(e=>r.jsx(xe,{status:e.status}),"render"),...G.alwaysVisible}),r.jsx(N,{source:"principal_id",reference:"organizations",label:"Principal",link:!1,sortable:!0,...G.desktopOnly,children:r.jsx(b,{source:"name"})}),r.jsx(Y,{label:"Certifications",sortable:!1,render:s(e=>r.jsx(je,{certifications:e.certifications}),"render"),...G.desktopOnly})]})]}),r.jsx(w,{})]}):r.jsx(ie,{})},"ProductListLayout"),me=s(()=>r.jsxs(A,{children:[r.jsx(v,{fields:["name","category","status"]}),r.jsx("span",{"data-tutorial":"create-product-btn",children:r.jsx(m,{})})]}),"ProductListActions");function pe({category:e}){return r.jsx(y,{variant:"outline",children:he(e)})}function xe({status:e}){let s="default";switch(e){case"active":s="default";break;case"discontinued":s="destructive";break;case"coming_soon":s="secondary";break;default:s="outline"}return r.jsx(y,{variant:s,children:he(e)})}function je({certifications:e}){return e&&0!==e.length?r.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.slice(0,3).map((e,s)=>r.jsx(y,{variant:"outline",className:"text-xs",children:e},s)),e.length>3&&r.jsxs(y,{variant:"secondary",className:"text-xs",children:["+",e.length-3]})]}):r.jsx("span",{className:"text-muted-foreground",children:"—"})}function he(e){return e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}s(pe,"CategoryBadge"),s(xe,"StatusBadge"),s(je,"CertificationBadges"),s(he,"formatSnakeCase");export{de as ProductList,de as default};
