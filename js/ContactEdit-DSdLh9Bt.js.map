{"version":3,"file":"ContactEdit-DSdLh9Bt.js","sources":["../../src/atomic-crm/activities/QuickLogActivity.tsx","../../src/atomic-crm/tasks/AddTask.tsx","../../src/atomic-crm/tasks/Task.tsx","../../src/atomic-crm/tasks/TasksIterator.tsx","../../src/atomic-crm/tags/colors.ts","../../src/atomic-crm/tags/RoundButton.tsx","../../src/atomic-crm/tags/TagDialog.tsx","../../src/atomic-crm/tags/TagEditModal.tsx","../../src/atomic-crm/tags/TagChip.tsx","../../src/atomic-crm/tags/TagCreateModal.tsx","../../src/atomic-crm/contacts/TagsListEdit.tsx","../../src/atomic-crm/contacts/ContactAside.tsx","../../src/atomic-crm/contacts/ContactEdit.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useDataProvider, useNotify, useGetOne } from \"ra-core\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectSeparator,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport type { Task, Opportunity } from \"../types\";\n\ninterface QuickLogActivityProps {\n  open: boolean;\n  onClose: () => void;\n  task: Task;\n}\n\n/**\n * All 13 activity types from PRD v1.18 organized into groups\n * Matches the structure in dashboard/v3/validation/activitySchema.ts\n */\nconst ACTIVITY_TYPE_GROUPS = {\n  Communication: [\n    { value: \"call\", label: \"Call\" },\n    { value: \"email\", label: \"Email\" },\n    { value: \"check_in\", label: \"Check-in\" },\n    { value: \"social\", label: \"Social\" },\n  ],\n  Meetings: [\n    { value: \"meeting\", label: \"Meeting\" },\n    { value: \"demo\", label: \"Demo\" },\n    { value: \"site_visit\", label: \"Site Visit\" },\n    { value: \"trade_show\", label: \"Trade Show\" },\n  ],\n  Documentation: [\n    { value: \"proposal\", label: \"Proposal\" },\n    { value: \"contract_review\", label: \"Contract Review\" },\n    { value: \"follow_up\", label: \"Follow-up\" },\n    { value: \"note\", label: \"Note\" },\n    { value: \"sample\", label: \"Sample\" },\n  ],\n} as const;\n\n// Maps task types to activity interaction types\nconst TASK_TYPE_TO_ACTIVITY_TYPE: Record<string, string> = {\n  Call: \"call\",\n  Email: \"email\",\n  Meeting: \"meeting\",\n  \"Follow-up\": \"follow_up\",\n  Demo: \"demo\",\n  Proposal: \"proposal\",\n  Other: \"check_in\",\n};\n\n// Infer activity type from task title keywords (all 13 types)\nconst inferActivityTypeFromTitle = (title: string): string => {\n  const lowerTitle = title.toLowerCase();\n\n  if (lowerTitle.includes(\"call\") || lowerTitle.includes(\"phone\")) return \"call\";\n  if (lowerTitle.includes(\"email\") || lowerTitle.includes(\"mail\")) return \"email\";\n  if (lowerTitle.includes(\"meeting\") || lowerTitle.includes(\"meet\")) return \"meeting\";\n  if (lowerTitle.includes(\"demo\") || lowerTitle.includes(\"demonstration\")) return \"demo\";\n  if (lowerTitle.includes(\"proposal\") || lowerTitle.includes(\"quote\")) return \"proposal\";\n  if (lowerTitle.includes(\"follow\") || lowerTitle.includes(\"check-in\")) return \"follow_up\";\n  if (lowerTitle.includes(\"visit\") || lowerTitle.includes(\"site\")) return \"site_visit\";\n  if (lowerTitle.includes(\"contract\") || lowerTitle.includes(\"agreement\")) return \"contract_review\";\n  if (lowerTitle.includes(\"trade\") || lowerTitle.includes(\"show\") || lowerTitle.includes(\"expo\"))\n    return \"trade_show\";\n  if (\n    lowerTitle.includes(\"social\") ||\n    lowerTitle.includes(\"linkedin\") ||\n    lowerTitle.includes(\"network\")\n  )\n    return \"social\";\n  if (lowerTitle.includes(\"sample\") || lowerTitle.includes(\"product\")) return \"sample\";\n  if (lowerTitle.includes(\"note\") || lowerTitle.includes(\"memo\")) return \"note\";\n\n  return \"check_in\"; // Default fallback\n};\n\nexport const QuickLogActivity: React.FC<QuickLogActivityProps> = ({ open, onClose, task }) => {\n  const dataProvider = useDataProvider();\n  const notify = useNotify();\n\n  // Determine initial activity type\n  const getInitialActivityType = () => {\n    // First try to use the task type if it exists and is not \"Other\"\n    if (task.type && task.type !== \"Other\") {\n      return TASK_TYPE_TO_ACTIVITY_TYPE[task.type] || \"check_in\";\n    }\n    // Otherwise infer from the title\n    return inferActivityTypeFromTitle(task.title);\n  };\n\n  const [activityType, setActivityType] = useState(getInitialActivityType());\n  const [notes, setNotes] = useState(`Completed task: ${task.title}`);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [organizationId, setOrganizationId] = useState<number | null>(null);\n\n  // Fetch opportunity to get organization_id if task has opportunity_id\n  const { data: opportunity } = useGetOne<Opportunity>(\n    \"opportunities\",\n    { id: task.opportunity_id || 0 },\n    { enabled: !!task.opportunity_id }\n  );\n\n  useEffect(() => {\n    if (opportunity) {\n      setOrganizationId(opportunity.customer_organization_id);\n    }\n  }, [opportunity]);\n\n  const handleSave = async () => {\n    setIsSubmitting(true);\n\n    try {\n      await dataProvider.create(\"activities\", {\n        data: {\n          activity_type: \"interaction\", // Required field for activities table\n          type: activityType, // The interaction_type enum\n          subject: `Completed: ${task.title}`,\n          description: notes,\n          activity_date: new Date().toISOString(),\n          contact_id: task.contact_id || null,\n          opportunity_id: task.opportunity_id || null,\n          organization_id: organizationId || null, // Use fetched organizationId from opportunity\n          related_task_id: task.id, // Link to the completed task\n          follow_up_required: false,\n        },\n      });\n\n      notify(\"Activity logged successfully\", { type: \"success\" });\n      onClose();\n    } catch (error) {\n      console.error(\"Error logging activity:\", error);\n      notify(\"Failed to log activity\", { type: \"error\" });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleSkip = () => {\n    onClose();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n      <DialogContent className=\"sm:max-w-[425px]\">\n        <DialogHeader>\n          <DialogTitle>Log Activity Details</DialogTitle>\n          <DialogDescription>What happened with this task? (optional)</DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-4 py-4\">\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"activity-type\">Activity Type</Label>\n            <Select value={activityType} onValueChange={setActivityType} disabled={isSubmitting}>\n              <SelectTrigger id=\"activity-type\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {/* Group 1: Communication (4 items) */}\n                <SelectGroup>\n                  <SelectLabel>Communication</SelectLabel>\n                  {ACTIVITY_TYPE_GROUPS.Communication.map((type) => (\n                    <SelectItem key={type.value} value={type.value}>\n                      {type.label}\n                    </SelectItem>\n                  ))}\n                </SelectGroup>\n\n                <SelectSeparator />\n\n                {/* Group 2: Meetings (4 items) */}\n                <SelectGroup>\n                  <SelectLabel>Meetings</SelectLabel>\n                  {ACTIVITY_TYPE_GROUPS.Meetings.map((type) => (\n                    <SelectItem key={type.value} value={type.value}>\n                      {type.label}\n                    </SelectItem>\n                  ))}\n                </SelectGroup>\n\n                <SelectSeparator />\n\n                {/* Group 3: Documentation (5 items) */}\n                <SelectGroup>\n                  <SelectLabel>Documentation</SelectLabel>\n                  {ACTIVITY_TYPE_GROUPS.Documentation.map((type) => (\n                    <SelectItem key={type.value} value={type.value}>\n                      {type.label}\n                    </SelectItem>\n                  ))}\n                </SelectGroup>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"notes\">Notes</Label>\n            <Textarea\n              id=\"notes\"\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              placeholder=\"What was discussed or accomplished?\"\n              className=\"min-h-[100px]\"\n              disabled={isSubmitting}\n            />\n          </div>\n        </div>\n\n        <DialogFooter className=\"gap-2 sm:gap-0\">\n          <Button type=\"button\" variant=\"outline\" onClick={handleSkip} disabled={isSubmitting}>\n            Skip\n          </Button>\n          <Button type=\"button\" onClick={handleSave} disabled={isSubmitting}>\n            {isSubmitting ? \"Saving...\" : \"Save Activity\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import { AutocompleteInput } from \"@/components/admin/autocomplete-input\";\nimport { ReferenceInput } from \"@/components/admin/reference-input\";\nimport { TextInput } from \"@/components/admin/text-input\";\nimport { SelectInput } from \"@/components/admin/select-input\";\nimport { SaveButton } from \"@/components/admin/form\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport { Plus } from \"lucide-react\";\nimport {\n  CreateBase,\n  Form,\n  RecordRepresentation,\n  useDataProvider,\n  useGetIdentity,\n  useNotify,\n  useRecordContext,\n  useUpdate,\n} from \"ra-core\";\n// Validation removed per Engineering Constitution - single-point validation at API boundary only\nimport { useState } from \"react\";\nimport { contactOptionText } from \"../contacts/ContactOption\";\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport { getTaskDefaultValues } from \"../validation/task\";\n\nexport const AddTask = ({\n  selectContact,\n  display = \"chip\",\n}: {\n  selectContact?: boolean;\n  display?: \"chip\" | \"icon\";\n}) => {\n  const { data: identity, isPending: isIdentityPending } = useGetIdentity();\n  const dataProvider = useDataProvider();\n  const [update] = useUpdate();\n  const notify = useNotify();\n  const { taskTypes } = useConfigurationContext();\n  const contact = useRecordContext();\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => {\n    setOpen(true);\n  };\n\n  const handleSuccess = async (data: any) => {\n    setOpen(false);\n\n    // Phase 3: Add error handling to prevent unhandled promise rejections\n    try {\n      const contact = await dataProvider.getOne(\"contacts\", {\n        id: data.contact_id,\n      });\n\n      if (!contact.data) {\n        notify(\"Task created, but couldn't update contact last_seen\", { type: \"warning\" });\n        return;\n      }\n\n      await update(\"contacts\", {\n        id: contact.data.id,\n        data: { last_seen: new Date().toISOString() },\n        previousData: contact.data,\n      });\n\n      notify(\"Task added\");\n    } catch (error) {\n      // Task was created successfully, but contact update failed\n      // This is non-critical - notify user but don't fail the operation\n      console.error(\"Failed to update contact last_seen:\", error);\n      notify(\"Task created, but couldn't update contact\", { type: \"warning\" });\n    }\n  };\n\n  if (isIdentityPending || !identity) return null;\n\n  return (\n    <>\n      {display === \"icon\" ? (\n        <TooltipProvider>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                className=\"h-11 w-11 p-0 cursor-pointer\"\n                onClick={handleOpen}\n              >\n                <Plus className=\"w-4 h-4\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent>Create task</TooltipContent>\n          </Tooltip>\n        </TooltipProvider>\n      ) : (\n        <div className=\"my-2\">\n          <Button variant=\"outline\" className=\"h-11 cursor-pointer\" onClick={handleOpen} size=\"sm\">\n            <Plus className=\"w-4 h-4\" />\n            Add task\n          </Button>\n        </div>\n      )}\n\n      <CreateBase\n        resource=\"tasks\"\n        record={{\n          ...getTaskDefaultValues(),\n          contact_id: contact?.id,\n          sales_id: identity.id,\n        }}\n        mutationOptions={{ onSuccess: handleSuccess }}\n      >\n        <Dialog open={open} onOpenChange={() => setOpen(false)}>\n          <DialogContent className=\"lg:max-w-xl overflow-y-auto max-h-9/10 top-1/20 translate-y-0\">\n            <Form className=\"flex flex-col gap-4\">\n              <DialogHeader>\n                <DialogTitle>\n                  {!selectContact ? \"Create a new task for \" : \"Create a new task\"}\n                  {!selectContact && <RecordRepresentation record={contact} resource=\"contacts\" />}\n                </DialogTitle>\n                <DialogDescription>\n                  Add a new task with title, description, due date, and priority.\n                </DialogDescription>\n              </DialogHeader>\n              <div className=\"flex flex-col gap-4\">\n                <TextInput\n                  source=\"title\"\n                  label=\"Task Title *\"\n                  className=\"m-0\"\n                  helperText=\"Required field\"\n                />\n                <TextInput\n                  source=\"description\"\n                  label=\"Description\"\n                  multiline\n                  className=\"m-0\"\n                  helperText=\"Optional details\"\n                />\n                {selectContact && (\n                  <ReferenceInput source=\"contact_id\" reference=\"contacts_summary\">\n                    <AutocompleteInput\n                      label=\"Contact *\"\n                      optionText={contactOptionText}\n                      helperText=\"Required field\"\n                    />\n                  </ReferenceInput>\n                )}\n\n                <div className=\"flex flex-row gap-4\">\n                  <TextInput\n                    source=\"due_date\"\n                    label=\"Due Date *\"\n                    helperText=\"Required field\"\n                    type=\"date\"\n                  />\n                  <SelectInput\n                    source=\"type\"\n                    label=\"Type *\"\n                    choices={taskTypes.map((type) => ({\n                      id: type,\n                      name: type,\n                    }))}\n                    helperText=\"Required field\"\n                  />\n                </div>\n              </div>\n              <DialogFooter className=\"w-full justify-end\">\n                <SaveButton />\n              </DialogFooter>\n            </Form>\n          </DialogContent>\n        </Dialog>\n      </CreateBase>\n    </>\n  );\n};\n","import { ReferenceField } from \"@/components/admin/reference-field\";\nimport { DateField } from \"@/components/admin/date-field\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport {\n  addDays,\n  addWeeks,\n  format,\n  isAfter,\n  isBefore,\n  startOfDay,\n  startOfToday,\n  startOfWeek,\n} from \"date-fns\";\nimport { MoreVertical } from \"lucide-react\";\nimport { useDeleteWithUndoController, useNotify, useUpdate } from \"ra-core\";\nimport { useEffect, useState } from \"react\";\nimport type { Contact, Task as TData } from \"../types\";\nimport TaskEdit from \"./TaskEdit\";\nimport { QuickLogActivity } from \"../activities/QuickLogActivity\";\nimport { cn } from \"@/lib/utils\";\nimport { parseDateSafely } from \"@/lib/date-utils\";\n\nexport const Task = ({ task, showContact }: { task: TData; showContact?: boolean }) => {\n  const notify = useNotify();\n  const queryClient = useQueryClient();\n\n  const today = startOfToday();\n  const taskDueDate = parseDateSafely(task.due_date)\n    ? startOfDay(parseDateSafely(task.due_date)!)\n    : today;\n  const tomorrow = addDays(today, 1);\n\n  // Calculate next Monday (start of next week). weekStartsOn: 1 ensures Monday is the start.\n  const nextMonday = startOfWeek(addWeeks(today, 1), { weekStartsOn: 1 });\n\n  // Check if task can be postponed\n  const canPostponeTomorrow = !isAfter(taskDueDate, today);\n  const canPostponeNextWeek = isBefore(taskDueDate, nextMonday);\n\n  // Format dates for display using date-fns\n  const tomorrowFormatted = format(tomorrow, \"EEE, MMM d\");\n  const nextMondayFormatted = format(nextMonday, \"EEE, MMM d\");\n\n  const [openEdit, setOpenEdit] = useState(false);\n  const [openActivityDialog, setOpenActivityDialog] = useState(false);\n\n  const handleCloseEdit = () => {\n    setOpenEdit(false);\n  };\n\n  const handleCloseActivityDialog = () => {\n    setOpenActivityDialog(false);\n  };\n\n  const [update, { isPending: isUpdatePending, isSuccess, variables }] = useUpdate();\n  const { handleDelete } = useDeleteWithUndoController({\n    record: task,\n    redirect: false,\n    mutationOptions: {\n      onSuccess() {\n        notify(\"Task deleted successfully\", { undoable: true });\n      },\n    },\n  });\n\n  const handleEdit = () => {\n    setOpenEdit(true);\n  };\n\n  const handleCheck = (checked: boolean) => {\n    update(\n      \"tasks\",\n      {\n        id: task.id,\n        data: {\n          id: task.id, // Include ID to trigger partial update validation\n          completed: checked,\n          completed_at: checked ? new Date().toISOString() : null,\n        },\n        previousData: task,\n      },\n      {\n        onSuccess: () => {\n          // Only open activity dialog when task is being completed (not uncompleted)\n          if (checked) {\n            setOpenActivityDialog(true);\n          }\n        },\n      }\n    );\n  };\n\n  useEffect(() => {\n    // We do not want to invalidate the query when a tack is checked or unchecked\n    if (isUpdatePending || !isSuccess || variables?.data?.completed_at != undefined) {\n      return;\n    }\n\n    queryClient.invalidateQueries({ queryKey: [\"tasks\", \"getList\"] });\n  }, [queryClient, isUpdatePending, isSuccess, variables]);\n\n  const labelId = `checkbox-list-label-${task.id}`;\n\n  return (\n    <>\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex items-start gap-2 flex-1\">\n          <Checkbox\n            id={labelId}\n            checked={!!task.completed_at}\n            onCheckedChange={handleCheck}\n            disabled={isUpdatePending}\n            className=\"mt-1\"\n          />\n          <div className={cn(\"flex-grow\", task.completed_at && \"line-through\")}>\n            <div className=\"text-sm\">\n              {task.type && task.type !== \"Other\" && (\n                <>\n                  <span className=\"font-semibold text-sm\">{task.type}</span>\n                  &nbsp;\n                </>\n              )}\n              {task.title}\n              {task.description && (\n                <span className=\"text-muted-foreground\"> - {task.description}</span>\n              )}\n            </div>\n            <div className=\"text-sm text-muted-foreground\">\n              due&nbsp;\n              <DateField source=\"due_date\" record={task} />\n              {showContact && (\n                <ReferenceField<TData, Contact>\n                  source=\"contact_id\"\n                  reference=\"contacts\"\n                  record={task}\n                  link=\"show\"\n                  className=\"inline text-sm text-muted-foreground\"\n                  render={({ referenceRecord }) => {\n                    if (!referenceRecord) return null;\n                    return (\n                      <>\n                        {\" \"}\n                        (Re:&nbsp;\n                        {referenceRecord?.first_name} {referenceRecord?.last_name})\n                      </>\n                    );\n                  }}\n                />\n              )}\n            </div>\n          </div>\n        </div>\n\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"icon\" className=\"shrink-0\" aria-label=\"task actions\">\n              <MoreVertical className=\"h-4 w-4\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\">\n            {canPostponeTomorrow && (\n              <DropdownMenuItem\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  update(\"tasks\", {\n                    id: task.id,\n                    data: {\n                      ...task, // Include all existing task fields\n                      due_date: format(tomorrow, \"yyyy-MM-dd\"),\n                    },\n                    previousData: task,\n                  });\n                }}\n              >\n                Postpone to tomorrow ({tomorrowFormatted})\n              </DropdownMenuItem>\n            )}\n            {canPostponeNextWeek && (\n              <DropdownMenuItem\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  update(\"tasks\", {\n                    id: task.id,\n                    data: {\n                      ...task, // Include all existing task fields\n                      due_date: format(nextMonday, \"yyyy-MM-dd\"),\n                    },\n                    previousData: task,\n                  });\n                }}\n              >\n                Postpone to next week ({nextMondayFormatted})\n              </DropdownMenuItem>\n            )}\n            <DropdownMenuItem className=\"cursor-pointer\" onClick={handleEdit}>\n              Edit\n            </DropdownMenuItem>\n            <DropdownMenuItem className=\"cursor-pointer\" onClick={handleDelete}>\n              Delete\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </div>\n\n      {/* This part is for editing the Task directly via a Dialog */}\n      {openEdit && <TaskEdit taskId={task.id} open={openEdit} close={handleCloseEdit} />}\n\n      {/* Quick log activity dialog after task completion */}\n      {openActivityDialog && (\n        <QuickLogActivity\n          open={openActivityDialog}\n          onClose={handleCloseActivityDialog}\n          task={task}\n        />\n      )}\n    </>\n  );\n};\n","import { isAfter } from \"date-fns\";\nimport { useListContext } from \"ra-core\";\nimport { cn } from \"@/lib/utils\";\nimport { Task } from \"./Task\";\nimport { parseDateSafely } from \"@/lib/date-utils\";\n\nexport const TasksIterator = ({\n  showContact,\n  className,\n}: {\n  showContact?: boolean;\n  className?: string;\n}) => {\n  const { data, error, isPending } = useListContext();\n  if (isPending || error || data.length === 0) return null;\n\n  const tasks = data.filter((task) => {\n    if (!task.completed_at) return true;\n    const completedDate = parseDateSafely(task.completed_at);\n    return completedDate ? isAfter(completedDate, new Date(Date.now() - 5 * 60 * 1000)) : true;\n  });\n\n  return (\n    <div className={cn(\"space-y-2\", className)}>\n      {tasks.map((task) => (\n        <Task task={task} showContact={showContact} key={task.id} />\n      ))}\n    </div>\n  );\n};\n","import type { TagColorName } from \"@/lib/color-types\";\nimport { VALID_TAG_COLORS } from \"@/lib/color-types\";\n\n// Export the semantic color names for the tag color picker\nexport const colors: TagColorName[] = VALID_TAG_COLORS;\n","import { getTagColorClass, normalizeColorToSemantic } from \"./tag-colors\";\n\ninterface RoundButtonProps {\n  color: string;\n  handleClick: () => void;\n  selected: boolean;\n}\n\nexport const RoundButton = ({ color, handleClick, selected }: RoundButtonProps) => {\n  // Convert hex color to semantic color name and get the CSS class\n  const semanticColorName = normalizeColorToSemantic(color);\n  const colorClass = getTagColorClass(color);\n\n  return (\n    <button\n      type=\"button\"\n      className={`\n        w-11 h-11 rounded-full inline-block m-1 transition-all\n        ${colorClass}\n        ${\n          selected\n            ? \"ring-2 ring-offset-2 ring-primary shadow-md scale-110\"\n            : \"hover:scale-105 hover:shadow-sm\"\n        }\n      `}\n      onClick={handleClick}\n      aria-label={`Select ${semanticColorName} color`}\n      aria-pressed={selected}\n    />\n  );\n};\n","import { Button } from \"@/components/ui/button\";\nimport { buttonVariants } from \"@/components/ui/button.constants\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { cn } from \"@/lib/utils\";\nimport { Loader2, SaveIcon } from \"lucide-react\";\nimport { useEffect, useMemo } from \"react\";\nimport { useForm, FormProvider } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport type { Tag } from \"../types\";\nimport { colors } from \"./colors\";\nimport { RoundButton } from \"./RoundButton\";\nimport type { TagColorName } from \"@/lib/color-types\";\nimport { createTagSchema, type CreateTagInput } from \"../validation/tags\";\nimport { FormErrorSummary } from \"@/components/admin/FormErrorSummary\";\n\ninterface TagDialogProps {\n  open: boolean;\n  tag?: Pick<Tag, \"name\" | \"color\">;\n  title: string;\n  onSubmit(tag: Pick<Tag, \"name\" | \"color\">): Promise<void>;\n  onClose(): void;\n}\n\n/**\n * TagDialog - Constitution-compliant modal for creating/editing tags\n *\n * P2: Schema defaults via createTagSchema.partial().parse({})\n * P3: FormErrorSummary for accessible error aggregation\n * P5: Form mode \"onSubmit\" for performance (no re-render storms)\n */\nexport function TagDialog({ open, tag, title, onClose, onSubmit }: TagDialogProps) {\n  // P2: Schema-derived defaults - NOT local useState\n  // This ensures Zod type coercion is applied\n  const defaultValues = useMemo(\n    () =>\n      createTagSchema.partial().parse({\n        name: tag?.name ?? \"\",\n        color: tag?.color ?? \"warm\",\n      }),\n    [tag]\n  );\n\n  const form = useForm<CreateTagInput>({\n    resolver: zodResolver(createTagSchema),\n    defaultValues,\n    mode: \"onSubmit\", // P5: onSubmit mode for performance\n  });\n\n  const {\n    register,\n    handleSubmit,\n    reset,\n    setValue,\n    watch,\n    formState: { errors, isSubmitting, isValid, isDirty },\n  } = form;\n\n  // Watch color for the color picker UI\n  const selectedColor = watch(\"color\") as TagColorName;\n\n  // Reset form when dialog opens/closes or tag changes\n  useEffect(() => {\n    if (open) {\n      reset({\n        name: tag?.name ?? \"\",\n        color: (tag?.color as TagColorName) ?? \"warm\",\n      });\n    }\n  }, [open, tag, reset]);\n\n  const handleFormSubmit = async (data: CreateTagInput) => {\n    await onSubmit({ name: data.name, color: data.color });\n    reset(defaultValues);\n    onClose();\n  };\n\n  const handleClose = () => {\n    // Check for unsaved changes before closing\n    if (isDirty) {\n      const confirmed = window.confirm(\n        'You have unsaved changes. Are you sure you want to close?'\n      );\n      if (!confirmed) return;\n    }\n    reset(defaultValues);\n    onClose();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-lg\">\n        <FormProvider {...form}>\n          <form onSubmit={handleSubmit(handleFormSubmit)}>\n            <DialogHeader>\n              <DialogTitle>{title}</DialogTitle>\n              <DialogDescription>Enter a name and choose a color for your tag.</DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-4 py-4\">\n              {/* P3: FormErrorSummary for accessible error aggregation */}\n              <FormErrorSummary\n                errors={errors}\n                fieldLabels={{\n                  name: \"Tag Name\",\n                  color: \"Color\",\n                }}\n              />\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"tag-name\">Tag name</Label>\n                <Input\n                  id=\"tag-name\"\n                  {...register(\"name\")}\n                  placeholder=\"Enter tag name\"\n                  aria-invalid={!!errors.name}\n                  aria-describedby={errors.name ? \"name-error\" : undefined}\n                />\n                {errors.name && (\n                  <p id=\"name-error\" className=\"text-sm text-destructive\" role=\"alert\">\n                    {errors.name.message}\n                  </p>\n                )}\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Color</Label>\n                <div className=\"flex flex-wrap gap-1\">\n                  {colors.map((color) => (\n                    <div key={color} className=\"relative group\">\n                      <RoundButton\n                        color={color}\n                        selected={color === selectedColor}\n                        handleClick={() => {\n                          setValue(\"color\", color, { shouldValidate: true });\n                        }}\n                      />\n                      <span className=\"absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap\">\n                        {color}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n                {errors.color && (\n                  <p id=\"color-error\" className=\"text-sm text-destructive mt-1\" role=\"alert\">\n                    {errors.color.message}\n                  </p>\n                )}\n              </div>\n            </div>\n\n            <div className=\"flex justify-end pt-4\">\n              <Button\n                type=\"submit\"\n                variant=\"outline\"\n                disabled={isSubmitting}\n                className={cn(\n                  buttonVariants({ variant: \"outline\" }),\n                  \"text-primary\",\n                  isSubmitting ? \"opacity-50 cursor-not-allowed\" : \"cursor-pointer\"\n                )}\n              >\n                {isSubmitting ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    Saving...\n                  </>\n                ) : (\n                  <>\n                    <SaveIcon />\n                    Save\n                  </>\n                )}\n              </Button>\n            </div>\n          </form>\n        </FormProvider>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import { useUpdate } from \"ra-core\";\nimport type { Tag } from \"../types\";\nimport { TagDialog } from \"./TagDialog\";\n\ninterface TagEditModalProps {\n  tag: Tag;\n  open: boolean;\n  onClose(): void;\n  onSuccess?(tag: Tag): Promise<void>;\n}\n\nexport function TagEditModal({ tag, open, onClose, onSuccess }: TagEditModalProps) {\n  const [update] = useUpdate<Tag>();\n\n  const handleEditTag = async (data: Pick<Tag, \"name\" | \"color\">) => {\n    await update(\n      \"tags\",\n      { id: tag.id, data, previousData: tag },\n      {\n        onSuccess: async (tag) => {\n          await onSuccess?.(tag);\n        },\n      }\n    );\n  };\n\n  return (\n    <TagDialog open={open} title=\"Edit tag\" onClose={onClose} onSubmit={handleEditTag} tag={tag} />\n  );\n}\n","import { X } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport type { Tag } from \"../types\";\nimport { TagEditModal } from \"./TagEditModal\";\nimport { getTagColorClass } from \"./tag-colors\";\n\ninterface TagChipProps {\n  tag: Tag;\n\n  onUnlink: () => Promise<void>;\n}\n\nexport function TagChip({ tag, onUnlink }: TagChipProps) {\n  const [open, setOpen] = useState(false);\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleClick = () => {\n    setOpen(true);\n  };\n\n  return (\n    <>\n      <div\n        className={cn(\n          \"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md cursor-pointer\",\n          \"border border-[var(--tag-border)]\",\n          \"transition-all duration-200\",\n          \"hover:shadow-sm hover:scale-[1.02] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2\",\n          getTagColorClass(tag.color)\n        )}\n        onClick={handleClick}\n        tabIndex={0}\n        role=\"button\"\n        onKeyDown={(e) => {\n          if (e.key === \"Enter\" || e.key === \" \") {\n            e.preventDefault();\n            handleClick();\n          }\n        }}\n      >\n        {tag.name}\n        {/* Remove button with 44px touch target (WCAG 2.5.5) - uses negative margin to maintain visual density */}\n        <button\n          onClick={(e) => {\n            e.stopPropagation();\n            onUnlink();\n          }}\n          className=\"relative -my-2 -mr-1 ml-0.5 h-11 w-11 flex items-center justify-center transition-colors cursor-pointer hover:opacity-70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-1 rounded-sm\"\n          aria-label={`Remove ${tag.name} tag`}\n        >\n          <X className=\"w-3 h-3\" />\n        </button>\n      </div>\n      <TagEditModal tag={tag} open={open} onClose={handleClose} />\n    </>\n  );\n}\n","import { useCreate } from \"ra-core\";\nimport type { Tag } from \"../types\";\nimport { TagDialog } from \"./TagDialog\";\n\ninterface TagCreateModalProps {\n  open: boolean;\n  onClose(): void;\n  onSuccess?(tag: Tag): Promise<void>;\n}\n\nexport function TagCreateModal({ open, onClose, onSuccess }: TagCreateModalProps) {\n  const [create] = useCreate<Tag>();\n\n  const handleCreateTag = async (data: Pick<Tag, \"name\" | \"color\">) => {\n    await create(\n      \"tags\",\n      { data },\n      {\n        onSuccess: async (tag) => {\n          await onSuccess?.(tag);\n        },\n      }\n    );\n  };\n\n  return (\n    <TagDialog open={open} title=\"Create a new tag\" onClose={onClose} onSubmit={handleCreateTag} />\n  );\n}\n","import { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Edit, Plus } from \"lucide-react\";\nimport type { Identifier } from \"ra-core\";\nimport { useGetList, useGetMany, useRecordContext, useUpdate } from \"ra-core\";\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nimport { TagChip } from \"../tags/TagChip\";\nimport { TagCreateModal } from \"../tags/TagCreateModal\";\nimport { getTagColorClass } from \"../tags/tag-colors\";\nimport type { Contact, Tag } from \"../types\";\n\nexport const TagsListEdit = () => {\n  const record = useRecordContext<Contact>();\n  const [open, setOpen] = useState(false);\n\n  const { data: allTags, isPending: isPendingAllTags } = useGetList<Tag>(\"tags\", {\n    pagination: { page: 1, perPage: 10 },\n    sort: { field: \"name\", order: \"ASC\" },\n  });\n  const { data: tags, isPending: isPendingRecordTags } = useGetMany<Tag>(\n    \"tags\",\n    { ids: record?.tags },\n    { enabled: record && record.tags && record.tags.length > 0 }\n  );\n  const [update] = useUpdate<Contact>();\n\n  const unselectedTags =\n    allTags && record && allTags.filter((tag) => !record.tags.includes(tag.id));\n\n  const handleTagAdd = (id: Identifier) => {\n    if (!record) {\n      throw new Error(\"No contact record found\");\n    }\n    const tags = [...record.tags, id];\n    update(\"contacts\", {\n      id: record.id,\n      data: { tags }, // Only send the tags field\n      previousData: record,\n    });\n  };\n\n  const handleTagDelete = async (id: Identifier) => {\n    if (!record) {\n      throw new Error(\"No contact record found\");\n    }\n    const tags = record.tags.filter((tagId) => tagId !== id);\n    await update(\"contacts\", {\n      id: record.id,\n      data: { tags }, // Only send the tags field\n      previousData: record,\n    });\n  };\n\n  const openTagCreateDialog = () => {\n    setOpen(true);\n  };\n\n  const handleTagCreateClose = () => {\n    setOpen(false);\n  };\n\n  const handleTagCreated = React.useCallback(\n    async (tag: Tag) => {\n      if (!record) {\n        throw new Error(\"No contact record found\");\n      }\n\n      await update(\n        \"contacts\",\n        {\n          id: record.id,\n          data: { tags: [...record.tags, tag.id] }, // Only send the tags field\n          previousData: record,\n        },\n        {\n          onSuccess: () => {\n            setOpen(false);\n          },\n        }\n      );\n    },\n    [update, record]\n  );\n\n  if (isPendingRecordTags || isPendingAllTags) return null;\n\n  return (\n    <div className=\"flex flex-wrap gap-2\">\n      {tags?.map((tag) => (\n        <div key={tag.id}>\n          <TagChip tag={tag} onUnlink={() => handleTagDelete(tag.id)} />\n        </div>\n      ))}\n\n      <div>\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"outline\" size=\"sm\" className=\"h-11 px-3 cursor-pointer\">\n              <Plus className=\"h-4 w-4 mr-1\" />\n              Add tag\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent>\n            {unselectedTags?.map((tag) => (\n              <DropdownMenuItem key={tag.id} onClick={() => handleTagAdd(tag.id)}>\n                <Badge\n                  variant=\"secondary\"\n                  className={cn(\"text-xs font-normal\", getTagColorClass(tag.color))}\n                >\n                  {tag.name}\n                </Badge>\n              </DropdownMenuItem>\n            ))}\n            <DropdownMenuItem onClick={openTagCreateDialog}>\n              <Button variant=\"ghost\" size=\"sm\" className=\"w-full justify-start p-0 cursor-pointer\">\n                <Edit className=\"h-3 w-3 mr-2\" />\n                Create new tag\n              </Button>\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </div>\n\n      <TagCreateModal open={open} onClose={handleTagCreateClose} onSuccess={handleTagCreated} />\n    </div>\n  );\n};\n","import { Linkedin, Mail, Phone } from \"lucide-react\";\nimport { useRecordContext, WithRecord } from \"ra-core\";\nimport { AddTask } from \"../tasks/AddTask\";\nimport { TasksIterator } from \"../tasks/TasksIterator\";\nimport { TagsListEdit } from \"./TagsListEdit\";\n\nimport { ArrayField } from \"@/components/admin/array-field\";\nimport { EditButton } from \"@/components/admin/edit-button\";\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { ReferenceManyField } from \"@/components/admin/reference-many-field\";\nimport { ShowButton } from \"@/components/admin/show-button\";\nimport { SingleFieldList } from \"@/components/admin/single-field-list\";\nimport { TextField } from \"@/components/admin/text-field\";\nimport { DateField } from \"@/components/admin/date-field\";\nimport { EmailField } from \"@/components/admin/email-field\";\nimport type { ReactNode } from \"react\";\nimport { AsideSection } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport type { Contact } from \"../types\";\n\nexport const ContactAside = ({ link = \"edit\" }: { link?: \"edit\" | \"show\" }) => {\n  const record = useRecordContext<Contact>();\n  if (!record) return null;\n  return (\n    <div className=\"hidden sm:block w-64 min-w-64 text-sm\">\n      <div className=\"mb-4 -ml-1\">\n        {link === \"edit\" ? (\n          <EditButton label=\"Edit Contact\" />\n        ) : (\n          <ShowButton label=\"Show Contact\" />\n        )}\n      </div>\n\n      <AsideSection title=\"Personal info\">\n        <ArrayField source=\"email\">\n          <SingleFieldList className=\"flex-col\">\n            <PersonalInfoRow\n              icon={<Mail className=\"w-4 h-4 text-muted-foreground\" />}\n              primary={<EmailField source=\"email\" />}\n            />\n          </SingleFieldList>\n        </ArrayField>\n\n        {record.linkedin_url && (\n          <PersonalInfoRow\n            icon={<Linkedin className=\"w-4 h-4 text-muted-foreground\" />}\n            primary={\n              <a\n                className=\"underline hover:no-underline text-sm text-muted-foreground\"\n                href={record.linkedin_url}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                title={record.linkedin_url}\n              >\n                LinkedIn\n              </a>\n            }\n          />\n        )}\n        <ArrayField source=\"phone\">\n          <SingleFieldList className=\"flex-col\">\n            <PersonalInfoRow\n              icon={<Phone className=\"w-4 h-4 text-muted-foreground\" />}\n              primary={<TextField source=\"number\" />}\n              showType\n            />\n          </SingleFieldList>\n        </ArrayField>\n      </AsideSection>\n\n      <AsideSection title=\"Position\">\n        <div className=\"flex flex-col gap-2 p-3 rounded-md bg-muted border-l-[3px] border-border\">\n          {record.organization_id && (\n            <div className=\"text-lg font-bold text-foreground mb-1\">\n              <ReferenceField source=\"organization_id\" reference=\"organizations\">\n                <TextField source=\"name\" />\n              </ReferenceField>\n            </div>\n          )}\n          {record.department && (\n            <div className=\"text-sm font-medium text-foreground leading-tight\">\n              <span className=\"text-sm text-muted-foreground\">Dept: </span>\n              {record.department}\n            </div>\n          )}\n          {record.title && (\n            <div className=\"text-sm text-muted-foreground leading-tight mt-0.5\">\n              <span>Title: </span>\n              {record.title}\n            </div>\n          )}\n        </div>\n      </AsideSection>\n\n      <AsideSection title=\"Contact info\">\n        <div className=\"text-muted-foreground\">\n          <span className=\"text-sm\">Added on</span>{\" \"}\n          <DateField\n            source=\"first_seen\"\n            options={{ year: \"numeric\", month: \"long\", day: \"numeric\" }}\n          />\n        </div>\n\n        <div className=\"text-muted-foreground\">\n          <span className=\"text-sm\">Last activity on</span>{\" \"}\n          <DateField\n            source=\"last_seen\"\n            options={{ year: \"numeric\", month: \"long\", day: \"numeric\" }}\n          />\n        </div>\n\n        <div className=\"text-muted-foreground\">\n          Followed by{\" \"}\n          <ReferenceField source=\"sales_id\" reference=\"sales\">\n            <SaleName />\n          </ReferenceField>\n        </div>\n      </AsideSection>\n\n      <AsideSection title=\"Tags\">\n        <TagsListEdit />\n      </AsideSection>\n\n      {record.notes && (\n        <AsideSection title=\"Notes\">\n          <div className=\"text-sm text-foreground whitespace-pre-wrap bg-muted p-3 rounded-md border-l-[3px] border-border\">\n            {record.notes}\n          </div>\n        </AsideSection>\n      )}\n\n      <AsideSection title=\"Tasks\">\n        <ReferenceManyField\n          target=\"contact_id\"\n          reference=\"tasks\"\n          sort={{ field: \"due_date\", order: \"ASC\" }}\n        >\n          <TasksIterator />\n        </ReferenceManyField>\n        <AddTask />\n      </AsideSection>\n    </div>\n  );\n};\n\nconst PersonalInfoRow = ({\n  icon,\n  primary,\n  showType,\n}: {\n  icon: ReactNode;\n  primary: ReactNode;\n  showType?: boolean;\n}) => (\n  <div className=\"flex flex-row items-center gap-2 min-h-6\">\n    {icon}\n    <div className=\"flex flex-wrap gap-x-2 gap-y-0\">\n      {primary}\n      {showType ? (\n        <WithRecord\n          render={(row) =>\n            row.type !== \"Other\" && <TextField source=\"type\" className=\"text-muted-foreground\" />\n          }\n        />\n      ) : null}\n    </div>\n  </div>\n);\n","import { Card, CardContent } from \"@/components/ui/card\";\nimport { ResponsiveGrid } from \"@/components/design-system\";\nimport { EditBase, Form, useEditContext } from \"ra-core\";\n\nimport type { Contact } from \"../types\";\nimport { ContactAside } from \"./ContactAside\";\nimport { ContactInputs } from \"./ContactInputs\";\nimport { FormToolbar } from \"../layout/FormToolbar\";\n\nexport const ContactEdit = () => (\n  <EditBase redirect=\"show\">\n    <ContactEditContent />\n  </EditBase>\n);\n\nconst ContactEditContent = () => {\n  const { isPending, record } = useEditContext<Contact>();\n  if (isPending || !record) return null;\n  return (\n    <ResponsiveGrid variant=\"dashboard\" className=\"mt-2\">\n      <main role=\"main\" aria-label=\"Edit contact\">\n        <Form className=\"flex flex-col gap-4\">\n          <Card>\n            <CardContent>\n              <ContactInputs />\n              <FormToolbar />\n            </CardContent>\n          </Card>\n        </Form>\n      </main>\n\n      <aside aria-label=\"Contact information\">\n        <ContactAside link=\"show\" />\n      </aside>\n    </ResponsiveGrid>\n  );\n};\n\nexport default ContactEdit;\n"],"names":["ACTIVITY_TYPE_GROUPS","Communication","value","label","Meetings","Documentation","TASK_TYPE_TO_ACTIVITY_TYPE","Call","Email","Meeting","Demo","Proposal","Other","inferActivityTypeFromTitle","title","lowerTitle","toLowerCase","includes","QuickLogActivity","__name","open","onClose","task","dataProvider","useDataProvider","notify","useNotify","getInitialActivityType","type","activityType","setActivityType","useState","notes","setNotes","isSubmitting","setIsSubmitting","organizationId","setOrganizationId","data","opportunity","useGetOne","id","opportunity_id","enabled","useEffect","customer_organization_id","handleSave","async","create","activity_type","subject","description","activity_date","Date","toISOString","contact_id","organization_id","related_task_id","follow_up_required","error","handleSkip","jsx","Dialog","onOpenChange","isOpen","children","jsxs","DialogContent","className","DialogHeader","DialogTitle","DialogDescription","Label","htmlFor","Select","onValueChange","disabled","SelectTrigger","SelectValue","SelectContent","SelectGroup","SelectLabel","map","SelectItem","SelectSeparator","Textarea","onChange","e","target","placeholder","DialogFooter","Button","variant","onClick","AddTask","selectContact","display","identity","isPending","isIdentityPending","useGetIdentity","update","useUpdate","taskTypes","useConfigurationContext","contact","useRecordContext","setOpen","handleOpen","handleSuccess","getOne","last_seen","previousData","Fragment","TooltipProvider","Tooltip","TooltipTrigger","asChild","size","Plus","TooltipContent","CreateBase","resource","record","getTaskDefaultValues","sales_id","mutationOptions","onSuccess","Form","RecordRepresentation","TextInput","source","helperText","multiline","ReferenceInput","reference","AutocompleteInput","optionText","contactOptionText","SelectInput","choices","name","SaveButton","Task","showContact","queryClient","useQueryClient","today","startOfToday","taskDueDate","parseDateSafely","due_date","startOfDay","tomorrow","addDays","nextMonday","startOfWeek","addWeeks","weekStartsOn","canPostponeTomorrow","isAfter","canPostponeNextWeek","isBefore","tomorrowFormatted","format","nextMondayFormatted","openEdit","setOpenEdit","openActivityDialog","setOpenActivityDialog","handleCloseEdit","handleCloseActivityDialog","isUpdatePending","isSuccess","variables","handleDelete","useDeleteWithUndoController","redirect","undoable","handleEdit","handleCheck","checked","completed","completed_at","invalidateQueries","queryKey","labelId","Checkbox","onCheckedChange","cn","DateField","ReferenceField","link","render","referenceRecord","first_name","last_name","DropdownMenu","DropdownMenuTrigger","MoreVertical","DropdownMenuContent","align","DropdownMenuItem","TaskEdit","taskId","close","TasksIterator","useListContext","length","tasks","filter","completedDate","now","colors","VALID_TAG_COLORS","RoundButton","color","handleClick","selected","semanticColorName","normalizeColorToSemantic","colorClass","getTagColorClass","TagDialog","tag","onSubmit","defaultValues","useMemo","createTagSchema","partial","parse","form","useForm","resolver","zodResolver","mode","register","handleSubmit","reset","setValue","watch","formState","errors","isValid","isDirty","selectedColor","handleFormSubmit","handleClose","window","confirm","FormProvider","FormErrorSummary","fieldLabels","Input","role","message","shouldValidate","buttonVariants","Loader2","SaveIcon","TagEditModal","handleEditTag","TagChip","onUnlink","tabIndex","onKeyDown","key","preventDefault","stopPropagation","X","TagCreateModal","useCreate","handleCreateTag","TagsListEdit","allTags","isPendingAllTags","useGetList","pagination","page","perPage","sort","field","order","tags","isPendingRecordTags","useGetMany","ids","unselectedTags","handleTagAdd","Error","handleTagDelete","tagId","openTagCreateDialog","handleTagCreateClose","handleTagCreated","React.useCallback","Badge","Edit","ContactAside","EditButton","ShowButton","AsideSection","ArrayField","SingleFieldList","PersonalInfoRow","icon","Mail","primary","EmailField","linkedin_url","Linkedin","href","rel","Phone","TextField","showType","department","options","year","month","day","SaleName","ReferenceManyField","WithRecord","row","ContactEdit","EditBase","ContactEditContent","useEditContext","ResponsiveGrid","Card","CardContent","ContactInputs","FormToolbar"],"mappings":"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"}