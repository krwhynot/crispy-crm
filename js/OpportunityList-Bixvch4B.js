var e=Object.defineProperty,t=(t,a)=>e(t,"name",{value:a,configurable:!0});import{j as a,l as s,aE as n,ae as r,aF as i,G as o,D as l,aG as c,aH as d,aI as u,aJ as p,a7 as m,K as h,H as g,a8 as x,aK as f,aL as y,am as b,an as v,P as j,u as N,e as w,U as C,i as _,az as S,W as k,as as O,w as I,$ as P,ar as A,aj as T,ak as $,J as L,Q as D,al as E}from"./chunk-ByJg_QQB.js";import{r as z,R as V,L as R,e as M}from"./chunk-1NZFT-6z.js";import{C as F,S as W,L as B,E as q}from"./chunk-BBQ6yJWi.js";import{b as U}from"./chunk-CK25VQTM.js";import{g as H,a as K,b as G,c as Q,d as J,O as X,e as Z,f as Y}from"./chunk-CFj7NhUg.js";import{b as ee,u as te,L as ae,F as se}from"./chunk-C8K6x_Yi.js";import{ah as ne,ai as re,aj as ie,s as oe,B as le,ak as ce,L as de,a4 as ue,i as pe,j as me,k as he,m as ge,n as xe,D as fe,e as ye,f as be,g as ve,h as je,q as Ne,al as we,am as Ce,an as _e,T as Se,p as ke,Z as Oe,$ as Ie,a0 as Pe,a1 as Ae,ao as Te,ap as $e,V as Le,W as De,X as Ee,d as ze,S as Ve,C as Re,r as Me,U as Fe,a7 as We}from"../assets/index-BoLku8RR.js";import{d as Be,a as qe,F as Ue}from"./chunk-JxeXaC9i.js";import{a as He}from"./chunk-Cw2QhEKy.js";import{C as Ke,a as Ge,b as Qe,c as Je,d as Xe,e as Ze}from"./chunk-CMQLDEz_.js";import{P as Ye,a as et,b as tt}from"./chunk-C_u3nriX.js";import{p as at,as as st,C as nt,at as rt,x as it,k as ot,ak as lt,s as ct,y as dt,a7 as ut,au as pt,q as mt,F as ht,a8 as gt,ah as xt,an as ft,o as yt,f as bt,av as vt,aw as jt,ax as Nt,Q as wt,ai as Ct,ay as _t,ag as St,T as kt,X as Ot,a4 as It,az as Pt,aA as At,E as Tt,am as $t,e as Lt,Y as Dt,a0 as Et,U as zt,a2 as Vt,aB as Rt,Z as Mt,aC as Ft,af as Wt}from"./chunk-Bc6KM1xM.js";import{v as Bt,s as qt,S as Ut,F as Ht}from"./chunk-A2EVsQEK.js";import{T as Kt}from"./chunk-BtJ7Qrct.js";import{c as Gt,d as Qt,y as Jt,b as Xt,a as Zt,o as Yt,j as ea,k as ta,l as aa}from"./chunk-DwAffUXc.js";import{P as sa}from"./chunk-ChZ4Kv6b.js";import{u as na}from"./chunk-CfuGOU5i.js";import{P as ra,C as ia,D as oa}from"./chunk-XoqkUGE_.js";import{S as la}from"./chunk-C5fZsuMg.js";import{C as ca}from"./chunk-Dn-NAOCt.js";import{g as da,f as ua,r as pa,s as ma,d as ha,b as ga,n as xa,a as fa,o as ya,c as ba,e as va,h as ja,i as Na,j as wa,k as Ca,l as _a,m as Sa,p as ka,q as Oa,t as Ia,u as Pa,v as Aa,w as Ta,x as $a,y as La,z as Da,A as Ea,B as za,F as Va,T as Ra}from"./chunk-C6dCzd_-.js";import{R as Ma}from"./chunk-DbeoRBEW.js";import{E as Fa}from"./chunk-DfGVVS-c.js";import{a3 as Wa,a4 as Ba,a5 as qa,a6 as Ua,a7 as Ha,a8 as Ka,X as Ga,Z as Qa,W as Ja,a9 as Xa,aa as Za,U as Ya,ab as es}from"./chunk-knA4lag3.js";import{R as ts,u as as}from"./chunk-a4jA-31v.js";import{A as ss}from"./chunk-nUtrHAIa.js";import{C as ns,O as rs}from"./chunk-BhXlBuf0.js";import{I as is}from"./chunk-DnMAHdte.js";import{b as os,d as ls,e as cs,g as ds,f as us,h as ps,s as ms,i as hs,m as gs,c as xs,j as fs,B as ys,k as bs,l as vs,P as js,n as Ns,I as ws,a as Cs}from"./chunk-UKb2nn92.js";import{A as _s,f as Ss,i as ks,o as Os,a as Is,T as Ps}from"./chunk-BULpe5kv.js";import{A as As}from"./chunk-DRZQUu5H.js";import{R as Ts}from"./chunk-Sp4WOLwD.js";import{N as $s}from"./chunk-D2aCv_Ah.js";import"./chunk-Dc4zIuSl.js";import"./chunk-B1s-jt27.js";import"./chunk-Tyyhsnez.js";import"./chunk-CRKBdUTG.js";import"./chunk-B5Y5c6gs.js";import"./chunk-sKlZvX2D.js";import"./chunk-B9H_70fs.js";import"./chunk-j7Lqvg-1.js";import"./chunk-DpghI3EP.js";function Ls(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function Ds(e,t,a){return Es(e,t,void 0,void 0,void 0,void 0,a)}function Es(e,t,a,s,n,r,i){const o=i(e,t,a,s,n,r);if(void 0!==o)return o;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return zs(e,t,r,i)}return zs(e,t,r,i)}function zs(e,t,a,s){if(Object.is(e,t))return!0;let n=da(e),r=da(t);if(n===za&&(n=ya),r===za&&(r=ya),n!==r)return!1;switch(n){case fa:return e.toString()===t.toString();case xa:{const a=e.valueOf(),s=t.valueOf();return ne(a,s)}case ga:case ha:case ma:return Object.is(e.valueOf(),t.valueOf());case pa:return e.source===t.source&&e.flags===t.flags;case ua:return e===t}const i=(a=a??new Map).get(e),o=a.get(t);if(null!=i&&null!=o)return i===t;a.set(e,t),a.set(t,e);try{switch(n){case Ea:if(e.size!==t.size)return!1;for(const[n,r]of e.entries())if(!t.has(n)||!Es(r,t.get(n),n,e,t,a,s))return!1;return!0;case Da:{if(e.size!==t.size)return!1;const n=Array.from(e.values()),r=Array.from(t.values());for(let i=0;i<n.length;i++){const o=n[i],l=r.findIndex(n=>Es(o,n,void 0,e,t,a,s));if(-1===l)return!1;r.splice(l,1)}return!0}case La:case $a:case Ta:case Aa:case Pa:case Ia:case Oa:case ka:case Sa:case _a:case Ca:case wa:if("undefined"!=typeof Buffer&&Buffer.isBuffer(e)!==Buffer.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Es(e[n],t[n],n,e,t,a,s))return!1;return!0;case Na:return e.byteLength===t.byteLength&&zs(new Uint8Array(e),new Uint8Array(t),a,s);case ja:return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&zs(new Uint8Array(e),new Uint8Array(t),a,s);case va:return e.name===t.name&&e.message===t.message;case ya:{if(!(zs(e.constructor,t.constructor,a,s)||Ls(e)&&Ls(t)))return!1;const n=[...Object.keys(e),...ba(e)],r=[...Object.keys(t),...ba(t)];if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i],o=e[r];if(!Object.hasOwn(t,r))return!1;if(!Es(o,t[r],r,e,t,a,s))return!1}return!0}default:return!1}}finally{a.delete(e),a.delete(t)}}function Vs(){}function Rs(e,t){return Ds(e,t,Vs)}function Ms(e){const t=z.useRef({});return z.useEffect(()=>{t.current=e}),t.current}function Fs({array1:e,array2:a,parser:s=t(e=>e,"parser")}){return e&&a&&e.length===a.length&&e.every((e,t)=>s(e)===s(a[t]))}function Ws(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Bs(e={}){const{ignoreAccents:t=!0,ignoreCase:a=!0,limit:s,matchFrom:n="any",stringify:r,trim:i=!1}=e;return(e,{inputValue:o,getOptionLabel:l})=>{let c=i?o.trim():o;a&&(c=c.toLowerCase()),t&&(c=Ws(c));const d=c?e.filter(e=>{let s=(r||l)(e);return a&&(s=s.toLowerCase()),t&&(s=Ws(s)),"start"===n?s.startsWith(c):s.includes(c)}):e;return"number"==typeof s?d.slice(0,s):d}}t(Ls,"isPlainObject"),t(Ds,"isEqualWith"),t(Es,"isEqualWithImpl"),t(zs,"areObjectsEqual"),t(Vs,"noop"),t(Rs,"isEqual"),t(Ms,"usePreviousProps"),t(Fs,"areArraysSame"),t(Ws,"stripDiacritics"),t(Bs,"createFilterOptions");const qs=Bs(),Us=t(e=>null!==e.current&&e.current.parentElement?.contains(document.activeElement),"defaultIsActiveElementInListbox"),Hs=[];function Ks(e,t,a,s){if(t||null==e||s)return"";const n=a(e);return"string"==typeof n?n:""}function Gs(e){const{unstable_isActiveElementInListbox:a=Us,unstable_classNamePrefix:s="Mui",autoComplete:n=!1,autoHighlight:r=!1,autoSelect:i=!1,blurOnSelect:o=!1,clearOnBlur:l=!e.freeSolo,clearOnEscape:c=!1,componentName:d="useAutocomplete",defaultValue:u=(e.multiple?Hs:null),disableClearable:p=!1,disableCloseOnSelect:m=!1,disabled:h,disabledItemsFocusable:g=!1,disableListWrap:x=!1,filterOptions:f=qs,filterSelectedOptions:y=!1,freeSolo:b=!1,getOptionDisabled:v,getOptionKey:j,getOptionLabel:N=t(e=>e.label??e,"getOptionLabelProp"),groupBy:w,handleHomeEndKeys:C=!e.freeSolo,id:_,includeInputInList:S=!1,inputValue:k,isOptionEqualToValue:O=t((e,t)=>e===t,"isOptionEqualToValue"),multiple:I=!1,onChange:P,onClose:A,onHighlightChange:T,onInputChange:$,onOpen:L,open:D,openOnFocus:E=!1,options:V,readOnly:R=!1,renderValue:M,selectOnFocus:F=!e.freeSolo,value:W}=e,B=re(_);let q=N;q=t(e=>{const t=N(e);return"string"!=typeof t?String(t):t},"getOptionLabel");const U=z.useRef(!1),H=z.useRef(!0),K=z.useRef(null),G=z.useRef(null),[Q,J]=z.useState(null),[X,Z]=z.useState(-1),Y=r?0:-1,ee=z.useRef(Y),te=z.useRef(Ks(u??W,I,q)).current,[ae,se]=os({controlled:W,default:u,name:d}),[ne,ie]=os({controlled:k,default:te,name:d,state:"inputValue"}),[oe,le]=z.useState(!1),ce=z.useCallback((e,t,a)=>{if(!(I?ae.length<t.length:null!==t)&&!l)return;const s=Ks(t,I,q,M);ne!==s&&(ie(s),$&&$(e,s,a))},[q,ne,I,$,ie,l,ae,M]),[de,ue]=os({controlled:D,default:!1,name:d,state:"open"}),[pe,me]=z.useState(!0),he=!I&&null!=ae&&ne===q(ae),ge=de&&!R,xe=ge?f(V.filter(e=>!y||!(I?ae:[ae]).some(t=>null!==t&&O(e,t))),{inputValue:he&&pe?"":ne,getOptionLabel:q}):[],fe=Ms({filteredOptions:xe,value:ae,inputValue:ne});z.useEffect(()=>{const e=ae!==fe.value;oe&&!e||b&&!e||ce(null,ae,"reset")},[ae,ce,oe,fe.value,b]);const ye=de&&xe.length>0&&!R,be=ls(e=>{if(-1===e)K.current.focus();else{const t=M?"data-item-index":"data-tag-index";Q.querySelector(`[${t}="${e}"]`).focus()}});function ve(e,t){if(!G.current||e<0||e>=xe.length)return-1;let a=e;for(;;){const s=G.current.querySelector(`[data-option-index="${a}"]`),n=!g&&(!s||s.disabled||"true"===s.getAttribute("aria-disabled"));if(s&&s.hasAttribute("tabindex")&&!n)return a;if(a="next"===t?(a+1)%xe.length:(a-1+xe.length)%xe.length,a===e)return-1}}z.useEffect(()=>{I&&X>ae.length-1&&(Z(-1),be(-1))},[ae,I,X,be]),t(ve,"validOptionIndex");const je=ls(({event:e,index:t,reason:a})=>{if(ee.current=t,-1===t?K.current.removeAttribute("aria-activedescendant"):K.current.setAttribute("aria-activedescendant",`${B}-option-${t}`),T&&["mouse","keyboard","touch"].includes(a)&&T(e,-1===t?null:xe[t],a),!G.current)return;const n=G.current.querySelector(`[role="option"].${s}-focused`);n&&(n.classList.remove(`${s}-focused`),n.classList.remove(`${s}-focusVisible`));let r=G.current;if("listbox"!==G.current.getAttribute("role")&&(r=G.current.parentElement.querySelector('[role="listbox"]')),!r)return;if(-1===t)return void(r.scrollTop=0);const i=G.current.querySelector(`[data-option-index="${t}"]`);if(i&&(i.classList.add(`${s}-focused`),"keyboard"===a&&i.classList.add(`${s}-focusVisible`),r.scrollHeight>r.clientHeight&&"mouse"!==a&&"touch"!==a)){const e=i,t=r.clientHeight+r.scrollTop,a=e.offsetTop+e.offsetHeight;a>t?r.scrollTop=a-r.clientHeight:e.offsetTop-e.offsetHeight*(w?1.3:0)<r.scrollTop&&(r.scrollTop=e.offsetTop-e.offsetHeight*(w?1.3:0))}}),Ne=ls(({event:e,diff:a,direction:s="next",reason:r})=>{if(!ge)return;const i=ve(t(()=>{const e=xe.length-1;if("reset"===a)return Y;if("start"===a)return 0;if("end"===a)return e;const t=ee.current+a;return t<0?-1===t&&S?-1:x&&-1!==ee.current||Math.abs(a)>1?0:e:t>e?t===e+1&&S?-1:x||Math.abs(a)>1?e:0:t},"getNextIndex")(),s);if(je({index:i,reason:r,event:e}),n&&"reset"!==a)if(-1===i)K.current.value=ne;else{const e=q(xe[i]);K.current.value=e;0===e.toLowerCase().indexOf(ne.toLowerCase())&&ne.length>0&&K.current.setSelectionRange(ne.length,e.length)}}),we=!Fs({array1:fe.filteredOptions,array2:xe,parser:q}),Ce=t(()=>{const e=t((e,t)=>(e?q(e):"")===(t?q(t):""),"isSameValue");if(-1!==ee.current&&!Fs({array1:fe.filteredOptions,array2:xe,parser:q})&&fe.inputValue===ne&&(I?ae.length===fe.value.length&&fe.value.every((e,t)=>q(ae[t])===q(e)):e(fe.value,ae))){const e=fe.filteredOptions[ee.current];if(e)return xe.findIndex(t=>q(t)===q(e))}return-1},"getPreviousHighlightedOptionIndex"),_e=z.useCallback(()=>{if(!ge)return;const e=Ce();if(-1!==e)return void(ee.current=e);const t=I?ae[0]:ae;if(0!==xe.length&&null!=t){if(G.current){if(null!=t){const e=xe[ee.current];if(I&&e&&-1!==ae.findIndex(t=>O(e,t)))return;const a=xe.findIndex(e=>O(e,t));return void(-1===a?Ne({diff:"reset"}):je({index:a}))}ee.current>=xe.length-1?je({index:xe.length-1}):je({index:ee.current})}}else Ne({diff:"reset"})},[xe.length,!I&&ae,y,Ne,je,ge,ne,I]),Se=ls(e=>{cs(G,e),e&&_e()});z.useEffect(()=>{(we||ge)&&_e()},[_e,we,ge]);const ke=t(e=>{de||(ue(!0),me(!0),L&&L(e))},"handleOpen"),Oe=t((e,t)=>{de&&(ue(!1),A&&A(e,t))},"handleClose"),Ie=t((e,t,a,s)=>{if(I){if(ae.length===t.length&&ae.every((e,a)=>e===t[a]))return}else if(ae===t)return;P&&P(e,t,a,s),se(t)},"handleValue"),Pe=z.useRef(!1),Ae=t((e,t,a="selectOption",s="options")=>{let n=a,r=t;if(I){r=Array.isArray(ae)?ae.slice():[];const e=r.findIndex(e=>O(t,e));-1===e?r.push(t):"freeSolo"!==s&&(r.splice(e,1),n="removeOption")}ce(e,r,n),Ie(e,r,n,{option:t}),m||e&&(e.ctrlKey||e.metaKey)||Oe(e,n),(!0===o||"touch"===o&&Pe.current||"mouse"===o&&!Pe.current)&&K.current.blur()},"selectNewValue");function Te(e,t){if(-1===e)return-1;let a=e;for(;;){if("next"===t&&a===ae.length||"previous"===t&&-1===a)return-1;const e=M?"data-item-index":"data-tag-index",s=Q.querySelector(`[${e}="${a}"]`);if(s&&s.hasAttribute("tabindex")&&!s.disabled&&"true"!==s.getAttribute("aria-disabled"))return a;a+="next"===t?1:-1}}t(Te,"validItemIndex");const $e=t((e,t)=>{if(!I)return;""===ne&&Oe(e,"toggleInput");let a=X;-1===X?""===ne&&"previous"===t&&(a=ae.length-1):(a+="next"===t?1:-1,a<0&&(a=0),a===ae.length&&(a=-1)),a=Te(a,t),Z(a),be(a)},"handleFocusItem"),Le=t(e=>{U.current=!0,ie(""),$&&$(e,"","clear"),Ie(e,I?[]:null,"clear")},"handleClear"),De=t(e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(-1===X||["ArrowLeft","ArrowRight"].includes(t.key)||(Z(-1),be(-1)),229!==t.which))switch(t.key){case"Home":ge&&C&&(t.preventDefault(),Ne({diff:"start",direction:"next",reason:"keyboard",event:t}));break;case"End":ge&&C&&(t.preventDefault(),Ne({diff:"end",direction:"previous",reason:"keyboard",event:t}));break;case"PageUp":t.preventDefault(),Ne({diff:-5,direction:"previous",reason:"keyboard",event:t}),ke(t);break;case"PageDown":t.preventDefault(),Ne({diff:5,direction:"next",reason:"keyboard",event:t}),ke(t);break;case"ArrowDown":t.preventDefault(),Ne({diff:1,direction:"next",reason:"keyboard",event:t}),ke(t);break;case"ArrowUp":t.preventDefault(),Ne({diff:-1,direction:"previous",reason:"keyboard",event:t}),ke(t);break;case"ArrowLeft":!I&&M?be(0):$e(t,"previous");break;case"ArrowRight":!I&&M?be(-1):$e(t,"next");break;case"Enter":if(-1!==ee.current&&ge){const e=xe[ee.current],a=!!v&&v(e);if(t.preventDefault(),a)return;Ae(t,e,"selectOption"),n&&K.current.setSelectionRange(K.current.value.length,K.current.value.length)}else b&&""!==ne&&!1===he&&(I&&t.preventDefault(),Ae(t,ne,"createOption","freeSolo"));break;case"Escape":ge?(t.preventDefault(),t.stopPropagation(),Oe(t,"escape")):c&&(""!==ne||I&&ae.length>0||M)&&(t.preventDefault(),t.stopPropagation(),Le(t));break;case"Backspace":if(I&&!R&&""===ne&&ae.length>0){const e=-1===X?ae.length-1:X,a=ae.slice();a.splice(e,1),Ie(t,a,"removeOption",{option:ae[e]})}I||!M||R||(se(null),be(-1));break;case"Delete":if(I&&!R&&""===ne&&ae.length>0&&-1!==X){const e=X,a=ae.slice();a.splice(e,1),Ie(t,a,"removeOption",{option:ae[e]})}I||!M||R||(se(null),be(-1))}},"handleKeyDown"),Ee=t(e=>{le(!0),E&&!U.current&&ke(e)},"handleFocus"),ze=t(e=>{a(G)?K.current.focus():(le(!1),H.current=!0,U.current=!1,i&&-1!==ee.current&&ge?Ae(e,xe[ee.current],"blur"):i&&b&&""!==ne?Ae(e,ne,"blur","freeSolo"):l&&ce(e,ae,"blur"),Oe(e,"blur"))},"handleBlur"),Ve=t(e=>{const t=e.target.value;ne!==t&&(ie(t),me(!1),$&&$(e,t,"input")),""===t?p||I||Ie(e,null,"clear"):ke(e)},"handleInputChange"),Re=t(e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));ee.current!==t&&je({event:e,index:t,reason:"mouse"})},"handleOptionMouseMove"),Me=t(e=>{je({event:e,index:Number(e.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Pe.current=!0},"handleOptionTouchStart"),Fe=t(e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));Ae(e,xe[t],"selectOption"),Pe.current=!1},"handleOptionClick"),We=t(e=>t=>{const a=ae.slice();a.splice(e,1),Ie(t,a,"removeOption",{option:ae[e]})},"handleItemDelete"),Be=t(e=>{Ie(e,null,"removeOption",{option:ae})},"handleSingleItemDelete"),qe=t(e=>{de?Oe(e,"toggleInput"):ke(e)},"handlePopupIndicator"),Ue=t(e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute("id")!==B&&e.preventDefault()},"handleMouseDown"),He=t(e=>{e.currentTarget.contains(e.target)&&(K.current.focus(),F&&H.current&&K.current.selectionEnd-K.current.selectionStart===0&&K.current.select(),H.current=!1)},"handleClick"),Ke=t(e=>{h||""!==ne&&de||qe(e)},"handleInputMouseDown");let Ge=b&&ne.length>0;Ge=Ge||(I?ae.length>0:null!==ae);let Qe=xe;return w&&(Qe=xe.reduce((e,t,a)=>{const s=w(t);return e.length>0&&e[e.length-1].group===s?e[e.length-1].options.push(t):e.push({key:a,index:a,group:s,options:[t]}),e},[])),h&&oe&&ze(),{getRootProps:t((e={})=>({...e,onKeyDown:De(e),onMouseDown:Ue,onClick:He}),"getRootProps"),getInputLabelProps:t(()=>({id:`${B}-label`,htmlFor:B}),"getInputLabelProps"),getInputProps:t(()=>({id:B,value:ne,onBlur:ze,onFocus:Ee,onChange:Ve,onMouseDown:Ke,"aria-activedescendant":ge?"":null,"aria-autocomplete":n?"both":"list","aria-controls":ye?`${B}-listbox`:void 0,"aria-expanded":ye,autoComplete:"off",ref:K,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:h}),"getInputProps"),getClearProps:t(()=>({tabIndex:-1,type:"button",onClick:Le}),"getClearProps"),getItemProps:t(({index:e=0}={})=>({...I&&{key:e},...M?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!R&&{onDelete:I?We(e):Be}}),"getItemProps"),getPopupIndicatorProps:t(()=>({tabIndex:-1,type:"button",onClick:qe}),"getPopupIndicatorProps"),getTagProps:t(({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!R&&{onDelete:We(e)}}),"getTagProps"),getListboxProps:t(()=>({role:"listbox",id:`${B}-listbox`,"aria-labelledby":`${B}-label`,ref:Se,onMouseDown:t(e=>{e.preventDefault()},"onMouseDown")}),"getListboxProps"),getOptionProps:t(({index:e,option:t})=>{const a=(I?ae:[ae]).some(e=>null!=e&&O(t,e)),s=!!v&&v(t);return{key:j?.(t)??q(t),tabIndex:-1,role:"option",id:`${B}-option-${e}`,onMouseMove:Re,onClick:Fe,onTouchStart:Me,"data-option-index":e,"aria-disabled":s,"aria-selected":a}},"getOptionProps"),id:B,inputValue:ne,value:ae,dirty:Ge,expanded:ge&&Q,popupOpen:ge,focused:oe||-1!==X,anchorEl:Q,setAnchorEl:J,focusedItem:X,focusedTag:X,groupedOptions:Qe}}function Qs(e){return ds("MuiListSubheader",e)}t(Ks,"getInputValue"),t(Gs,"useAutocomplete"),t(Qs,"getListSubheaderUtilityClass"),us("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const Js=t(e=>{const{classes:t,color:a,disableGutters:s,inset:n,disableSticky:r}=e,i={root:["root","default"!==a&&`color${ie(a)}`,!s&&"gutters",n&&"inset",!r&&"sticky"]};return hs(i,Qs,t)},"useUtilityClasses$2"),Xs=ms("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:t((e,t)=>{const{ownerState:a}=e;return[t.root,"default"!==a.color&&t[`color${ie(a.color)}`],!a.disableGutters&&t.gutters,a.inset&&t.inset,!a.disableSticky&&t.sticky]},"overridesResolver")})(gs(({theme:e})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(e.vars||e).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:t(({ownerState:e})=>!e.disableGutters,"props"),style:{paddingLeft:16,paddingRight:16}},{props:t(({ownerState:e})=>e.inset,"props"),style:{paddingLeft:72}},{props:t(({ownerState:e})=>!e.disableSticky,"props"),style:{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),Zs=z.forwardRef(t(function(e,t){const s=ps({props:e,name:"MuiListSubheader"}),{className:n,color:r="default",component:i="li",disableGutters:o=!1,disableSticky:l=!1,inset:c=!1,...d}=s,u={...s,color:r,component:i,disableGutters:o,disableSticky:l,inset:c},p=Js(u);return a.jsx(Xs,{as:i,className:Gt(p.root,n),ref:t,ownerState:u,...d})},"ListSubheader2"));Zs&&(Zs.muiSkipListHighlight=!0);const Ys=xs(a.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function en(e){return ds("MuiChip",e)}t(en,"getChipUtilityClass");const tn=us("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),an=t(e=>{const{classes:t,disabled:a,size:s,color:n,iconColor:r,onDelete:i,clickable:o,variant:l}=e,c={root:["root",l,a&&"disabled",`size${ie(s)}`,`color${ie(n)}`,o&&"clickable",o&&`clickableColor${ie(n)}`,i&&"deletable",i&&`deletableColor${ie(n)}`,`${l}${ie(n)}`],label:["label",`label${ie(s)}`],avatar:["avatar",`avatar${ie(s)}`,`avatarColor${ie(n)}`],icon:["icon",`icon${ie(s)}`,`iconColor${ie(r)}`],deleteIcon:["deleteIcon",`deleteIcon${ie(s)}`,`deleteIconColor${ie(n)}`,`deleteIcon${ie(l)}Color${ie(n)}`]};return hs(c,en,t)},"useUtilityClasses$1"),sn=ms("div",{name:"MuiChip",slot:"Root",overridesResolver:t((e,t)=>{const{ownerState:a}=e,{color:s,iconColor:n,clickable:r,onDelete:i,size:o,variant:l}=a;return[{[`& .${tn.avatar}`]:t.avatar},{[`& .${tn.avatar}`]:t[`avatar${ie(o)}`]},{[`& .${tn.avatar}`]:t[`avatarColor${ie(s)}`]},{[`& .${tn.icon}`]:t.icon},{[`& .${tn.icon}`]:t[`icon${ie(o)}`]},{[`& .${tn.icon}`]:t[`iconColor${ie(n)}`]},{[`& .${tn.deleteIcon}`]:t.deleteIcon},{[`& .${tn.deleteIcon}`]:t[`deleteIcon${ie(o)}`]},{[`& .${tn.deleteIcon}`]:t[`deleteIconColor${ie(s)}`]},{[`& .${tn.deleteIcon}`]:t[`deleteIcon${ie(l)}Color${ie(s)}`]},t.root,t[`size${ie(o)}`],t[`color${ie(s)}`],r&&t.clickable,r&&"default"!==s&&t[`clickableColor${ie(s)})`],i&&t.deletable,i&&"default"!==s&&t[`deletableColor${ie(s)}`],t[l],t[`${l}${ie(s)}`]]},"overridesResolver")})(gs(({theme:e})=>{const a="light"===e.palette.mode?e.palette.grey[700]:e.palette.grey[300];return{maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,lineHeight:1.5,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${tn.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${tn.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:a,fontSize:e.typography.pxToRem(12)},[`& .${tn.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${tn.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${tn.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${tn.icon}`]:{marginLeft:5,marginRight:-6},[`& .${tn.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:e.alpha((e.vars||e).palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.alpha((e.vars||e).palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${tn.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${tn.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(e.palette).filter(vs(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText,[`& .${tn.deleteIcon}`]:{color:e.alpha((e.vars||e).palette[t].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[t].contrastText}}}})),{props:t(e=>e.iconColor===e.color,"props"),style:{[`& .${tn.icon}`]:{color:e.vars?e.vars.palette.Chip.defaultIconColor:a}}},{props:t(e=>e.iconColor===e.color&&"default"!==e.color,"props"),style:{[`& .${tn.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${tn.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}},...Object.entries(e.palette).filter(vs(["dark"])).map(([t])=>({props:{color:t,onDelete:!0},style:{[`&.${tn.focusVisible}`]:{background:(e.vars||e).palette[t].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`)},[`&.${tn.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)},"&:active":{boxShadow:(e.vars||e).shadows[1]}}},...Object.entries(e.palette).filter(vs(["dark"])).map(([t])=>({props:{color:t,clickable:!0},style:{[`&:hover, &.${tn.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${"light"===e.palette.mode?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${tn.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${tn.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${tn.avatar}`]:{marginLeft:4},[`& .${tn.avatarSmall}`]:{marginLeft:2},[`& .${tn.icon}`]:{marginLeft:4},[`& .${tn.iconSmall}`]:{marginLeft:2},[`& .${tn.deleteIcon}`]:{marginRight:5},[`& .${tn.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(e.palette).filter(vs()).map(([t])=>({props:{variant:"outlined",color:t},style:{color:(e.vars||e).palette[t].main,border:`1px solid ${e.alpha((e.vars||e).palette[t].main,.7)}`,[`&.${tn.clickable}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)},[`&.${tn.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.focusOpacity)},[`& .${tn.deleteIcon}`]:{color:e.alpha((e.vars||e).palette[t].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[t].main}}}}))]}})),nn=ms("span",{name:"MuiChip",slot:"Label",overridesResolver:t((e,t)=>{const{ownerState:a}=e,{size:s}=a;return[t.label,t[`label${ie(s)}`]]},"overridesResolver")})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function rn(e){return"Backspace"===e.key||"Delete"===e.key}t(rn,"isDeleteKeyboardEvent");const on=z.forwardRef(t(function(e,s){const n=ps({props:e,name:"MuiChip"}),{avatar:r,className:i,clickable:o,color:l="default",component:c,deleteIcon:d,disabled:u=!1,icon:p,label:m,onClick:h,onDelete:g,onKeyDown:x,onKeyUp:f,size:y="medium",variant:b="filled",tabIndex:v,skipFocusWhenDisabled:j=!1,slots:N={},slotProps:w={},...C}=n,_=z.useRef(null),S=fs(_,s),k=t(e=>{e.stopPropagation(),g&&g(e)},"handleDeleteIconClick"),O=t(e=>{e.currentTarget===e.target&&rn(e)&&e.preventDefault(),x&&x(e)},"handleKeyDown"),I=t(e=>{e.currentTarget===e.target&&g&&rn(e)&&g(e),f&&f(e)},"handleKeyUp"),P=!(!1===o||!h)||o,A=P||g?ys:c||"div",T={...n,component:A,disabled:u,size:y,color:l,iconColor:z.isValidElement(p)&&p.props.color||l,onDelete:!!g,clickable:P,variant:b},$=an(T),L=A===ys?{component:c||"div",focusVisibleClassName:$.focusVisible,...g&&{disableRipple:!0}}:{};let D=null;g&&(D=d&&z.isValidElement(d)?z.cloneElement(d,{className:Gt(d.props.className,$.deleteIcon),onClick:k}):a.jsx(Ys,{className:$.deleteIcon,onClick:k}));let E=null;r&&z.isValidElement(r)&&(E=z.cloneElement(r,{className:Gt($.avatar,r.props.className)}));let V=null;p&&z.isValidElement(p)&&(V=z.cloneElement(p,{className:Gt($.icon,p.props.className)}));const R={slots:N,slotProps:w},[M,F]=bs("root",{elementType:sn,externalForwardedProps:{...R,...C},ownerState:T,shouldForwardComponentProp:!0,ref:S,className:Gt($.root,i),additionalProps:{disabled:!(!P||!u)||void 0,tabIndex:j&&u?-1:v,...L},getSlotProps:t(e=>({...e,onClick:t(t=>{e.onClick?.(t),h?.(t)},"onClick"),onKeyDown:t(t=>{e.onKeyDown?.(t),O(t)},"onKeyDown"),onKeyUp:t(t=>{e.onKeyUp?.(t),I(t)},"onKeyUp")}),"getSlotProps")}),[W,B]=bs("label",{elementType:nn,externalForwardedProps:R,ownerState:T,className:$.label});return a.jsxs(M,{as:A,...F,children:[E||V,a.jsx(W,{...B,children:m}),D]})},"Chip2"));function ln(e){return ds("MuiAutocomplete",e)}t(ln,"getAutocompleteUtilityClass");const cn=us("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var dn,un;const pn=t(e=>{const{classes:t,disablePortal:a,expanded:s,focused:n,fullWidth:r,hasClearIcon:i,hasPopupIcon:o,inputFocused:l,popupOpen:c,size:d}=e,u={root:["root",s&&"expanded",n&&"focused",r&&"fullWidth",i&&"hasClearIcon",o&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",l&&"inputFocused"],tag:["tag",`tagSize${ie(d)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",c&&"popupIndicatorOpen"],popper:["popper",a&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return hs(u,ln,t)},"useUtilityClasses"),mn=ms("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:t((e,t)=>{const{ownerState:a}=e,{fullWidth:s,hasClearIcon:n,hasPopupIcon:r,inputFocused:i,size:o}=a;return[{[`& .${cn.tag}`]:t.tag},{[`& .${cn.tag}`]:t[`tagSize${ie(o)}`]},{[`& .${cn.inputRoot}`]:t.inputRoot},{[`& .${cn.input}`]:t.input},{[`& .${cn.input}`]:i&&t.inputFocused},t.root,s&&t.fullWidth,r&&t.hasPopupIcon,n&&t.hasClearIcon]},"overridesResolver")})({[`&.${cn.focused} .${cn.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${cn.clearIndicator}`]:{visibility:"visible"}},[`& .${cn.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${cn.inputRoot}`]:{[`.${cn.hasPopupIcon}&, .${cn.hasClearIcon}&`]:{paddingRight:30},[`.${cn.hasPopupIcon}.${cn.hasClearIcon}&`]:{paddingRight:56},[`& .${cn.input}`]:{width:0,minWidth:30}},[`& .${Is.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${Is.root}.${ks.sizeSmall}`]:{[`& .${Is.input}`]:{padding:"2px 4px 3px 0"}},[`& .${Os.root}`]:{padding:9,[`.${cn.hasPopupIcon}&, .${cn.hasClearIcon}&`]:{paddingRight:39},[`.${cn.hasPopupIcon}.${cn.hasClearIcon}&`]:{paddingRight:65},[`& .${cn.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${cn.endAdornment}`]:{right:9}},[`& .${Os.root}.${ks.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${cn.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${Ss.root}`]:{paddingTop:19,paddingLeft:8,[`.${cn.hasPopupIcon}&, .${cn.hasClearIcon}&`]:{paddingRight:39},[`.${cn.hasPopupIcon}.${cn.hasClearIcon}&`]:{paddingRight:65},[`& .${Ss.input}`]:{padding:"7px 4px"},[`& .${cn.endAdornment}`]:{right:9}},[`& .${Ss.root}.${ks.sizeSmall}`]:{paddingBottom:1,[`& .${Ss.input}`]:{padding:"2.5px 4px"}},[`& .${ks.hiddenLabel}`]:{paddingTop:8},[`& .${Ss.root}.${ks.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${cn.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${Ss.root}.${ks.hiddenLabel}.${ks.sizeSmall}`]:{[`& .${cn.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${cn.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${cn.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${cn.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${cn.inputRoot}`]:{flexWrap:"wrap"}}}]}),hn=ms("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),gn=ms(ws,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),xn=ms(ws,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:t((e,t)=>{const{ownerState:a}=e;return[t.popupIndicator,a.popupOpen&&t.popupIndicatorOpen]},"overridesResolver")})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),fn=ms(Ns,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:t((e,t)=>{const{ownerState:a}=e;return[{[`& .${cn.option}`]:t.option},t.popper,a.disablePortal&&t.popperDisablePortal]},"overridesResolver")})(gs(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),yn=ms(js,{name:"MuiAutocomplete",slot:"Paper"})(gs(({theme:e})=>({...e.typography.body1,overflow:"auto"}))),bn=ms("div",{name:"MuiAutocomplete",slot:"Loading"})(gs(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),vn=ms("div",{name:"MuiAutocomplete",slot:"NoOptions"})(gs(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),jn=ms("ul",{name:"MuiAutocomplete",slot:"Listbox"})(gs(({theme:e})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${cn.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${cn.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${cn.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${cn.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${cn.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),Nn=ms(Zs,{name:"MuiAutocomplete",slot:"GroupLabel"})(gs(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),wn=ms("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${cn.option}`]:{paddingLeft:24}}),Cn=z.forwardRef(t(function(e,s){const n=ps({props:e,name:"MuiAutocomplete"}),{autoComplete:r=!1,autoHighlight:i=!1,autoSelect:o=!1,blurOnSelect:l=!1,ChipProps:c,className:d,clearIcon:u=dn||(dn=a.jsx(ns,{fontSize:"small"})),clearOnBlur:p=!n.freeSolo,clearOnEscape:m=!1,clearText:h="Clear",closeText:g="Close",componentsProps:x,defaultValue:f=(n.multiple?[]:null),disableClearable:y=!1,disableCloseOnSelect:b=!1,disabled:v=!1,disabledItemsFocusable:j=!1,disableListWrap:N=!1,disablePortal:w=!1,filterOptions:C,filterSelectedOptions:_=!1,forcePopupIcon:S="auto",freeSolo:k=!1,fullWidth:O=!1,getLimitTagsText:I=t(e=>`+${e}`,"getLimitTagsText"),getOptionDisabled:P,getOptionKey:A,getOptionLabel:T,isOptionEqualToValue:$,groupBy:L,handleHomeEndKeys:D=!n.freeSolo,id:E,includeInputInList:V=!1,inputValue:R,limitTags:M=-1,ListboxComponent:F,ListboxProps:W,loading:B=!1,loadingText:q="Loadingâ€¦",multiple:U=!1,noOptionsText:H="No options",onChange:K,onClose:G,onHighlightChange:Q,onInputChange:J,onOpen:X,open:Z,openOnFocus:Y=!1,openText:ee="Open",options:te,PaperComponent:ae,PopperComponent:se,popupIcon:ne=un||(un=a.jsx(_s,{})),readOnly:re=!1,renderGroup:ie,renderInput:oe,renderOption:le,renderTags:ce,renderValue:de,selectOnFocus:ue=!n.freeSolo,size:pe="medium",slots:me={},slotProps:he={},value:ge,...xe}=n,{getRootProps:fe,getInputProps:ye,getInputLabelProps:be,getPopupIndicatorProps:ve,getClearProps:je,getItemProps:Ne,getListboxProps:we,getOptionProps:Ce,value:_e,dirty:Se,expanded:ke,id:Oe,popupOpen:Ie,focused:Pe,focusedItem:Ae,anchorEl:Te,setAnchorEl:$e,inputValue:Le,groupedOptions:De}=Gs({...n,componentName:"Autocomplete"}),Ee=!y&&!v&&Se&&!re,ze=(!k||!0===S)&&!1!==S,{onMouseDown:Ve}=ye(),{ref:Re,...Me}=we(),Fe=T||t(e=>e.label??e,"defaultGetOptionLabel"),We={...n,disablePortal:w,expanded:ke,focused:Pe,fullWidth:O,getOptionLabel:Fe,hasClearIcon:Ee,hasPopupIcon:ze,inputFocused:-1===Ae,popupOpen:Ie,size:pe},Be=pn(We),qe={slots:{paper:ae,popper:se,...me},slotProps:{chip:c,listbox:W,...x,...he}},[Ue,He]=bs("listbox",{elementType:jn,externalForwardedProps:qe,ownerState:We,className:Be.listbox,additionalProps:Me,ref:Re}),[Ke,Ge]=bs("paper",{elementType:js,externalForwardedProps:qe,ownerState:We,className:Be.paper}),[Qe,Je]=bs("popper",{elementType:Ns,externalForwardedProps:qe,ownerState:We,className:Be.popper,additionalProps:{disablePortal:w,style:{width:Te?Te.clientWidth:null},role:"presentation",anchorEl:Te,open:Ie}});let Xe;const Ze=t(e=>({className:Be.tag,disabled:v,...Ne(e)}),"getCustomizedItemProps");if(U?_e.length>0&&(Xe=ce?ce(_e,Ze,We):de?de(_e,Ze,We):_e.map((e,t)=>{const{key:s,...n}=Ze({index:t});return a.jsx(on,{label:Fe(e),size:pe,...n,...qe.slotProps.chip},s)})):de&&null!=_e&&(Xe=de(_e,Ze,We)),M>-1&&Array.isArray(Xe)){const e=Xe.length-M;!Pe&&e>0&&(Xe=Xe.splice(0,M),Xe.push(a.jsx("span",{className:Be.tag,children:I(e)},Xe.length)))}const Ye=ie||t(e=>a.jsxs("li",{children:[a.jsx(Nn,{className:Be.groupLabel,ownerState:We,component:"div",children:e.group}),a.jsx(wn,{className:Be.groupUl,ownerState:We,children:e.children})]},e.key),"defaultRenderGroup"),et=le||t((e,t)=>{const{key:s,...n}=e;return a.jsx("li",{...n,children:Fe(t)},s)},"defaultRenderOption"),tt=t((e,t)=>{const a=Ce({option:e,index:t});return et({...a,className:Be.option},e,{selected:a["aria-selected"],index:t,inputValue:Le},We)},"renderListOption"),at=qe.slotProps.clearIndicator,st=qe.slotProps.popupIndicator;return a.jsxs(z.Fragment,{children:[a.jsx(mn,{ref:s,className:Gt(Be.root,d),ownerState:We,...fe(xe),children:oe({id:Oe,disabled:v,fullWidth:!0,size:"small"===pe?"small":void 0,InputLabelProps:be(),InputProps:{ref:$e,className:Be.inputRoot,startAdornment:Xe,onMouseDown:t(e=>{e.target===e.currentTarget&&Ve(e)},"onMouseDown"),...(Ee||ze)&&{endAdornment:a.jsxs(hn,{className:Be.endAdornment,ownerState:We,children:[Ee?a.jsx(gn,{...je(),"aria-label":h,title:h,ownerState:We,...at,className:Gt(Be.clearIndicator,at?.className),children:u}):null,ze?a.jsx(xn,{...ve(),disabled:v,"aria-label":Ie?g:ee,title:Ie?g:ee,ownerState:We,...st,className:Gt(Be.popupIndicator,st?.className),children:ne}):null]})}},inputProps:{className:Be.input,disabled:v,readOnly:re,...ye()}})}),Te?a.jsx(fn,{as:Qe,...Je,children:a.jsxs(yn,{as:Ke,...Ge,children:[B&&0===De.length?a.jsx(bn,{className:Be.loading,ownerState:We,children:q}):null,0!==De.length||k||B?null:a.jsx(vn,{className:Be.noOptions,ownerState:We,role:"presentation",onMouseDown:t(e=>{e.preventDefault()},"onMouseDown"),children:H}),De.length>0?a.jsx(Ue,{as:F,...He,children:De.map((e,t)=>L?Ye({key:e.key,group:e.group,children:e.options.map((t,a)=>tt(t,e.index+a))}):tt(e,t))}):null]})}):null]})},"Autocomplete2"));var _n=t(function(e){var a=e.create,r=e.createLabel,i=void 0===r?"ra.action.create":r,o=e.createItemLabel,l=e.createValue,c=void 0===l?"@@ra-create":l,d=e.createHintValue,u=void 0===d?"@@ra-create-hint":d,p=e.optionText,m=void 0===p?"name":p,h=e.filter,g=e.handleChange,x=e.onCreate,f=s(),y=z.useState(!1),b=y[0],v=y[1],j=z.useRef(h);return{createId:c,createHintId:u,getCreateItem:t(function(e){return j.current=e,n({id:o&&!e?u:c},"string"==typeof m?m:"name",e&&o?"string"==typeof o?f(o,{item:e,_:o}):o(e):"string"==typeof i?f(i,{_:i}):i)},"getCreateItem"),handleChange:t(function(e){return function(e,a,s,n){function r(e){return e instanceof s?e:new s(function(t){t(e)})}return t(r,"adopt"),new(s||(s=Promise))(function(s,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function l(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){e.done?s(e.value):r(e.value).then(o,l)}t(o,"fulfilled"),t(l,"rejected"),t(c,"step"),c((n=n.apply(e,a||[])).next())})}(void 0,void 0,void 0,function(){var s,n,r,i;return function(e,a){var s,n,r,i={label:0,sent:t(function(){if(1&r[0])throw r[1];return r[1]},"sent"),trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(e){return function(t){return c([e,t])}}function c(t){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,t[0]&&(i=0)),i;)try{if(s=1,n&&(r=2&t[0]?n.return:t[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,t[1])).done)return r;switch(n=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return i.label++,{value:t[1],done:!1};case 5:i.label++,n=t[1],t=[0];continue;case 7:t=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==t[0]&&2!==t[0])){i=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){i.label=t[1];break}if(6===t[0]&&i.label<r[1]){i.label=r[1],r=t;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(t);break}r[2]&&i.ops.pop(),i.trys.pop();continue}t=a.call(e,i)}catch(l){t=[6,l],n=0}finally{s=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}(this,function(t){switch(t.label){case 0:if(s=(null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.value)||e,n=Array.isArray(s)?function(e,t,a){if(a||2===arguments.length)for(var s,n=0,r=t.length;n<r;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}([],s,!0).pop():s,(null==n?void 0:n.id)!==c&&n!==c)return[3,3];if(z.isValidElement(a))return[3,2];if(!x)throw new Error("To create a new option, you must pass an onCreate function or a create element.");return[4,x(h)];case 1:return(r=t.sent())?(g(r),[2]):[3,3];case 2:return v(!0),[2];case 3:return g(e),[2]}})})},"handleChange"),createElement:b&&z.isValidElement(a)?z.createElement(Sn.Provider,{value:{filter:j.current,onCancel:t(function(){return v(!1)},"onCancel"),onCreate:t(function(e){v(!1),g(e)},"onCreate")}},a):null,getOptionDisabled:t(function(e){return(null==e?void 0:e.id)===u||e===u},"getOptionDisabled")}},"useSupportCreateSuggestion"),Sn=z.createContext(void 0),kn=function(){return kn=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},kn.apply(this,arguments)},On=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a},In=function(e,t,a){if(a||2===arguments.length)for(var s,n=0,r=t.length;n<r;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Pn=Bs(),An=t(function(e){var a=Cs({props:e,name:Tn}),n=a.choices,f=a.className,y=a.clearOnBlur,b=void 0===y||y,v=a.clearText,j=void 0===v?"ra.action.clear_input_value":v,N=a.closeText,w=void 0===N?"ra.action.close":N,C=a.create,_=a.createLabel,S=a.createItemLabel,k=void 0===S?"ra.action.create_item":S,O=a.createValue,I=a.createHintValue,P=a.debounce,A=void 0===P?250:P,T=a.defaultValue,$=a.emptyText,L=a.emptyValue,D=void 0===L?"":L,E=a.field,V=a.format,R=a.helperText,M=a.id,F=a.inputText,W=a.isFetching,B=a.isLoading,q=a.isPending,U=a.isRequired,H=a.label,K=a.limitChoicesToValue,G=a.loadingText,Q=void 0===G?"ra.message.loading":G,J=a.matchSuggestion,X=a.margin,Z=a.fieldState,Y=a.filterToQuery,ee=void 0===Y?Vn:Y,te=a.formState,ae=a.multiple,se=void 0!==ae&&ae,ne=a.noOptionsText,re=a.offline,ie=void 0===re?Rn:re,oe=a.onBlur,le=a.onChange,ce=a.onCreate,de=a.openText,ue=void 0===de?"ra.action.open":de,pe=a.optionText,me=a.optionValue,he=a.parse,ge=a.resource,xe=a.shouldRenderSuggestions,fe=a.setFilter,ye=a.size,be=a.source,ve=a.suggestionLimit,je=void 0===ve?1/0:ve,Ne=a.TextFieldProps,we=a.translateChoice,Ce=a.validate,_e=a.variant,Se=a.onInputChange,ke=a.disabled,Oe=a.readOnly,Ie=a.getOptionDisabled,Pe=On(a,["choices","className","clearOnBlur","clearText","closeText","create","createLabel","createItemLabel","createValue","createHintValue","debounce","defaultValue","emptyText","emptyValue","field","format","helperText","id","inputText","isFetching","isLoading","isPending","isRequired","label","limitChoicesToValue","loadingText","matchSuggestion","margin","fieldState","filterToQuery","formState","multiple","noOptionsText","offline","onBlur","onChange","onCreate","openText","optionText","optionValue","parse","resource","shouldRenderSuggestions","setFilter","size","source","suggestionLimit","TextFieldProps","translateChoice","validate","variant","onInputChange","disabled","readOnly","getOptionDisabled"]),Ae=r(ee),Te=i({choices:n,isFetching:W,isLoading:B,isPending:q,resource:ge,source:be}),$e=Te.allChoices,Le=Te.isPaused,De=Te.isPending,Ee=Te.isPlaceholderData,ze=Te.error,Ve=Te.resource,Re=Te.source,Me=Te.setFilters,Fe=Te.isFromReference,We=s(),Be=o(kn({defaultValue:T,id:M,field:E,fieldState:Z,formState:te,isRequired:U,onBlur:oe,onChange:le,parse:he,format:V,resource:Ve,source:Re,validate:Ce,disabled:ke,readOnly:Oe},Pe)),qe=Be.id,Ue=Be.field,He=Be.isRequired,Ke=Be.fieldState,Ge=Ke.error,Qe=Ke.invalid,Je=z.useMemo(function(){var e;return null==$||He||se?$e:[(e={},e[me||"id"]=D,e["string"==typeof pe?pe:"name"]=We($,{_:$}),e)].concat($e||[])},[$e,D,$,He,se,pe,me,We]),Xe=Dn(Ue.value,{choices:Je,multiple:se,optionValue:me});z.useEffect(function(){if(null==D)throw new Error("emptyValue being set to null or undefined is not supported. Use parse to turn the empty string into null.")},[D]),z.useEffect(function(){if(z.isValidElement(pe)&&null!=$)throw new Error("optionText of type React element is not supported when setting emptyText");if(z.isValidElement(pe)&&null==F)throw new Error("\nIf you provided a React element for the optionText prop, you must also provide the inputText prop (used for the text input)");if(z.isValidElement(pe)&&!Fe&&null==J)throw new Error("\nIf you provided a React element for the optionText prop, you must also provide the matchSuggestion prop (used to match the user input with a choice)")},[pe,F,J,$,Fe]),z.useEffect(function(){l(null!=xe&&null==ne,"When providing a shouldRenderSuggestions function, we recommend you also provide the noOptionsText prop and set it to a text explaining users why no options are displayed. It supports translation keys.")},[xe,ne]);var Ze=c(Ve),Ye=d({choices:Je,limitChoicesToValue:K,matchSuggestion:J,optionText:null!=pe?pe:Fe?Ze:void 0,optionValue:me,createValue:O,createHintValue:I,selectedItem:Xe,suggestionLimit:je,translateChoice:null!=we?we:!Fe}),et=Ye.getChoiceText,tt=Ye.getChoiceValue,at=Ye.getSuggestions,st=z.useState(""),nt=st[0],rt=st[1],it=r(function(e){var t,a;se?Array.isArray(e)?Ue.onChange(e.map(tt),e):Ue.onChange(In(In([],null!==(t=Ue.value)&&void 0!==t?t:[],!0),[tt(e)],!1),e):Ue.onChange(null!==(a=tt(e))&&void 0!==a?a:D,e)}),ot=z.useCallback(u(function(e){if(fe)return fe(e);n||Me(Ae(e))},A),[A,Me,fe]),lt=z.useRef(Ue.value);z.useEffect(function(){p(lt.current,Ue.value)||(lt.current=Ue.value,ot(""))},[Ue.value]);var ct=_n({create:C,createLabel:_,createItemLabel:k,createValue:O,createHintValue:I,handleChange:it,filter:nt,onCreate:ce,optionText:pe}),dt=ct.getCreateItem,ut=ct.handleChange,pt=ct.createElement,mt=ct.createId,ht=ct.getOptionDisabled,gt=z.useCallback(function(e){return ht(e)||Ie&&Ie(e)},[Ie,ht]),xt=z.useCallback(function(e,t){return void 0===t&&(t=!1),null==e?"":"string"==typeof e?e:(null==e?void 0:e.id)===mt?m(e,"string"==typeof pe?pe:"name"):t||e[me||"id"]!==D?t||void 0===F?et(e):F(e):m(e,"string"==typeof pe?pe:"name")},[et,F,mt,pe,me,D]),ft=z.useCallback(function(e,t){void 0===t&&(t=!1);var a=xt(e,t);return"string"==typeof a?a:""},[xt]),yt=z.useCallback(function(e){if(b&&!se){var t=xt(Xe);p(t,nt)||(rt(t),ot(""))}Ue.onBlur(e)},[b,Ue,xt,Xe,nt,ot,se]);z.useEffect(function(){if(!se){var e=xt(Xe);if("string"!=typeof e)throw new Error("When optionText returns a React element, you must also provide the inputText prop");rt(e)}},[xt,se,Xe]);var bt=r(function(e,t,a){if("change"===(null==e?void 0:e.type)||!vt(t)){var s="string"==typeof k?We(k,{item:nt,_:k}):void 0;rt(t===s?nt:t),ot(t)}"clear"===a&&(rt(""),ot("")),null==Se||Se(e,t,a)}),vt=z.useCallback(function(e){return(se?Xe.map(function(e){return xt(e)}):[xt(Xe)]).includes(e)},[xt,se,Xe]),jt=z.useCallback(function(e){var t=!!Je&&Je.some(function(t){return xt(t)===e});return vt(e)||t},[Je,xt,vt]),Nt=t(function(e,t){var a=Fe||J||K?e:Pn(e,t),s=t.inputValue;return(ce||C)&&(""===s&&""===nt&&_?a=a.concat(dt("")):s&&nt&&!jt(nt)&&(a=a.concat(dt(s)))),a},"filterOptions"),wt=z.useCallback(function(e,t,a){e.preventDefault(),ut("createOption"!==a?null!=t?t:D:dt(Array.isArray(t)?t[t.length-1]:t))},[D,dt,ut]),Ct=h(1e3,nt),_t=z.useMemo(function(){return Fe||!J&&!K?(null==Je?void 0:Je.slice(0,je))||[]:at(nt)},[Je,nt,at,K,J,je,Fe]),St=t(function(e,t){return String(tt(e))===String(tt(t))},"isOptionEqualToValue"),kt=!!ze||!1!==R||Qe,Ot=fs(Ue.ref,null==Ne?void 0:Ne.inputRef);if(De&&Le&&!1!==ie&&void 0!==ie)return ie;var It="string"==typeof Q?We(Q,{_:Q}):Q;return z.createElement(z.Fragment,null,z.createElement(Ln,kn({className:Gt("ra-input","ra-input-".concat(Re),f),clearText:We(j,{_:j}),closeText:We(w,{_:w}),loadingText:Le&&Ee&&!1!==ie&&void 0!==ie?ie:It,openOnFocus:!0,openText:We(ue,{_:ue}),id:qe,isOptionEqualToValue:St,filterSelectedOptions:!0,disabled:ke||Oe,renderInput:t(function(e){var t,a,s=kn(kn({readOnly:Oe},e.InputProps),null==Ne?void 0:Ne.InputProps),n=(null==Ne?void 0:Ne.slotProps)?{slotProps:kn(kn({},null==Ne?void 0:Ne.slotProps),{input:kn(kn({readOnly:Oe},e.InputProps),null===(a=null==Ne?void 0:Ne.slotProps)||void 0===a?void 0:a.input)})}:void 0;return z.createElement(Ps,kn({name:Ue.name,label:""!==H&&!1!==H?z.createElement(g,{label:H,source:Re,resource:ge,isRequired:He}):null,error:!!ze||Qe,helperText:kt?z.createElement(is,{error:(null==Ge?void 0:Ge.message)||(null==ze?void 0:ze.message),helperText:R}):null,margin:X,variant:_e,className:Gt((t={},t[$n.textField]=!0,t[$n.emptyLabel]=!1===H||""===H,t))},e,Ne,{InputProps:s},n,{size:ye,inputRef:Ot}))},"renderInput"),multiple:se,renderTags:t(function(e,t){return e.map(function(e,s){var n,r=t({index:s}),i=r.key,o=On(r,["key"]),l=(null===(n=a.slotProps)||void 0===n?void 0:n.chip)?a.slotProps.chip:a.ChipProps;return z.createElement(on,kn({label:z.isValidElement(pe)?F?F(e):"":et(e),size:"small",key:i},o,l))})},"renderTags"),noOptionsText:"string"==typeof ne?We(ne,{_:ne}):ne,selectOnFocus:!0,clearOnBlur:b},x(Pe),{freeSolo:!!C||!!ce,handleHomeEndKeys:!!C||!!ce,filterOptions:Nt,options:Le&&Ee?[]:null==xe||xe(nt)?_t:[],getOptionKey:t(function(e){return null==e?void 0:e.id},"getOptionKey"),getOptionLabel:ft,inputValue:nt,loading:De&&(!Je||0===Je.length)&&Ct||Le&&Ee,value:Xe,onChange:wt,onBlur:yt,onInputChange:bt,renderOption:t(function(e,t){e.key;var a=On(e,["key"]),s=tt(t),n=xt(t,!0);return z.createElement("li",kn({key:s},a),""===n?"â€ƒ":n)},"renderOption"),getOptionDisabled:gt})),pt)},"AutocompleteInput"),Tn="RaAutocompleteInput",$n={textField:"".concat(Tn,"-textField"),emptyLabel:"".concat(Tn,"-emptyLabel")},Ln=ms(Cn,{name:Tn,overridesResolver:t(function(e,t){return t.root},"overridesResolver")})(function(e){var t,a=e.theme;return(t={})["& .".concat($n.textField)]={minWidth:a.spacing(20)},t["& .".concat($n.emptyLabel," .MuiOutlinedInput-root legend")]={width:0},t}),Dn=t(function(e,t){var a=t.choices,s=t.multiple,n=t.optionValue,r=z.useRef(En(a,e,n,s)),i=z.useState(function(){return En(a,e,n,s)}),o=i[0],l=i[1];return z.useEffect(function(){var t=En(a,e,n,s);zn(r.current,t,n,s)||(r.current=t,l(t))},[a,e,s,n]),o||null},"useSelectedChoice"),En=t(function(e,t,a,s){return void 0===e&&(e=[]),void 0===a&&(a="id"),s?(Array.isArray(null!=t?t:[])?t:[t]).map(function(t){return e.find(function(e){return String(t)===String(m(e,a))})}).filter(function(e){return!!e}):e.find(function(e){return String(m(e,a))===String(t)})||""},"getSelectedItems"),zn=t(function(e,t,a,s){var n,r;if(void 0===a&&(a="id"),s){var i=null!==(n=e)&&void 0!==n?n:[],o=null!==(r=t)&&void 0!==r?r:[];return i.length===o.length&&!i.map(function(e){return o.some(function(t){return m(t,a)===m(e,a)})}).some(function(e){return!1===e})}return m(e,a)===m(t,a)},"areSelectedItemsEqual"),Vn=t(function(e){return{q:e}},"DefaultFilterToQuery"),Rn=z.createElement(rs,{variant:"inline"}),Mn=function(){return Mn=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Mn.apply(this,arguments)},Fn=t(function(e){var t=e.defaultValue,a=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a}(e,["defaultValue"]);return z.createElement(An,Mn({},a,{multiple:!0,defaultValue:null!=t?t:a.disabled?void 0:[]}))},"AutocompleteArrayInput"),Wn=function(){return Wn=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Wn.apply(this,arguments)},Bn=t(function(e){var t=e.children,a=void 0===t?qn:t,s=e.offline,n=void 0===s?Un:s,r=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a}(e,["children","offline"]);if(1!==z.Children.count(a))throw new Error("<ReferenceArrayInput> only accepts a single child (like <AutocompleteArrayInput>)");return z.createElement(f,Wn({},r,{offline:n}),a)},"ReferenceArrayInput"),qn=z.createElement(Fn,null),Un=z.createElement(rs,{variant:"inline"}),Hn=t(function(){return Hn=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Hn.apply(this,arguments)},"__assign"),Kn=t(function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a},"__rest"),Gn=t(function(e){var t=e.children,a=void 0===t?Qn:t,s=e.offline,n=void 0===s?Jn:s,r=Kn(e,["children","offline"]);return e.validate,V.createElement(y,Hn({},r,{offline:n}),a)},"ReferenceInput"),Qn=V.createElement(An,null),Jn=V.createElement(rs,{variant:"inline"});function Xn({...e}){return a.jsx(Wa,{"data-slot":"accordion",...e})}function Zn({className:e,...t}){return a.jsx(Ba,{"data-slot":"accordion-item",className:oe("border-b last:border-b-0",e),...t})}function Yn({className:e,children:t,...s}){return a.jsx(qa,{className:"flex",children:a.jsxs(Ua,{"data-slot":"accordion-trigger",className:oe("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e),...s,children:[t,a.jsx(at,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function er({className:e,children:t,...s}){return a.jsx(Ha,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...s,children:a.jsx("div",{className:oe("pt-0 pb-4",e),children:t})})}t(Xn,"Accordion"),t(Zn,"AccordionItem"),t(Yn,"AccordionTrigger"),t(er,"AccordionContent");const tr=[{id:"low",name:"Low"},{id:"medium",name:"Medium"},{id:"high",name:"High"},{id:"critical",name:"Critical"}],ar=t(e=>{if(null==e)return"";const t=String(e);return["=","-","+","@","\t","\r"].some(e=>t.startsWith(e))?`\t${t}`:t},"sanitizeForCSV"),sr=t(async(e,t)=>{const a=await t(e,"opportunity_owner_id","sales"),s=await t(e,"account_manager_id","sales"),n=await t(e,"customer_organization_id","organizations"),r=await t(e,"principal_organization_id","organizations"),i=await t(e,"distributor_organization_id","organizations"),o=e.map(e=>({id:e.id,name:e.name,stage:H(e.stage),status:e.status,priority:e.priority,customer_name:e.customer_organization_id?n[e.customer_organization_id]?.name:void 0,principal_name:e.principal_organization_id?r[e.principal_organization_id]?.name:void 0,distributor_name:e.distributor_organization_id?i[e.distributor_organization_id]?.name:void 0,opportunity_owner:U(e.opportunity_owner_id?a[e.opportunity_owner_id]:null),account_manager:U(e.account_manager_id?s[e.account_manager_id]:null),lead_source:e.lead_source,estimated_close_date:e.estimated_close_date,actual_close_date:e.actual_close_date,campaign:e.campaign,competition:e.competition,decision_criteria:e.decision_criteria,next_action:e.next_action,next_action_date:e.next_action_date,tags:e.tags?.join(", ")??"",description:e.description,notes:e.notes,nb_interactions:e.nb_interactions,last_interaction_date:e.last_interaction_date,days_in_stage:e.days_in_stage,created_at:e.created_at,stage_changed_at:e.stage_changed_at})).map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[e,ar(t)])));return b(o,{rowDelimiter:",",endOfLine:"\r\n"},(e,t)=>{if(e)throw new Error(`CSV export failed: ${e.message}`);v(t,"opportunities")})},"opportunityExporter"),nr=t(()=>{const e=j(),a=N();return w({mutationFn:t(async t=>await e.createBoothVisitor(t),"mutationFn"),onSuccess:t((e,t)=>{localStorage.setItem("last_campaign",t.campaign),localStorage.setItem("last_principal",t.principal_id.toString());const s=`âœ… Created: ${t.first_name} ${t.last_name} - ${t.org_name}`;a(s,{type:"success",autoHideDuration:2e3})},"onSuccess"),onError:t(e=>{a(`Failed to create booth visitor: ${e.message}`,{type:"error"})},"onError")})},"useQuickAdd"),rr=t(e=>{const{data:t,isLoading:a,error:s}=C("products",{filter:e?{principal_id:e}:{},pagination:{page:1,perPage:200},sort:{field:"name",order:"ASC"}},{enabled:!!e});return{products:t||[],isLoading:a,error:s,isReady:!!e,isEmpty:!(a||t&&0!==t.length)}},"useFilteredProducts");function ir({options:e,value:s,onValueChange:n,placeholder:r="Select option...",searchPlaceholder:i="Search...",emptyText:o="No option found.",className:l,disabled:c=!1,id:d}){const[u,p]=z.useState(!1),[m,h]=z.useState(""),g=e.find(e=>e.value===s);return a.jsxs(Ye,{open:u,onOpenChange:p,children:[a.jsx(et,{asChild:!0,children:a.jsxs(le,{id:d,variant:"outline",role:"combobox","aria-expanded":u,className:oe("w-[200px] justify-between",l),disabled:c,children:[g?g.label:r,a.jsx(st,{className:"ml-2 size-4 shrink-0 opacity-50"})]})}),a.jsx(tt,{className:"w-[200px] p-0",children:a.jsxs(Ke,{children:[a.jsx(Ge,{placeholder:i,value:m,onValueChange:h}),a.jsxs(Qe,{children:[a.jsx(Je,{children:o}),a.jsx(Xe,{children:e.map(e=>a.jsxs(Ze,{value:e.value,onSelect:t(e=>{n?.(e===s?"":e),p(!1),h("")},"onSelect"),children:[a.jsx(nt,{className:oe("mr-2 size-4",s===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]})}function or({options:e,value:s=[],onValueChange:n,placeholder:r="Select options...",searchPlaceholder:i="Search...",emptyText:o="No option found.",className:l,disabled:c=!1}){const[d,u]=z.useState(!1),[p,m]=z.useState(""),h=e.filter(e=>s.includes(e.value)).map(e=>e.label),g=0===h.length?r:1===h.length?h[0]:`${h.length} selected`,x=t(e=>{const t=s.includes(e)?s.filter(t=>t!==e):[...s,e];n?.(t)},"handleSelect");return a.jsxs(Ye,{open:d,onOpenChange:u,children:[a.jsx(et,{asChild:!0,children:a.jsxs(le,{variant:"outline",role:"combobox","aria-expanded":d,className:oe("w-[200px] justify-between",l),disabled:c,children:[g,a.jsx(st,{className:"ml-2 size-4 shrink-0 opacity-50"})]})}),a.jsx(tt,{className:"w-[200px] p-0",children:a.jsxs(Ke,{children:[a.jsx(Ge,{placeholder:i,value:p,onValueChange:m}),a.jsxs(Qe,{children:[a.jsx(Je,{children:o}),a.jsx(Xe,{children:e.map(e=>a.jsxs(Ze,{value:e.value,onSelect:t(()=>x(e.value),"onSelect"),children:[a.jsx(nt,{className:oe("mr-2 size-4",s.includes(e.value)?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]})}t(ir,"Combobox"),t(or,"MultiSelectCombobox");const lr=[{city:"Albuquerque",state:"NM"},{city:"Anaheim",state:"CA"},{city:"Anchorage",state:"AK"},{city:"Arlington",state:"TX"},{city:"Atlanta",state:"GA"},{city:"Aurora",state:"CO"},{city:"Austin",state:"TX"},{city:"Bakersfield",state:"CA"},{city:"Baltimore",state:"MD"},{city:"Baton Rouge",state:"LA"},{city:"Birmingham",state:"AL"},{city:"Boise",state:"ID"},{city:"Boston",state:"MA"},{city:"Buffalo",state:"NY"},{city:"Chandler",state:"AZ"},{city:"Charlotte",state:"NC"},{city:"Chesapeake",state:"VA"},{city:"Chicago",state:"IL"},{city:"Chula Vista",state:"CA"},{city:"Cincinnati",state:"OH"},{city:"Cleveland",state:"OH"},{city:"Colorado Springs",state:"CO"},{city:"Columbus",state:"OH"},{city:"Corpus Christi",state:"TX"},{city:"Dallas",state:"TX"},{city:"Denver",state:"CO"},{city:"Des Moines",state:"IA"},{city:"Detroit",state:"MI"},{city:"Durham",state:"NC"},{city:"El Paso",state:"TX"},{city:"Fort Wayne",state:"IN"},{city:"Fort Worth",state:"TX"},{city:"Fremont",state:"CA"},{city:"Fresno",state:"CA"},{city:"Garland",state:"TX"},{city:"Gilbert",state:"AZ"},{city:"Glendale",state:"AZ"},{city:"Greensboro",state:"NC"},{city:"Henderson",state:"NV"},{city:"Hialeah",state:"FL"},{city:"Honolulu",state:"HI"},{city:"Houston",state:"TX"},{city:"Huntington Beach",state:"CA"},{city:"Indianapolis",state:"IN"},{city:"Irvine",state:"CA"},{city:"Irving",state:"TX"},{city:"Jacksonville",state:"FL"},{city:"Jersey City",state:"NJ"},{city:"Kansas City",state:"MO"},{city:"Laredo",state:"TX"},{city:"Las Vegas",state:"NV"},{city:"Lexington",state:"KY"},{city:"Lincoln",state:"NE"},{city:"Long Beach",state:"CA"},{city:"Los Angeles",state:"CA"},{city:"Louisville",state:"KY"},{city:"Lubbock",state:"TX"},{city:"Madison",state:"WI"},{city:"Memphis",state:"TN"},{city:"Mesa",state:"AZ"},{city:"Miami",state:"FL"},{city:"Milwaukee",state:"WI"},{city:"Minneapolis",state:"MN"},{city:"Modesto",state:"CA"},{city:"Nashville",state:"TN"},{city:"New Orleans",state:"LA"},{city:"New York",state:"NY"},{city:"Newark",state:"NJ"},{city:"Norfolk",state:"VA"},{city:"North Las Vegas",state:"NV"},{city:"Oakland",state:"CA"},{city:"Oklahoma City",state:"OK"},{city:"Omaha",state:"NE"},{city:"Orlando",state:"FL"},{city:"Oxnard",state:"CA"},{city:"Philadelphia",state:"PA"},{city:"Phoenix",state:"AZ"},{city:"Pittsburgh",state:"PA"},{city:"Plano",state:"TX"},{city:"Portland",state:"OR"},{city:"Raleigh",state:"NC"},{city:"Reno",state:"NV"},{city:"Richmond",state:"VA"},{city:"Riverside",state:"CA"},{city:"Rochester",state:"NY"},{city:"Sacramento",state:"CA"},{city:"Salt Lake City",state:"UT"},{city:"San Antonio",state:"TX"},{city:"San Bernardino",state:"CA"},{city:"San Diego",state:"CA"},{city:"San Francisco",state:"CA"},{city:"San Jose",state:"CA"},{city:"Santa Ana",state:"CA"},{city:"Santa Clarita",state:"CA"},{city:"Scottsdale",state:"AZ"},{city:"Seattle",state:"WA"},{city:"Spokane",state:"WA"},{city:"St. Louis",state:"MO"},{city:"St. Paul",state:"MN"},{city:"St. Petersburg",state:"FL"},{city:"Stockton",state:"CA"},{city:"Tampa",state:"FL"},{city:"Toledo",state:"OH"},{city:"Tucson",state:"AZ"},{city:"Tulsa",state:"OK"},{city:"Virginia Beach",state:"VA"},{city:"Washington",state:"DC"},{city:"Wichita",state:"KS"},{city:"Winston-Salem",state:"NC"}];function cr(e,t=""){try{const a=localStorage.getItem(e);return"string"==typeof a?a:t}catch{return t}}t(cr,"getLocalStorageString");const dr=t(({onSuccess:e})=>{const{mutate:s,isPending:n}=nr(),r=z.useRef(null),{data:i,isLoading:o}=C("organizations",{filter:{organization_type:"principal"},pagination:{page:1,perPage:100},sort:{field:"name",order:"ASC"}}),l=ce.partial().parse({}),c={...l,campaign:cr("last_campaign",l.campaign||""),principal_id:Number(cr("last_principal",l.principal_id?.toString()||""))||void 0},{register:d,handleSubmit:u,formState:{errors:p},setValue:m,control:h,reset:g,clearErrors:x}=Be({resolver:He(ce),defaultValues:c}),[f,y,b,v,j]=qe({control:h,name:["principal_id","city","phone","email","product_ids"]}),{products:N,isLoading:w,isReady:_}=rr(f);z.useEffect(()=>{(b||v)&&"Phone or Email required (at least one)"===p.phone?.message&&x("phone")},[b,v,p.phone,x]);const S=t(e=>{const t=lr.find(t=>t.city===e);t?(m("city",t.city),m("state",t.state)):(m("city",e),m("state",""))},"handleCitySelect"),k=t((a,n)=>{s(a,{onSuccess:t(()=>{n?e():(g({campaign:a.campaign,principal_id:a.principal_id,product_ids:[],first_name:"",last_name:"",phone:"",email:"",org_name:"",city:"",state:"",quick_note:""}),setTimeout(()=>r.current?.focus(),100))},"onSuccess")})},"onSubmit"),O=i?.map(e=>({value:e.id.toString(),label:e.name}))||[],I=N?.map(e=>({value:e.id.toString(),label:e.name}))||[],P=lr.map(({city:e})=>({value:e,label:e}));return a.jsxs("form",{className:"flex flex-col gap-6",children:[a.jsxs("div",{className:"rounded-lg bg-success/10 p-4 space-y-4",children:[a.jsx("h3",{className:"text-sm font-medium text-foreground",children:"Pre-filled Information"}),a.jsxs("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"campaign",children:"Campaign"}),a.jsx(ue,{id:"campaign",...d("campaign"),placeholder:"e.g., Q4 2025 Trade Show",className:"bg-background"}),p.campaign&&a.jsx("p",{className:"text-sm text-destructive",children:p.campaign.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"principal",children:"Principal *"}),a.jsxs(pe,{value:f?.toString(),onValueChange:t(e=>m("principal_id",Number(e)),"onValueChange"),disabled:o,children:[a.jsx(me,{className:"bg-background",children:a.jsx(he,{placeholder:o?"Loading...":"Select principal"})}),a.jsx(ge,{children:O.map(e=>a.jsx(xe,{value:e.value,children:e.label},e.value))})]}),p.principal_id&&a.jsx("p",{className:"text-sm text-destructive",children:p.principal_id.message})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"products",children:"Products"}),_?a.jsx(or,{options:I,value:j?.map(e=>e.toString())||[],onValueChange:t(e=>m("product_ids",e.map(e=>Number(e))),"onValueChange"),placeholder:w?"Loading products...":"Select products...",searchPlaceholder:"Search products...",emptyText:"No products found",className:"bg-background",disabled:w||!I.length}):a.jsx("div",{className:"text-sm text-muted-foreground p-2 border rounded-md bg-background",children:"Select a Principal first to filter products"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-medium text-foreground",children:"Contact Information"}),a.jsxs("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"first_name",children:"First Name *"}),a.jsx(ue,{ref:r,id:"first_name",...d("first_name"),placeholder:"John"}),p.first_name&&a.jsx("p",{className:"text-sm text-destructive",children:p.first_name.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"last_name",children:"Last Name *"}),a.jsx(ue,{id:"last_name",...d("last_name"),placeholder:"Doe"}),p.last_name&&a.jsx("p",{className:"text-sm text-destructive",children:p.last_name.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"phone",children:"Phone"}),a.jsx(ue,{id:"phone",type:"tel",...d("phone"),placeholder:"555-123-4567"}),p.phone&&a.jsx("p",{className:"text-sm text-destructive",children:p.phone.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"email",children:"Email"}),a.jsx(ue,{id:"email",type:"email",...d("email"),placeholder:"john@example.com"}),p.email&&a.jsx("p",{className:"text-sm text-destructive",children:p.email.message})]})]}),!b&&!v&&a.jsx("p",{className:"text-sm text-muted-foreground",children:"At least one of Phone or Email is required"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-medium text-foreground",children:"Organization Information"}),a.jsxs("div",{className:"grid gap-4 grid-cols-1",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"org_name",children:"Organization Name *"}),a.jsx(ue,{id:"org_name",...d("org_name"),placeholder:"Acme Corporation"}),p.org_name&&a.jsx("p",{className:"text-sm text-destructive",children:p.org_name.message})]}),a.jsxs("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"city",children:"City *"}),a.jsx(ir,{id:"city",options:P,value:y,onValueChange:t(e=>S(e),"onValueChange"),placeholder:"Select or type city...",searchPlaceholder:"Search cities...",emptyText:"Type to search cities",className:"w-full"}),p.city&&a.jsx("p",{className:"text-sm text-destructive",children:p.city.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"state",children:"State *"}),a.jsx(ue,{id:"state",...d("state"),placeholder:"CA",readOnly:!!lr.find(e=>e.city===y),className:oe(lr.find(e=>e.city===y)&&"bg-muted")}),p.state&&a.jsx("p",{className:"text-sm text-destructive",children:p.state.message})]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-medium text-foreground",children:"Optional Details"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(de,{htmlFor:"quick_note",children:"Quick Note"}),a.jsx(ue,{id:"quick_note",...d("quick_note"),placeholder:"Met at booth, interested in product demo..."})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsx(le,{type:"button",variant:"outline",onClick:e,disabled:n,children:"Cancel"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(le,{type:"button",onClick:u(e=>k(e,!1)),disabled:n,children:"Save & Add Another"}),a.jsx(le,{type:"button",variant:"secondary",onClick:u(e=>k(e,!0)),disabled:n,children:"Save & Close"})]})]})]})},"QuickAddForm"),ur=t(({open:e,onOpenChange:s})=>a.jsx(fe,{open:e,onOpenChange:s,children:a.jsxs(ye,{className:"w-full max-w-2xl sm:w-[calc(100%-2rem)] max-h-[90vh] overflow-y-auto","aria-describedby":"quick-add-description",children:[a.jsxs(be,{children:[a.jsx(ve,{children:"Quick Add Booth Visitor"}),a.jsx(je,{id:"quick-add-description",children:"Quickly capture lead information from trade show booth conversations"})]}),a.jsx(dr,{onSuccess:t(()=>s(!1),"onSuccess")})]})}),"QuickAddDialog"),pr=t(()=>{const[e,s]=z.useState(!1);return a.jsxs(a.Fragment,{children:[a.jsx(le,{onClick:t(()=>s(!0),"onClick"),variant:"outline",size:"default",className:"min-h-[44px] min-w-[44px]",children:"âš¡ Quick Add"}),a.jsx(ur,{open:e,onOpenChange:s})]})},"QuickAddButton"),mr=t(()=>{const{data:e}=_(),{data:s,total:n,isPending:r}=C("opportunities",{pagination:{page:1,perPage:1e3},sort:{field:"deleted_at",order:"DESC"},filter:{"deleted_at@not.is":null}}),[i,o]=z.useState(!1);if(z.useEffect(()=>{r||0!==n||o(!1)},[r,n]),z.useEffect(()=>{o(!1)},[s]),!e||r||!n||!s)return null;const l=s.reduce((e,t)=>{const a=Ne(t.deleted_at);if(!a)return e;const s=a.toDateString();return e[s]||(e[s]=[]),e[s].push(t),e},{});return a.jsxs("div",{className:"w-full flex flex-row items-center justify-center",children:[a.jsx(le,{variant:"ghost",onClick:t(()=>o(!0),"onClick"),className:"my-4",children:"View archived opportunities"}),a.jsx(fe,{open:i,onOpenChange:t(()=>o(!1),"onOpenChange"),children:a.jsxs(ye,{className:"lg:max-w-4xl overflow-y-auto max-h-9/10 top-1/20 translate-y-0",children:[a.jsxs(be,{children:[a.jsx(ve,{children:"Archived Opportunities"}),a.jsx(je,{children:"View opportunities that have been archived. These are grouped by archive date."})]}),a.jsx("div",{className:"flex flex-col gap-8",children:Object.entries(l).map(([e,t])=>a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("h4",{className:"font-bold",children:hr(e)}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8",children:t.map(e=>a.jsxs("div",{className:"bg-card rounded-lg border border-border p-4",children:[a.jsx("h3",{className:"font-medium text-sm text-foreground mb-2",children:e.name}),a.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[a.jsxs("div",{children:["Stage: ",H(e.stage)]}),e.estimated_close_date&&Ne(e.estimated_close_date)&&a.jsxs("div",{children:["Close Date:"," ",Qt(Ne(e.estimated_close_date),"MMM d, yyyy")]}),e.deleted_at&&Ne(e.deleted_at)&&a.jsxs("div",{className:"text-destructive mt-2",children:["Archived:"," ",Qt(Ne(e.deleted_at),"MMM d, yyyy")]})]})]},e.id))})]},e))})]})})]})},"OpportunityArchivedList");function hr(e){const t=new Date(e);t.setHours(0,0,0,0);const a=new Date;a.setHours(0,0,0,0);const s=t.getTime()-a.getTime(),n=Math.round(s/864e5);if(Math.abs(n)>7)return new Intl.DateTimeFormat(void 0,{day:"numeric",month:"long"}).format(t);return gr(new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}).format(n,"day"))}function gr(e){return e.charAt(0).toUpperCase()+e.slice(1)}t(hr,"getRelativeTimeString"),t(gr,"ucFirst");const xr=t(({children:e})=>{const t=na(),{data:s,isPending:n}=C("contacts",{pagination:{page:1,perPage:1}});return n?a.jsx(sa,{value:50}):a.jsxs("div",{className:"flex flex-col justify-center items-center gap-12",style:{height:`calc(100dvh - ${t}px)`},children:[a.jsx("img",{src:"./img/empty.svg",alt:"No opportunities found"}),s&&s.length>0?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col items-center gap-0",children:[a.jsx("h3",{className:"text-lg font-bold",children:"No opportunities found"}),a.jsx("p",{className:"text-sm text-center text-muted-foreground mb-4",children:"It seems your opportunity list is empty."})]}),a.jsx("div",{className:"flex space-x-8",children:a.jsx(F,{label:"Create opportunity"})}),e]}):a.jsxs("div",{className:"flex flex-col items-center gap-0",children:[a.jsx("h3",{className:"text-lg font-bold",children:"No opportunities found"}),a.jsxs("p",{className:"text-sm text-center text-muted-foreground mb-4",children:["It seems your contact list is empty.",a.jsx("br",{}),a.jsx(R,{to:"/contacts/create",className:"hover:underline",children:"Add your first contact"})," ","before creating an opportunity."]})]})]})},"OpportunityEmpty");function fr(e){const t=z.useMemo(()=>e,[JSON.stringify(e)]),{data:a,isLoading:s,error:n}=S("contacts",{ids:t},{enabled:t.length>0});return z.useMemo(()=>{const e=a&&a.length>0?a[0]:null;return{contacts:a||[],primaryContact:e,isLoading:s,error:n}},[a,s,n])}t(fr,"useOpportunityContacts");function yr(e){if(0===e.length)return{count:0,avgDaysInStage:0,stuckCount:0};const t=e.reduce((e,t)=>e+(t.days_in_stage||0),0),a=Math.round(t/e.length),s=e.filter(e=>(e.days_in_stage||0)>14).length;return{count:e.length,avgDaysInStage:a,stuckCount:s}}function br(e){return z.useMemo(()=>yr(e),[e])}t(yr,"calculateStageMetrics"),t(br,"useStageMetrics");const vr=t(({open:e,onOpenChange:t,opportunityId:s,opportunityName:n,targetStage:r,onConfirm:i,isSubmitting:o=!1})=>{const l="closed_won"===r,c=we.partial().parse({id:s,stage:r}),d=Be({resolver:He(we),defaultValues:c,mode:"onBlur"}),{control:u,reset:p,handleSubmit:m,formState:h,trigger:g}=d,{errors:x,isValid:f}=h,y=qe({control:u,name:"win_reason"}),b=qe({control:u,name:"loss_reason"}),v=qe({control:u,name:"close_reason_notes"});z.useEffect(()=>{g()},[y,b,v,g]);const j="other"===y||"other"===b;z.useEffect(()=>{e&&p({id:s,stage:r,win_reason:null,loss_reason:null,close_reason_notes:null})},[e,s,r,p]);const N=z.useCallback(e=>{i(e)},[i]),w=z.useCallback(()=>{t(!1)},[t]);return a.jsx(fe,{open:e,onOpenChange:t,children:a.jsxs(ye,{className:"w-full max-w-md sm:w-[calc(100%-2rem)]","aria-describedby":"close-opportunity-description",children:[a.jsxs(be,{className:"gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[l?a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-success/10",children:a.jsx(rt,{className:"h-5 w-5 text-success"})}):a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-destructive/10",children:a.jsx(it,{className:"h-5 w-5 text-destructive"})}),a.jsx(ve,{className:"text-lg font-semibold",children:l?"Close as Won":"Close as Lost"})]}),a.jsx(je,{id:"close-opportunity-description",className:"text-sm",children:l?`Congratulations! Please select the primary reason you won "${n}".`:`Please select the primary reason "${n}" was lost.`})]}),a.jsx(Ue,{...d,children:a.jsxs("form",{onSubmit:m(N),className:"space-y-4 pt-2",children:[l?a.jsx(la,{source:"win_reason",label:"Win Reason *",choices:Ce,helperText:"Why did you win this opportunity?",className:"w-full"}):a.jsx(la,{source:"loss_reason",label:"Loss Reason *",choices:_e,helperText:"Why was this opportunity lost?",className:"w-full"}),j&&a.jsx("div",{className:"animate-in fade-in-0 slide-in-from-top-2 duration-200",children:a.jsx(Se,{source:"close_reason_notes",label:"Please specify *",multiline:!0,rows:3,placeholder:"Describe the specific reason...",helperText:"Required when selecting 'Other'",className:"w-full"})}),Object.keys(x).length>0&&a.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-destructive/10 p-3 text-sm text-destructive",children:[a.jsx(ot,{className:"h-4 w-4 flex-shrink-0"}),a.jsx("span",{children:x.win_reason?.message||x.loss_reason?.message||x.close_reason_notes?.message||"Please complete all required fields"})]}),a.jsxs(ke,{className:"gap-2 pt-4 sm:gap-0",children:[a.jsx(le,{type:"button",variant:"outline",onClick:w,disabled:o,className:"h-11 min-w-[100px]",children:"Cancel"}),a.jsx(le,{type:"submit",disabled:!f||o,className:oe("h-11 min-w-[120px]",l?"bg-success text-success-foreground hover:bg-success/90":"bg-destructive text-destructive-foreground hover:bg-destructive/90"),children:o?"Saving...":l?"Close as Won":"Close as Lost"})]})]})})]})})},"CloseOpportunityModal");function jr({opportunityId:e,onDelete:s}){const n=M(),[r]=k(),[i]=O(),o=N(),l=I(),c=P(),[d,u]=z.useState(!1),[p,m]=z.useState("closed_won"),[h,g]=z.useState(!1),x=z.useCallback(()=>{n(`/opportunities/${e}/show`)},[n,e]),f=z.useCallback(()=>{n(`/opportunities/${e}`)},[n,e]),y=z.useCallback(e=>{m(e),u(!0)},[]),b=z.useCallback(async t=>{g(!0);try{await r("opportunities",{id:e,data:{stage:p,win_reason:t.win_reason,loss_reason:t.loss_reason,close_reason_notes:t.close_reason_notes},previousData:c||{}}),o("closed_won"===p?"Opportunity marked as won":"Opportunity marked as lost",{type:"success"}),l(),u(!1)}catch{o("Error updating opportunity",{type:"error"})}finally{g(!1)}},[e,p,r,o,l,c]),v=z.useCallback(e=>{u(e)},[]),j=z.useCallback(async()=>{if(window.confirm("Are you sure you want to delete this opportunity?"))try{await i("opportunities",{id:e,previousData:{}}),o("Opportunity deleted",{type:"success"}),s?s(e):l()}catch{o("Error deleting opportunity",{type:"error"})}},[i,e,o,s,l]);return a.jsxs("div",{"data-action-button":!0,children:[a.jsxs(Oe,{children:[a.jsx(Ie,{asChild:!0,children:a.jsx("button",{type:"button","aria-label":"Actions menu",onMouseDown:t(e=>e.stopPropagation(),"onMouseDown"),onClick:t(e=>e.stopPropagation(),"onClick"),className:"min-h-[44px] min-w-[44px] flex items-center justify-center rounded hover:bg-muted transition-colors touch-manipulation focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2",children:a.jsx(lt,{className:"w-5 h-5 text-muted-foreground"})})}),a.jsxs(Pe,{align:"end",className:"w-48",children:[a.jsxs(Ae,{onClick:x,children:[a.jsx(ct,{className:"mr-2 h-4 w-4"}),"View Details"]}),a.jsxs(Ae,{onClick:f,children:[a.jsx(dt,{className:"mr-2 h-4 w-4"}),"Edit"]}),a.jsx(Te,{}),a.jsxs(Ae,{onClick:t(()=>y("closed_won"),"onClick"),className:"text-success-strong focus:text-success-strong",children:[a.jsx(rt,{className:"mr-2 h-4 w-4"}),"Mark as Won"]}),a.jsxs(Ae,{onClick:t(()=>y("closed_lost"),"onClick"),variant:"destructive",children:[a.jsx(it,{className:"mr-2 h-4 w-4"}),"Mark as Lost"]}),a.jsx(Te,{}),a.jsxs(Ae,{onClick:j,variant:"destructive",children:[a.jsx(ut,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}),a.jsx(vr,{open:d,onOpenChange:v,opportunityId:e,opportunityName:c?.name||"Opportunity",targetStage:p,onConfirm:b,isSubmitting:h})]})}function Nr({daysSinceLastActivity:e}){const{colorClass:t,label:s}=wr(e);return a.jsx("span",{role:"status","aria-label":s,className:`\n        inline-block w-2.5 h-2.5 rounded-full flex-shrink-0\n        ${t}\n      `})}function wr(e){return null==e?{colorClass:"bg-muted-foreground",label:"No activity recorded"}:e<7?{colorClass:"bg-success",label:`Last activity ${e} days ago`}:e<=14?{colorClass:"bg-warning",label:`Last activity ${e} days ago`}:{colorClass:"bg-destructive",label:`Last activity ${e} days ago`}}t(jr,"OpportunityCardActions"),t(Nr,"ActivityPulseDot"),t(wr,"getActivityPulseConfig");const Cr={low:"bg-muted text-muted-foreground",medium:"bg-primary/10 text-primary",high:"bg-warning/10 text-warning",critical:"bg-destructive text-destructive-foreground"},_r=V.memo(t(function({index:e,openSlideOver:s,onDelete:n}){const r=P(),[i,o]=z.useState(!1),{primaryContact:l,isLoading:c}=fr(r?.contact_ids||[]);if(!r)return null;const d=t(e=>{e.target.closest("[data-action-button]")||e.target.closest("[data-expand-toggle]")||e.target.closest("[data-drag-handle]")||(e.preventDefault(),e.stopPropagation(),s(r.id,"view"))},"handleCardClick"),u=t(e=>{e.preventDefault(),e.stopPropagation(),o(!i)},"handleExpandClick"),p=r.days_in_stage||0,m=p>14,h=r.priority||"medium",g=Cr[h]||Cr.medium,x=h.charAt(0).toUpperCase()+h.slice(1),f=r.estimated_close_date&&Ne(r.estimated_close_date),y=f?Qt(f,"MMM d, yyyy"):"No date set",b=f?Jt(f,new Date):null,v=null!==b?b<0?"overdue":b<7?"soon":"normal":"normal",j=r.pending_task_count||0,N=r.overdue_task_count||0,w=r.products?.length||0;return a.jsx(ra,{draggableId:String(r.id),index:e,children:t((e,s)=>a.jsxs("div",{ref:e.innerRef,...e.draggableProps,role:"button",tabIndex:0,onClick:d,onKeyDown:t(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),d(e))},"onKeyDown"),className:`\n            bg-card rounded-lg border border-border\n            p-3\n            transition-all duration-200\n            hover:shadow-md hover:-translate-y-0.5\n            cursor-pointer\n            ${s.isDragging?"opacity-50 rotate-2":"opacity-100"}\n          `,"data-testid":"opportunity-card","data-tutorial":"opp-card",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{...e.dragHandleProps,"data-testid":"drag-handle","data-tutorial":"opp-drag-handle","data-drag-handle":!0,"aria-label":"Drag to reorder",className:"min-h-[44px] min-w-[36px] flex items-center justify-center text-muted-foreground hover:text-foreground hover:bg-accent rounded cursor-grab active:cursor-grabbing transition-colors touch-manipulation focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 -ml-1",children:a.jsx(pt,{className:"w-3.5 h-3.5"})}),a.jsx(Nr,{daysSinceLastActivity:r.days_since_last_activity}),a.jsx("h3",{className:`\n              font-semibold text-base text-foreground flex-1 min-w-0 leading-normal\n              ${i?"":"line-clamp-3"}\n            `,children:r.name}),a.jsx("button",{"data-expand-toggle":!0,onClick:u,onMouseDown:t(e=>e.stopPropagation(),"onMouseDown"),onTouchStart:t(e=>e.stopPropagation(),"onTouchStart"),"aria-expanded":i,"aria-label":i?"Collapse card":"Expand card",className:"min-h-[44px] min-w-[36px] flex items-center justify-center text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors",children:i?a.jsx(mt,{className:"w-3.5 h-3.5"}):a.jsx(at,{className:"w-3.5 h-3.5"})}),a.jsx(jr,{opportunityId:r.id,onDelete:n})]}),a.jsx("div",{className:`\n            grid transition-[grid-template-rows] duration-200 ease-out\n            ${i?"grid-rows-[1fr]":"grid-rows-[0fr]"}\n          `,children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("div",{className:"pt-3 mt-2 border-t border-border space-y-2",children:[r.description&&a.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:r.description}),a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${g}`,children:x}),r.principal_organization_name&&a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-accent text-accent-foreground",children:r.principal_organization_name})]}),c?a.jsx("div",{className:"h-4 bg-muted animate-pulse rounded"}):l?a.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx(ht,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[l.firstName," ",l.lastName]})]}):null,a.jsxs("div",{className:"flex items-center gap-2 text-xs "+("overdue"===v?"text-destructive":"soon"===v?"text-warning":"text-muted-foreground"),children:[a.jsx(gt,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:y}),"overdue"===v&&a.jsx("span",{children:"(overdue)"}),"soon"===v&&null!==b&&a.jsxs("span",{children:["(in ",b,"d)"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs "+(m?"text-warning":"text-muted-foreground"),children:[a.jsx(xt,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[p," days in stage"]}),m&&a.jsx("span",{className:"text-warning",children:"âš ï¸"})]}),j>0&&a.jsxs("div",{className:"flex items-center gap-2 text-xs "+(N>0?"text-destructive":"text-muted-foreground"),children:[a.jsx(ft,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[j," task",1!==j?"s":"",N>0&&` (${N} overdue)`]})]}),w>0&&a.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx(yt,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[w," product",1!==w?"s":""]})]}),"closed_won"===r.stage&&r.win_reason&&a.jsxs("div",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded bg-success/10 text-success",children:[a.jsx(rt,{className:"w-3 h-3"}),a.jsx("span",{children:Ce.find(e=>e.id===r.win_reason)?.name||r.win_reason})]}),"closed_lost"===r.stage&&r.loss_reason&&a.jsxs("div",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded bg-destructive/10 text-destructive",children:[a.jsx(it,{className:"w-3 h-3"}),a.jsx("span",{children:_e.find(e=>e.id===r.loss_reason)?.name||r.loss_reason})]})]})})})]}),"children")})},"OpportunityCard2"));function Sr({stage:e}){const[s,n]=z.useState(!1),[r,i]=z.useState(""),[o,l]=z.useState(""),[c,{isLoading:d}]=A(),u=N(),p=I(),{identity:m}=_(),{data:h,isLoading:g}=C("organizations",{pagination:{page:1,perPage:100},sort:{field:"name",order:"ASC"},filter:{"organization_type@in":"(prospect,customer)",deleted_at:null}}),x=t(async t=>{if(t.preventDefault(),r.trim())if(o)try{const t=$e.parse({name:r.trim(),stage:e,customer_organization_id:Number(o),opportunity_owner_id:m?.id,account_manager_id:m?.id});await c("opportunities",{data:t}),u("Opportunity created! Add details via the card menu.",{type:"success"}),n(!1),i(""),l(""),p()}catch(a){const e=a instanceof Error?a.message:"Error creating opportunity";u(e,{type:"error"})}else u("Customer is required",{type:"error"});else u("Name is required",{type:"error"})},"handleSubmit"),f=e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:t(()=>n(!0),"onClick"),className:"w-full py-2 px-3 text-sm text-primary hover:bg-primary/10 rounded transition-colors border border-dashed border-border",children:"+ New Opportunity"}),s&&a.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"quick-add-opportunity-title",className:"fixed inset-0 bg-background/80 flex items-center justify-center z-50 motion-safe:animate-in motion-safe:fade-in motion-safe:duration-150",children:a.jsxs("div",{className:"bg-card rounded-lg shadow-xl p-6 w-full max-w-md motion-safe:animate-in motion-safe:fade-in motion-safe:slide-in-from-bottom-4 motion-safe:duration-200",children:[a.jsx("h2",{id:"quick-add-opportunity-title",className:"text-lg font-semibold mb-4",children:"Create Opportunity"}),a.jsxs("form",{onSubmit:x,children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:["Name ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsx("input",{id:"name",type:"text",value:r,onChange:t(e=>i(e.target.value),"onChange"),className:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary transition-colors",placeholder:"Enter opportunity name",disabled:d,autoFocus:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{htmlFor:"customer",className:"block text-sm font-medium mb-1",children:["Customer ",a.jsx("span",{className:"text-destructive",children:"*"})]}),a.jsxs("select",{id:"customer",value:o,onChange:t(e=>l(e.target.value),"onChange"),className:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary transition-colors bg-background",disabled:d||g,children:[a.jsx("option",{value:"",children:g?"Loading customers...":"Select a customer"}),h?.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"stage",className:"block text-sm font-medium mb-1",children:"Stage"}),a.jsx("input",{id:"stage",type:"text",value:f,disabled:!0,className:"w-full px-3 py-2 border border-border rounded-md bg-muted text-muted-foreground"})]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{type:"button",onClick:t(()=>{n(!1),i("")},"onClick"),className:"px-4 py-2 text-sm border border-border rounded hover:bg-accent active:bg-accent/80 transition-colors motion-safe:active:scale-[0.98]",disabled:d,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 active:bg-primary/80 transition-colors motion-safe:active:scale-[0.98] disabled:opacity-50 inline-flex items-center gap-2",disabled:d,children:d?a.jsxs(a.Fragment,{children:[a.jsx(bt,{className:"h-4 w-4 animate-spin"}),"Creating..."]}):"Create"})]})]})]})})]})}function kr(e,t){if(e.stage!==t.stage)return!1;if(e.isCollapsed!==t.isCollapsed)return!1;if(e.onToggleCollapse!==t.onToggleCollapse)return!1;if(e.openSlideOver!==t.openSlideOver)return!1;if(e.onDeleteOpportunity!==t.onDeleteOpportunity)return!1;const a=e.opportunities,s=t.opportunities;if(a.length!==s.length)return!1;for(let n=0;n<a.length;n++){const e=a[n],t=s[n];if(e.id!==t.id||e.name!==t.name||e.stage!==t.stage||e.days_since_last_activity!==t.days_since_last_activity||e.description!==t.description||e.priority!==t.priority||e.principal_organization_name!==t.principal_organization_name||e.estimated_close_date!==t.estimated_close_date||e.days_in_stage!==t.days_in_stage||e.pending_task_count!==t.pending_task_count||e.overdue_task_count!==t.overdue_task_count||(e.products?.length??0)!==(t.products?.length??0))return!1}return!0}t(Sr,"QuickAddOpportunity"),t(kr,"arePropsEqual");const Or=V.memo(t(function({stage:e,opportunities:s,isCollapsed:n=!1,onToggleCollapse:r,openSlideOver:i,onDeleteOpportunity:o}){const l=br(s),c={1:{rest:"shadow-elevation-1",hover:"hover:shadow-elevation-2"},2:{rest:"shadow-elevation-2",hover:"hover:shadow-elevation-3"},3:{rest:"shadow-elevation-3",hover:"hover:shadow-elevation-3"}}[K(e)];return a.jsxs("div",{className:`\n  flex flex-col pb-4 bg-card border border-border rounded-xl shadow-col-inner\n  ${c.rest} ${c.hover}\n  transition-[box-shadow,border-color] duration-200 ease-in-out px-2\n  min-w-[260px] max-w-[300px]\n  md:min-w-[280px] md:max-w-[320px]\n  lg:min-w-[300px] lg:max-w-[340px]\n  h-full max-h-full overflow-hidden shrink-0\n`,"data-testid":"kanban-column",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2 pb-2 border-b border-border px-2 py-1.5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[r&&a.jsx("button",{onClick:r,className:"min-h-[44px] min-w-[44px] flex items-center justify-center text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors touch-manipulation focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2","aria-label":n?"Expand column":"Collapse column",type:"button",children:n?"â–¶":"â–¼"}),a.jsxs(Le,{children:[a.jsx(De,{asChild:!0,children:a.jsx("h2",{className:"font-semibold text-base text-foreground cursor-help",style:{borderBottom:`2px solid ${G(e)}`},children:H(e)})}),a.jsx(Ee,{side:"bottom",className:"max-w-[320px] bg-popover text-popover-foreground border border-border shadow-lg",children:a.jsxs("div",{className:"space-y-2 p-1",children:[a.jsx("p",{className:"text-sm leading-relaxed",children:J(e)}),Q(e)&&a.jsxs("div",{className:"pt-2 border-t border-border/50",children:[a.jsxs("p",{className:"text-xs font-medium text-primary",children:["ðŸ“‹ MFB ",Q(e)?.phase,":"," ",Q(e)?.name]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:Q(e)?.context})]})]})})]}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",l.count,")"]})]}),!n&&l.count>0&&a.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[a.jsxs("span",{title:"Average days in this stage",children:["~",l.avgDaysInStage,"d"]}),l.stuckCount>0&&a.jsxs("span",{className:"text-warning",title:"Opportunities stuck >14 days",children:["âš  ",l.stuckCount]})]})]}),!n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-2 px-1",children:a.jsx(Sr,{stage:e})}),a.jsx(ia,{droppableId:e,children:t((e,t)=>a.jsxs("div",{ref:e.innerRef,...e.droppableProps,className:"flex flex-col flex-1 rounded-xl mt-1 gap-1.5 pb-2 min-h-[80px] overflow-y-auto overflow-x-hidden transition-colors px-1 "+(t.isDraggingOver?"bg-accent":""),children:[s.map((e,t)=>a.jsx(T,{value:e,children:a.jsx(_r,{index:t,openSlideOver:i,onDelete:o})},e.id)),e.placeholder]}),"children")})]})]})},"OpportunityColumn2"),kr),Ir=t((e,t)=>{const a=t||X.map(e=>({value:e.value,label:e.label}));if(!a.length)return{};const s=e.reduce((e,t)=>(e[t.stage]&&e[t.stage].push(t),e),a.reduce((e,t)=>({...e,[t.value]:[]}),{}));return a.forEach(e=>{s[e.value]&&(s[e.value]=s[e.value].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))}),s},"getOpportunitiesByStage"),Pr="opportunity.kanban.collapsed_stages",Ar="opportunity.kanban.visible_stages";function Tr(){const e=X.map(e=>e.value),[a,s]=z.useState(()=>{const e=localStorage.getItem(Pr);return e?JSON.parse(e):[]}),[n,r]=z.useState(()=>{const t=localStorage.getItem(Ar);return t?JSON.parse(t):e});z.useEffect(()=>{localStorage.setItem(Pr,JSON.stringify(a))},[a]),z.useEffect(()=>{localStorage.setItem(Ar,JSON.stringify(n))},[n]);return{collapsedStages:a,visibleStages:n,toggleCollapse:t(e=>{s(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},"toggleCollapse"),toggleVisibility:t(e=>{r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},"toggleVisibility"),collapseAll:t(()=>{s(e)},"collapseAll"),expandAll:t(()=>{s([])},"expandAll")}}function $r({visibleStages:e,toggleVisibility:s,collapseAll:n,expandAll:r}){const[i,o]=z.useState(!1),l=z.useRef(null);return z.useEffect(()=>{function e(e){l.current&&!l.current.contains(e.target)&&o(!1)}return t(e,"handleClickOutside"),i&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[i]),a.jsxs("div",{className:"relative",ref:l,children:[a.jsx("button",{type:"button","aria-label":"Customize columns",onClick:t(()=>o(!i),"onClick"),className:"h-8 w-8 flex items-center justify-center text-muted-foreground hover:text-foreground bg-card/80 backdrop-blur-sm border border-border rounded-md hover:bg-accent transition-colors shadow-sm",children:a.jsx(vt,{className:"w-4 h-4"})}),i&&a.jsx("div",{className:"absolute right-0 top-full mt-1 w-64 bg-popover border border-border rounded-md shadow-lg z-50",children:a.jsxs("div",{className:"py-2",children:[a.jsxs("div",{className:"px-4 py-2 border-b border-border flex gap-2",children:[a.jsx("button",{onClick:t(()=>{n(),o(!1)},"onClick"),className:"min-h-[44px] px-3 text-sm text-primary hover:bg-accent rounded transition-colors touch-manipulation",children:"Collapse All"}),a.jsx("button",{onClick:t(()=>{r(),o(!1)},"onClick"),className:"min-h-[44px] px-3 text-sm text-primary hover:bg-accent rounded transition-colors touch-manipulation",children:"Expand All"})]}),a.jsxs("div",{className:"px-4 py-2",children:[a.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Visible Stages"}),X.map(n=>a.jsxs("label",{className:"flex items-center gap-3 min-h-[44px] cursor-pointer hover:bg-accent rounded px-1 -mx-1 transition-colors",children:[a.jsx(ca,{id:`stage-${n.value}`,checked:e.includes(n.value),onCheckedChange:t(()=>s(n.value),"onCheckedChange")}),a.jsx("span",{className:"text-sm select-none",children:n.label})]},n.value))]})]})})]})}t(Tr,"useColumnPreferences"),t($r,"ColumnCustomizationMenu");const Lr=t(({openSlideOver:e,slideOverId:s,closeSlideOver:n})=>{const r=Z,{data:i,isPending:o,filterValues:l}=$(),[c]=k(),d=N(),u=I(),[p,m]=z.useState(!1),[h,g]=z.useState(null),[x,f]=z.useState(!1),{collapsedStages:y,visibleStages:b,toggleCollapse:v,toggleVisibility:j,collapseAll:w,expandAll:C}=Tr(),_=l?.stage&&Array.isArray(l.stage)&&l.stage.length>0?r.filter(e=>l.stage.includes(e.value)&&b.includes(e.value)):r.filter(e=>b.includes(e.value)),[S,O]=z.useState(Ir([],r));z.useEffect(()=>{if(i){const e=Ir(i,r);Rs(e,S)||O(e)}},[i]);const P=z.useCallback((e,a,s,n,r)=>{c("opportunities",{id:e,data:{stage:a,...r},previousData:n},{onSuccess:t(()=>{d(`Moved to ${H(a)}`,{type:"success"})},"onSuccess"),onError:t(()=>{d("Error: Could not move opportunity. Reverting.",{type:"warning"}),O(s)},"onError")})},[c,d]),A=z.useCallback(e=>{h&&(f(!0),P(h.opportunityId,h.targetStage,h.previousState,h.draggedItem,{win_reason:e.win_reason,loss_reason:e.loss_reason,close_reason_notes:e.close_reason_notes}),f(!1),m(!1),g(null))},[h,P]),T=z.useCallback(e=>{!e&&h&&(O(h.previousState),d("Stage change cancelled",{type:"info"})),m(e),e||g(null)},[h,d]),L=z.useCallback(e=>{s===e&&n&&n(),O(t=>{const a={...t};for(const s of Object.keys(a)){const t=a[s],n=t.filter(t=>t.id!==e);if(n.length!==t.length){a[s]=n;break}}return a}),u()},[u,s,n]),D=z.useCallback((e,t)=>{const a=e.source.droppableId,s=S[a]?.find(t=>t.id.toString()===e.draggableId);if(s){const e=H(a);t.announce(`Picked up ${s.name}. Currently in ${e} stage.`)}},[S]),E=z.useCallback((e,t)=>{if(e.destination){const a=H(e.destination.droppableId);t.announce(`Moving to ${a} stage, position ${e.destination.index+1}`)}},[]),V=t((e,t)=>{const{destination:a,source:s,draggableId:n}=e;if(!a)return void t.announce("Drag cancelled. Returned to original position.");if(a.droppableId===s.droppableId&&a.index===s.index)return void t.announce("Dropped in original position.");const r=s.droppableId,i=a.droppableId,o=S,l=o[r],c=o[i],d=l.find(e=>e.id.toString()===n);if(!d)return;const u={...o},p=Array.from(l);p.splice(s.index,1),u[r]=p;const h=r===i?p:Array.from(c);h.splice(a.index,0,{...d,stage:i}),u[i]=h,O(u);const x=H(i);if(t.announce(`Dropped in ${x} stage at position ${a.index+1}`),"closed_won"===i||"closed_lost"===i)return g({opportunityId:n,opportunityName:d.name,targetStage:i,sourceStage:r,previousState:o,draggedItem:d}),void m(!0);P(n,i,o,d)},"handleDragEnd");return o?null:a.jsxs("div",{className:"flex min-h-0 flex-1 flex-col h-full",children:[a.jsx(oa,{onDragStart:D,onDragUpdate:E,onDragEnd:V,children:a.jsxs("div",{className:"flex min-h-0 flex-1 gap-3 overflow-x-auto overflow-y-hidden p-3 bg-muted rounded-2xl border border-border shadow-inner","data-testid":"kanban-board","data-tutorial":"opp-kanban-board",role:"region","aria-label":"Opportunities pipeline board",children:[_.map(s=>a.jsx(Or,{stage:s.value,opportunities:S[s.value],isCollapsed:y.includes(s.value),onToggleCollapse:t(()=>v(s.value),"onToggleCollapse"),openSlideOver:e,onDeleteOpportunity:L},s.value)),a.jsx("div",{className:"flex items-start pt-1 shrink-0",children:a.jsx($r,{visibleStages:b,toggleVisibility:j,collapseAll:w,expandAll:C})})]})}),h&&a.jsx(vr,{open:p,onOpenChange:T,opportunityId:h.opportunityId,opportunityName:h.opportunityName,targetStage:h.targetStage,onConfirm:A,isSubmitting:x})]})},"OpportunityListContent"),Dr=t(()=>{const e=N();return{exportToCSV:z.useCallback((t,a)=>{if(t&&0!==t.length)try{const s=["Name","Customer Organization","â­ Principal Organization","Distributor Organization","Stage","Status","Priority","Estimated Close Date","Description","Campaign","Related Opportunity","Tags","Interactions","Last Interaction","Days in Stage","Created Date"],n=t.map(e=>[e.name||"",e.customer_organization_name||"",e.principal_organization_name||"",e.distributor_organization_name||"",H(e.stage)||"",e.status||"",e.priority||"",e.estimated_close_date&&Ne(e.estimated_close_date)?Qt(Ne(e.estimated_close_date),"yyyy-MM-dd"):"",e.description||"",e.campaign||"",e.related_opportunity_id?`ID: ${e.related_opportunity_id}`:"",e.tags?e.tags.join("; "):"",e.nb_interactions?.toString()||"0",e.last_interaction_date&&Ne(e.last_interaction_date)?Qt(Ne(e.last_interaction_date),"yyyy-MM-dd"):"",e.days_in_stage?.toString()||"",e.created_at&&Ne(e.created_at)?Qt(Ne(e.created_at),"yyyy-MM-dd"):""]),r=[s.join(","),...n.map(e=>e.map(e=>{const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t.replace(/"/g,'""')}"`:t}).join(","))].join("\n"),i=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),l=URL.createObjectURL(i);o.setAttribute("href",l);const c=`opportunities_export_${Qt(new Date,"yyyy-MM-dd")}.csv`;o.setAttribute("download",a||c),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),e(`Exported ${t.length} opportunit${1===t.length?"y":"ies"} to CSV`,{type:"success"})}catch(s){e("Failed to export opportunities",{type:"error"})}else e("No opportunities to export",{type:"warning"})},[e])}},"useExportOpportunities");function Er({selectedIds:e,opportunities:t,onUnselectItems:a,resource:s="opportunities"}){const[n,r]=z.useState(null),[i,o]=z.useState(""),[l,c]=z.useState(""),[d,u]=z.useState(""),[p,m]=z.useState(!1),h=N(),g=I(),x=j(),f=z.useCallback(e=>{r(e),o(""),c(""),u("")},[]),y=z.useCallback(()=>{r(null),o(""),c(""),u("")},[]),b=z.useCallback(async()=>{if(!n)return;m(!0);let r=0,o=0;try{let u={};"change_stage"===n&&i?u={stage:i,stage_manual:!0}:"change_status"===n&&l?u={status:l,status_manual:!0}:"assign_owner"===n&&d&&(u={opportunity_owner_id:parseInt(d)});for(const a of e)try{await x.update(s,{id:a,data:u,previousData:t.find(e=>e.id===a)}),r++}catch(c){o++}r>0&&h(`Successfully updated ${r} opportunit${1===r?"y":"ies"}`,{type:"success"}),o>0&&h(`Failed to update ${o} opportunit${1===o?"y":"ies"}`,{type:"error"}),g(),a(),y()}catch(u){h("Bulk action failed",{type:"error"})}finally{m(!1)}},[n,i,l,d,e,s,x,t,h,g,a,y]),v=z.useCallback(async()=>{m(!0);try{await x.deleteMany(s,{ids:e}),h(`Successfully archived ${e.length} opportunit${1===e.length?"y":"ies"}`,{type:"success"}),g(),a(),y()}catch(t){h(`Failed to archive opportunities: ${t instanceof Error?t.message:"Unknown error"}`,{type:"error"})}finally{m(!1)}},[e,s,x,h,g,a,y]),w=z.useCallback(()=>"change_stage"===n?!!i:"change_status"===n?!!l:"assign_owner"===n&&!!d,[n,i,l,d]);return{activeAction:n,setActiveAction:r,selectedStage:i,setSelectedStage:o,selectedStatus:l,setSelectedStatus:c,selectedOwner:d,setSelectedOwner:u,isProcessing:p,handleOpenDialog:f,handleCloseDialog:y,handleExecuteBulkAction:b,handleBulkArchive:v,canExecute:w}}t(Er,"useBulkActionsState");const zr=[{value:"active",label:"Active",icon:St,variant:"default"},{value:"on_hold",label:"On Hold",icon:Nt,variant:"secondary"},{value:"nurturing",label:"Nurturing",icon:Nt,variant:"secondary"},{value:"stalled",label:"Stalled",icon:it,variant:"outline"},{value:"expired",label:"Expired",icon:it,variant:"destructive"}],Vr=t(({selectedIds:e,opportunities:s,onUnselectItems:n})=>{const{activeAction:r,selectedStage:i,setSelectedStage:o,selectedStatus:l,setSelectedStatus:c,selectedOwner:d,setSelectedOwner:u,isProcessing:p,handleOpenDialog:m,handleCloseDialog:h,handleExecuteBulkAction:g,handleBulkArchive:x,canExecute:f}=Er({selectedIds:e,opportunities:s,onUnselectItems:n}),{exportToCSV:y}=Dr(),{data:b}=C("sales",{pagination:{page:1,perPage:100},sort:{field:"last_name",order:"ASC"}}),v=s.filter(t=>e.includes(t.id)),j=t(()=>{y(v)},"handleExport");return 0===e.length?null:a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 rounded-lg border border-border bg-muted/30 px-4 py-3",children:[a.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Bulk Actions:"}),a.jsxs(le,{variant:"outline",onClick:t(()=>m("change_stage"),"onClick"),className:"h-11 gap-2 touch-manipulation",children:[a.jsx(jt,{className:"h-4 w-4"}),"Change Stage"]}),a.jsxs(le,{variant:"outline",onClick:t(()=>m("change_status"),"onClick"),className:"h-11 gap-2 touch-manipulation",children:[a.jsx(Nt,{className:"h-4 w-4"}),"Change Status"]}),a.jsxs(le,{variant:"outline",onClick:t(()=>m("assign_owner"),"onClick"),className:"h-11 gap-2 touch-manipulation",children:[a.jsx(wt,{className:"h-4 w-4"}),"Assign Owner"]}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs(le,{variant:"default",onClick:j,className:"h-11 gap-2 touch-manipulation",children:[a.jsx(Ct,{className:"h-4 w-4"}),"Export CSV"]}),a.jsxs(le,{variant:"destructive",onClick:t(()=>m("archive"),"onClick"),className:"h-11 gap-2 touch-manipulation",children:[a.jsx(_t,{className:"h-4 w-4"}),"Archive Selected"]})]})]}),a.jsx(fe,{open:"change_stage"===r,onOpenChange:t(e=>!e&&h(),"onOpenChange"),children:a.jsxs(ye,{children:[a.jsxs(be,{children:[a.jsx(ve,{children:"Change Stage"}),a.jsxs(je,{children:["Update the stage for ",e.length," selected opportunit",1===e.length?"y":"ies"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"rounded-lg border border-border bg-muted/50 p-3 max-h-40 overflow-y-auto",children:[a.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Affected opportunities:"}),a.jsx("div",{className:"space-y-1",children:v.map(e=>a.jsxs("div",{className:"text-sm flex items-center justify-between",children:[a.jsx("span",{className:"truncate",children:e.name}),a.jsx(ze,{className:"ml-2 text-xs shrink-0",style:{backgroundColor:G(e.stage)},children:H(e.stage)})]},e.id))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"bulk-stage-select",className:"text-sm font-medium",children:"New Stage"}),a.jsxs(pe,{value:i,onValueChange:o,children:[a.jsx(me,{id:"bulk-stage-select",children:a.jsx(he,{placeholder:"Select a stage"})}),a.jsx(ge,{children:X.map(e=>a.jsx(xe,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsxs(ke,{children:[a.jsx(le,{variant:"outline",onClick:h,disabled:p,children:"Cancel"}),a.jsx(le,{onClick:g,disabled:!f()||p,children:p?"Updating...":"Update Stage"})]})]})}),a.jsx(fe,{open:"change_status"===r,onOpenChange:t(e=>!e&&h(),"onOpenChange"),children:a.jsxs(ye,{children:[a.jsxs(be,{children:[a.jsx(ve,{children:"Change Status"}),a.jsxs(je,{children:["Update the status for ",e.length," selected opportunit",1===e.length?"y":"ies"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"rounded-lg border border-border bg-muted/50 p-3 max-h-40 overflow-y-auto",children:[a.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Affected opportunities:"}),a.jsx("div",{className:"space-y-1",children:v.map(e=>a.jsxs("div",{className:"text-sm flex items-center justify-between",children:[a.jsx("span",{className:"truncate",children:e.name}),a.jsx(ze,{variant:"secondary",className:"ml-2 text-xs shrink-0",children:e.status})]},e.id))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"bulk-status-select",className:"text-sm font-medium",children:"New Status"}),a.jsxs(pe,{value:l,onValueChange:c,children:[a.jsx(me,{id:"bulk-status-select",children:a.jsx(he,{placeholder:"Select a status"})}),a.jsx(ge,{children:zr.map(e=>a.jsx(xe,{value:e.value,children:e.label},e.value))})]})]})]}),a.jsxs(ke,{children:[a.jsx(le,{variant:"outline",onClick:h,disabled:p,children:"Cancel"}),a.jsx(le,{onClick:g,disabled:!f()||p,children:p?"Updating...":"Update Status"})]})]})}),a.jsx(fe,{open:"assign_owner"===r,onOpenChange:t(e=>!e&&h(),"onOpenChange"),children:a.jsxs(ye,{children:[a.jsxs(be,{children:[a.jsx(ve,{children:"Assign Owner"}),a.jsxs(je,{children:["Assign an owner to ",e.length," selected opportunit",1===e.length?"y":"ies"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"rounded-lg border border-border bg-muted/50 p-3 max-h-40 overflow-y-auto",children:[a.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Affected opportunities:"}),a.jsx("div",{className:"space-y-1",children:v.map(e=>a.jsx("div",{className:"text-sm",children:e.name},e.id))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"bulk-owner-select",className:"text-sm font-medium",children:"New Owner"}),a.jsxs(pe,{value:d,onValueChange:u,children:[a.jsx(me,{id:"bulk-owner-select",children:a.jsx(he,{placeholder:"Select an owner"})}),a.jsx(ge,{children:b?.map(e=>a.jsxs(xe,{value:String(e.id),children:[e.first_name," ",e.last_name]},e.id))})]})]})]}),a.jsxs(ke,{children:[a.jsx(le,{variant:"outline",onClick:h,disabled:p,children:"Cancel"}),a.jsx(le,{onClick:g,disabled:!f()||p,children:p?"Assigning...":"Assign Owner"})]})]})}),a.jsx(fe,{open:"archive"===r,onOpenChange:t(e=>!e&&h(),"onOpenChange"),children:a.jsxs(ye,{children:[a.jsxs(be,{children:[a.jsxs(ve,{className:"flex items-center gap-2 text-destructive",children:[a.jsx(kt,{className:"h-5 w-5"}),"Archive Opportunities"]}),a.jsxs(je,{children:["Are you sure you want to archive ",e.length," opportunit",1===e.length?"y":"ies","? Archived opportunities can be restored later."]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"rounded-lg border border-destructive/30 bg-destructive/10 p-3",children:a.jsxs("p",{className:"text-sm text-destructive",children:[a.jsx("strong",{children:"Note:"})," Archived opportunities will be hidden from the main list but remain in the database. You can view and restore them from the archived view."]})}),a.jsxs("div",{className:"rounded-lg border border-border bg-muted/50 p-3 max-h-40 overflow-y-auto",children:[a.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Opportunities to archive:"}),a.jsx("div",{className:"space-y-1",children:v.map(e=>a.jsxs("div",{className:"text-sm flex items-center justify-between",children:[a.jsx("span",{className:"truncate",children:e.name}),a.jsx(ze,{className:"ml-2 text-xs shrink-0",style:{backgroundColor:G(e.stage)},children:H(e.stage)})]},e.id))})]})]}),a.jsxs(ke,{children:[a.jsx(le,{variant:"outline",onClick:h,disabled:p,children:"Cancel"}),a.jsx(le,{variant:"destructive",onClick:x,disabled:p,children:p?"Archiving...":`Archive ${e.length} Opportunit${1===e.length?"y":"ies"}`})]})]})})]})},"BulkActionsToolbar"),Rr=t(({openSlideOver:e,isSlideOverOpen:s})=>{const{data:n,error:r,isPending:i,onToggleItem:o,selectedIds:l,onSelect:c,onUnselectItems:d}=$(),{focusedIndex:u}=ee({onSelect:t(t=>e(Number(t),"view"),"onSelect"),enabled:!s});if(i)return a.jsx(Ve,{className:"w-full h-9"});if(r)return a.jsx(Re,{className:"bg-card border border-border shadow-sm rounded-xl p-4",children:a.jsx("p",{className:"text-center text-destructive",children:"Error loading opportunities. Please try refreshing the page."})});if(!n||0===n.length)return a.jsx(Re,{className:"bg-card border border-border shadow-sm rounded-xl p-4",children:a.jsx("p",{className:"text-center text-muted-foreground",children:"No opportunities to display"})});const p=l.length===n.length&&n.length>0,m=l.length>0&&l.length<n.length,h=t(()=>{p?d():c(n.map(e=>e.id))},"handleSelectAll");return a.jsxs(a.Fragment,{children:[l.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-border bg-muted/50 px-4 py-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ca,{checked:p,indeterminate:m,onCheckedChange:h,"aria-label":"Select all opportunities"}),a.jsxs("span",{className:"text-sm font-medium",children:[l.length," opportunit",1===l.length?"y":"ies"," selected"]})]}),a.jsxs(le,{variant:"ghost",onClick:d,className:"h-11 gap-1.5 touch-manipulation",children:[a.jsx(Ot,{className:"h-4 w-4"}),"Clear selection"]})]}),a.jsx(Vr,{selectedIds:l,opportunities:n,onUnselectItems:d})]}),a.jsx(Re,{className:"bg-card border border-border shadow-sm rounded-xl p-2",children:a.jsx("div",{className:"space-y-2",children:n.map((s,n)=>a.jsx(T,{value:s,children:a.jsxs("div",{className:"group relative flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 rounded-lg border bg-card px-3 py-2 sm:py-1.5 transition-all duration-150 hover:border-border hover:shadow-md motion-safe:hover:-translate-y-0.5 active:scale-[0.98] focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 "+(u===n?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"),children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1 w-full sm:w-auto",children:[a.jsx(ca,{checked:l.includes(s.id),onCheckedChange:t(()=>o(s.id),"onCheckedChange"),"aria-label":`Select ${s.name}`,className:"relative z-10 shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("button",{onClick:t(t=>{t.preventDefault(),t.stopPropagation(),e(s.id,"view")},"onClick"),className:"font-medium text-sm text-primary hover:underline focus:outline-none block truncate text-left w-full",children:[s.name,a.jsx("span",{className:"absolute inset-0","aria-hidden":"true"})]}),a.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1 flex-wrap mt-0.5",children:[s.customer_organization_id&&a.jsxs(a.Fragment,{children:[a.jsx(Ma,{source:"customer_organization_id",reference:"organizations",link:!1,children:a.jsx(Me,{source:"name",className:"font-medium"})}),a.jsx("span",{className:"opacity-60",children:"â†’"})]}),s.principal_organization_id&&a.jsx(Ma,{source:"principal_organization_id",reference:"organizations",link:"show",children:a.jsxs("div",{className:"flex items-center gap-1 relative z-10",children:[a.jsx(It,{className:"size-3 text-primary/80"}),a.jsx(Me,{source:"name",className:"font-bold text-primary hover:underline cursor-pointer"})]})}),void 0!==s.nb_interactions&&s.nb_interactions>0&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"opacity-50 mx-0.5",children:"Â·"}),a.jsxs("span",{className:"font-medium",children:[s.nb_interactions," interaction",1!==s.nb_interactions?"s":""]})]}),s.last_interaction_date&&Ne(s.last_interaction_date)&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"opacity-50 mx-0.5",children:"Â·"}),a.jsxs("span",{className:"opacity-75",children:["Last"," ",Xt(Ne(s.last_interaction_date),new Date,{addSuffix:!0})]})]})]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 shrink-0 w-full sm:w-auto justify-start sm:justify-end",children:[a.jsx(ze,{className:"border-0 text-xs relative z-10",style:{backgroundColor:G(s.stage)},children:H(s.stage)}),s.priority&&a.jsx(ze,{variant:"critical"===s.priority?"destructive":"high"===s.priority?"default":"medium"===s.priority?"secondary":"outline",className:"hidden md:inline-flex text-xs relative z-10",children:s.priority}),s.estimated_close_date&&Ne(s.estimated_close_date)&&a.jsxs("div",{className:"hidden sm:block text-xs text-muted-foreground relative z-10",children:[a.jsx("span",{className:"opacity-75",children:"Close:"})," ",a.jsx("span",{className:"font-medium",children:Qt(Ne(s.estimated_close_date),"MMM d, yyyy")})]}),s.opportunity_owner_id&&a.jsx("div",{className:"hidden md:block text-xs text-muted-foreground relative z-10",children:a.jsx(Ma,{source:"opportunity_owner_id",reference:"sales",link:!1,children:a.jsxs("span",{children:[a.jsx(Me,{source:"first_name"})," ",a.jsx(Me,{source:"last_name"})]})})}),a.jsx("div",{className:"relative z-10",children:a.jsx(Fa,{resource:"opportunities"})})]})]})},s.id))})})]})},"OpportunityRowListView"),Mr=t(({openSlideOver:e})=>{const{data:s,isPending:n}=$(),r=z.useMemo(()=>{if(!s)return{};const e={};return s.forEach(t=>{if(!t.campaign)return;e[t.campaign]||(e[t.campaign]={});const a=t.principal_organization_name||"Unknown Principal";e[t.campaign][a]||(e[t.campaign][a]={});const s=t.customer_organization_name||"Unknown Customer";e[t.campaign][a][s]||(e[t.campaign][a][s]=[]),e[t.campaign][a][s].push(t)}),e},[s]),i=Object.keys(r).sort();return n?a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx("div",{className:"text-muted-foreground",children:"Loading campaigns..."})}):0===i.length?a.jsx(Re,{className:"p-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Pt,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No campaigns found"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Add a campaign name to opportunities to see them grouped here."})]})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Pt,{className:"w-5 h-5 text-muted-foreground"}),a.jsxs("h2",{className:"text-lg font-semibold",children:["Campaigns (",i.length,")"]})]}),a.jsx(Xn,{type:"multiple",className:"space-y-2",children:i.map(s=>{const n=r[s],i=Object.keys(n).sort(),o=i.reduce((e,t)=>{const a=n[t];return e+Object.values(a).reduce((e,t)=>e+t.length,0)},0);return a.jsxs(Zn,{value:s,className:"border border-border rounded-lg bg-card",children:[a.jsx(Yn,{className:"px-4 hover:no-underline hover:bg-muted/50",children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{className:"flex flex-col items-start",children:[a.jsx("span",{className:"font-semibold text-base",children:s}),a.jsxs("span",{className:"text-xs text-muted-foreground",children:[o," ",1===o?"opportunity":"opportunities"," across"," ",i.length," ",1===i.length?"principal":"principals"]})]})})}),a.jsx(er,{className:"px-4 pb-4",children:a.jsx(Xn,{type:"multiple",className:"space-y-2 mt-2",children:i.map(s=>{const r=n[s],i=Object.keys(r).sort(),o=i.reduce((e,t)=>e+r[t].length,0);return a.jsxs(Zn,{value:s,className:"border border-border rounded-md bg-muted/50",children:[a.jsx(Yn,{className:"px-3 py-2 hover:no-underline hover:bg-muted/70",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(At,{className:"w-4 h-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium text-sm",children:s}),a.jsxs("span",{className:"text-xs text-muted-foreground ml-auto mr-2",children:[o," ",1===o?"opportunity":"opportunities"," across"," ",i.length," ",1===i.length?"customer":"customers"]})]})}),a.jsx(er,{className:"px-3 pb-2",children:a.jsx(Xn,{type:"multiple",className:"space-y-1 mt-1",children:i.map(s=>{const n=r[s];return a.jsxs(Zn,{value:s,className:"border border-border rounded-md bg-muted/30",children:[a.jsx(Yn,{className:"px-3 py-2 hover:no-underline hover:bg-muted/50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(It,{className:"w-4 h-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium text-sm",children:s}),a.jsx(ze,{variant:"secondary",className:"text-xs",children:n.length})]})}),a.jsx(er,{className:"px-3 pb-2",children:a.jsx("div",{className:"space-y-1 mt-1",children:n.map(s=>a.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-muted/50 transition-colors cursor-pointer",role:"button",tabIndex:0,onClick:t(t=>{t.preventDefault(),t.stopPropagation(),e(s.id,"view")},"onClick"),onKeyDown:t(t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e(s.id,"view"))},"onKeyDown"),children:[a.jsxs("div",{className:"flex-1 text-sm text-primary hover:underline flex items-center gap-2",children:[s.name,a.jsx(Tt,{className:"w-3 h-3"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ze,{variant:"closed_won"===s.stage?"default":"closed_lost"===s.stage?"destructive":"secondary",className:"text-xs",children:s.stage?.replace(/_/g," ")}),s.priority&&a.jsx(ze,{variant:"critical"===s.priority?"destructive":"high"===s.priority?"default":"outline",className:"high"===s.priority?"border-transparent bg-warning text-warning-foreground":"text-xs",children:s.priority})]})]},s.id))})})]},s)})})})]},s)})})})]},s)})})]})},"CampaignGroupedList");var Fr="Toggle",Wr=z.forwardRef((e,t)=>{const{pressed:s,defaultPressed:n,onPressedChange:r,...i}=e,[o,l]=Ka({prop:s,onChange:r,defaultProp:n??!1,caller:Fr});return a.jsx(Ga.button,{type:"button","aria-pressed":o,"data-state":o?"on":"off","data-disabled":e.disabled?"":void 0,...i,ref:t,onClick:Qa(e.onClick,()=>{e.disabled||l(!o)})})});Wr.displayName=Fr;var Br="ToggleGroup",[qr]=Ja(Br,[Xa]),Ur=Xa(),Hr=V.forwardRef((e,t)=>{const{type:s,...n}=e;if("single"===s){const e=n;return a.jsx(Qr,{...e,ref:t})}if("multiple"===s){const e=n;return a.jsx(Jr,{...e,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${Br}\``)});Hr.displayName=Br;var[Kr,Gr]=qr(Br),Qr=V.forwardRef((e,s)=>{const{value:n,defaultValue:r,onValueChange:i=t(()=>{},"onValueChange"),...o}=e,[l,c]=Ka({prop:n,defaultProp:r??"",onChange:i,caller:Br});return a.jsx(Kr,{scope:e.__scopeToggleGroup,type:"single",value:V.useMemo(()=>l?[l]:[],[l]),onItemActivate:c,onItemDeactivate:V.useCallback(()=>c(""),[c]),children:a.jsx(Yr,{...o,ref:s})})}),Jr=V.forwardRef((e,s)=>{const{value:n,defaultValue:r,onValueChange:i=t(()=>{},"onValueChange"),...o}=e,[l,c]=Ka({prop:n,defaultProp:r??[],onChange:i,caller:Br}),d=V.useCallback(e=>c((t=[])=>[...t,e]),[c]),u=V.useCallback(e=>c((t=[])=>t.filter(t=>t!==e)),[c]);return a.jsx(Kr,{scope:e.__scopeToggleGroup,type:"multiple",value:l,onItemActivate:d,onItemDeactivate:u,children:a.jsx(Yr,{...o,ref:s})})});Hr.displayName=Br;var[Xr,Zr]=qr(Br),Yr=V.forwardRef((e,t)=>{const{__scopeToggleGroup:s,disabled:n=!1,rovingFocus:r=!0,orientation:i,dir:o,loop:l=!0,...c}=e,d=Ur(s),u=Ya(o),p={role:"group",dir:u,...c};return a.jsx(Xr,{scope:s,rovingFocus:r,disabled:n,children:r?a.jsx(es,{asChild:!0,...d,orientation:i,dir:u,loop:l,children:a.jsx(Ga.div,{...p,ref:t})}):a.jsx(Ga.div,{...p,ref:t})})}),ei="ToggleGroupItem",ti=V.forwardRef((e,t)=>{const s=Gr(ei,e.__scopeToggleGroup),n=Zr(ei,e.__scopeToggleGroup),r=Ur(e.__scopeToggleGroup),i=s.value.includes(e.value),o=n.disabled||e.disabled,l={...e,pressed:i,disabled:o},c=V.useRef(null);return n.rovingFocus?a.jsx(Za,{asChild:!0,...r,focusable:!o,active:i,ref:c,children:a.jsx(ai,{...l,ref:t})}):a.jsx(ai,{...l,ref:t})});ti.displayName=ei;var ai=V.forwardRef((e,s)=>{const{__scopeToggleGroup:n,value:r,...i}=e,o=Gr(ei,n),l={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},c="single"===o.type?l:void 0;return a.jsx(Wr,{...c,...i,ref:s,onPressedChange:t(e=>{e?o.onItemActivate(r):o.onItemDeactivate(r)},"onPressedChange")})}),si=Hr,ni=ti;const ri=Zt("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-11 px-3",sm:"h-11 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),ii=z.createContext({size:"default",variant:"default"}),oi=z.forwardRef(({className:e,variant:t,size:s,children:n,...r},i)=>a.jsx(si,{ref:i,className:oe("flex items-center justify-center gap-1",e),...r,children:a.jsx(ii.Provider,{value:{variant:t,size:s},children:n})}));oi.displayName=si.displayName;const li=z.forwardRef(({className:e,children:t,variant:s,size:n,...r},i)=>{const o=z.useContext(ii);return a.jsx(ni,{ref:i,className:oe(ri({variant:o.variant||s,size:o.size||n}),e),...r,children:t})});li.displayName=ni.displayName;const ci=t(({view:e,onViewChange:s})=>a.jsx(Fe,{children:a.jsxs(oi,{type:"single",value:e,onValueChange:t(e=>e&&s(e),"onValueChange"),className:"gap-0.5",children:[a.jsxs(Le,{children:[a.jsx(De,{asChild:!0,children:a.jsx(li,{value:"kanban","aria-label":"Kanban view",className:"h-11 w-11 sm:h-11 sm:w-11 touch-manipulation",children:a.jsx($t,{className:"h-4 w-4"})})}),a.jsx(Ee,{children:a.jsx("p",{children:"Kanban View"})})]}),a.jsxs(Le,{children:[a.jsx(De,{asChild:!0,children:a.jsx(li,{value:"list","aria-label":"List view",className:"h-11 w-11 sm:h-11 sm:w-11 touch-manipulation",children:a.jsx(Lt,{className:"h-4 w-4"})})}),a.jsx(Ee,{children:a.jsx("p",{children:"List View"})})]}),a.jsxs(Le,{children:[a.jsx(De,{asChild:!0,children:a.jsx(li,{value:"campaign","aria-label":"Campaign grouped view",className:"h-11 w-11 sm:h-11 sm:w-11 touch-manipulation",children:a.jsx(Pt,{className:"h-4 w-4"})})}),a.jsx(Ee,{children:a.jsx("p",{children:"Campaign View"})})]})]})}),"OpportunityViewSwitcher"),di=[{id:"referral",name:"Referral"},{id:"trade_show",name:"Trade Show"},{id:"website",name:"Website"},{id:"cold_call",name:"Cold Call"},{id:"email_campaign",name:"Email Campaign"},{id:"social_media",name:"Social Media"},{id:"partner",name:"Partner"},{id:"existing_customer",name:"Existing Customer"}],ui=t(()=>a.jsx(la,{source:"lead_source",label:"Lead Source",choices:di,helperText:!1}),"LeadSourceInput");function pi({record:e,mode:s,onModeToggle:n,isActiveTab:r}){const[i]=k(),o=N(),[l,c]=z.useState(!1),[d,u]=z.useState(!1),[p,m]=z.useState("closed_won"),h=z.useRef(null),g=z.useCallback(async(a,s)=>{c(!0);try{await i("opportunities",{id:e.id,data:{...a,...s},previousData:e},{onSuccess:t(()=>{o("Opportunity updated successfully",{type:"success"}),n&&n()},"onSuccess"),onError:t(e=>{o(e?.message||"Failed to update opportunity",{type:"error"})},"onError")})}finally{c(!1)}},[i,e,o,n]),x=z.useCallback(async t=>{if(("closed_won"===t.stage||"closed_lost"===t.stage)&&e.stage!==t.stage)return h.current=t,m(t.stage),void u(!0);await g(t)},[e.stage,g]),f=z.useCallback(async e=>{u(!1),h.current&&(await g(h.current,{win_reason:e.win_reason,loss_reason:e.loss_reason,close_reason_notes:e.close_reason_notes}),h.current=null)},[g]),y=z.useCallback(e=>{u(e),e||(h.current=null)},[]);if("edit"===s)return a.jsxs(L,{id:"slide-over-edit-form",defaultValues:e,onSubmit:x,className:"space-y-2",children:[a.jsx(Se,{source:"name",label:"Opportunity Name",helperText:!1,fullWidth:!0}),a.jsx(Se,{source:"description",label:"Description",helperText:!1,multiline:!0,rows:3,fullWidth:!0}),a.jsx(la,{source:"stage",label:"Stage",choices:Y,helperText:!1,fullWidth:!0}),a.jsx(la,{source:"priority",label:"Priority",choices:[{id:"low",name:"Low"},{id:"medium",name:"Medium"},{id:"high",name:"High"},{id:"critical",name:"Critical"}],helperText:!1,fullWidth:!0}),a.jsx(ui,{}),a.jsx(Se,{source:"estimated_close_date",label:"Estimated Close Date",type:"date",helperText:!1,fullWidth:!0}),a.jsx(Se,{source:"campaign",label:"Campaign",helperText:!1,fullWidth:!0}),a.jsx(Se,{source:"notes",label:"Notes",multiline:!0,rows:2,helperText:!1,fullWidth:!0}),a.jsx(Se,{source:"next_action",label:"Next Action",helperText:!1,fullWidth:!0}),a.jsx(Se,{source:"next_action_date",label:"Next Action Date",type:"date",helperText:!1,fullWidth:!0}),a.jsx(Se,{source:"decision_criteria",label:"Decision Criteria",multiline:!0,rows:2,helperText:!1,fullWidth:!0}),a.jsxs("div",{className:"pt-2 border-t border-border",children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide block mb-2",children:"Organizations"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Gn,{source:"customer_organization_id",reference:"organizations",children:a.jsx(ss,{label:"Customer Organization *",optionText:"name",filterToQuery:t(e=>({q:e}),"filterToQuery"),helperText:"The customer organization for this opportunity",fullWidth:!0})}),a.jsx(Gn,{source:"principal_organization_id",reference:"organizations",children:a.jsx(ss,{label:"Principal Organization *",optionText:"name",filterToQuery:t(e=>({q:e}),"filterToQuery"),helperText:"The principal/manufacturer organization",fullWidth:!0})}),a.jsx(Gn,{source:"distributor_organization_id",reference:"organizations",children:a.jsx(ss,{label:"Distributor Organization",optionText:"name",filterToQuery:t(e=>({q:e}),"filterToQuery"),helperText:"Optional distributor organization",fullWidth:!0})})]})]}),a.jsx(vr,{open:d,onOpenChange:y,opportunityId:e.id,opportunityName:e.name||"Opportunity",targetStage:p,onConfirm:f,isSubmitting:l})]});const b=t(e=>{if(!e)return"Not set";const t=Ne(e);return t?Qt(t,"MMM d, yyyy"):"Invalid date"},"formatDate"),v=t(e=>"closed_won"===e?"default":"closed_lost"===e?"destructive":"secondary","getStageBadgeVariant"),j=t(e=>"critical"===e?"destructive":"high"===e?"default":"medium"===e?"secondary":"outline","getPriorityBadgeVariant"),w=t(({organizationId:e,label:t,required:s=!1})=>{const{data:n,isLoading:i}=D("organizations",{id:e},{enabled:r&&!!e});return e||s?i?a.jsxs("div",{className:"border border-border rounded-md p-2",children:[a.jsx("label",{className:"text-xs font-medium text-muted-foreground block mb-1",children:t}),a.jsx("div",{className:"h-4 bg-muted animate-pulse rounded"})]}):n?a.jsxs("div",{className:"border border-border rounded-md p-2 hover:bg-muted/50 transition-colors",children:[a.jsx("label",{className:"text-xs font-medium text-muted-foreground block mb-1",children:t}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-6 h-6 rounded bg-primary/10 flex items-center justify-center shrink-0",children:a.jsx(It,{className:"w-3.5 h-3.5 text-primary"})}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx(R,{to:`/organizations?view=${n.id}`,className:"text-sm font-medium hover:underline block truncate",children:n.name})})]})]}):a.jsxs("div",{className:"border border-border rounded-md p-2",children:[a.jsx("label",{className:"text-xs font-medium text-muted-foreground block mb-1",children:t}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Not set"})]}):null},"OrganizationCard"),C=Y.find(t=>t.id===e.stage)?.name||e.stage,_=t((e,t)=>{if(!e)return null;const a=t?Ce:_e;return a.find(t=>t.id===e)?.name||e},"getReasonDisplayName"),S="closed_won"===e.stage||"closed_lost"===e.stage,O="closed_won"===e.stage?_(e.win_reason,!0):"closed_lost"===e.stage?_(e.loss_reason,!1):null;return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Name"}),a.jsx("p",{className:"text-sm",children:e.name||"N/A"})]}),e.description&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Description"}),a.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.description})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Stage"}),a.jsx("div",{children:a.jsx(ze,{variant:v(e.stage||""),children:C})})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Priority"}),a.jsx("div",{children:a.jsx(ze,{variant:j(e.priority||"low"),children:e.priority?e.priority.charAt(0).toUpperCase()+e.priority.slice(1):"Low"})})]})]}),S&&O&&a.jsxs("div",{className:"rounded-lg p-3 "+("closed_won"===e.stage?"bg-success/10 border border-success/20":"bg-destructive/10 border border-destructive/20"),children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:["closed_won"===e.stage?a.jsx(rt,{className:"h-4 w-4 text-success"}):a.jsx(it,{className:"h-4 w-4 text-destructive"}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide "+("closed_won"===e.stage?"text-success":"text-destructive"),children:"closed_won"===e.stage?"Won Reason":"Lost Reason"})]}),a.jsx("p",{className:"text-sm font-medium",children:O}),e.close_reason_notes&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.close_reason_notes})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Lead Source"}),a.jsx("p",{className:"text-sm",children:e.lead_source?e.lead_source.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"â€”"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Est. Close"}),a.jsx("p",{className:"text-sm",children:b(e.estimated_close_date)})]})]}),e.campaign&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Campaign"}),a.jsx("p",{className:"text-sm",children:e.campaign})]}),e.notes&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Notes"}),a.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.notes})]}),(e.next_action||e.next_action_date)&&a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Next Action"}),a.jsx("p",{className:"text-sm",children:e.next_action||"â€”"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Action Date"}),a.jsx("p",{className:"text-sm",children:b(e.next_action_date)})]})]}),e.decision_criteria&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Decision Criteria"}),a.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.decision_criteria})]}),a.jsxs("div",{className:"pt-2 border-t border-border",children:[a.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide block mb-1.5",children:"Organizations"}),a.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[a.jsx(w,{organizationId:e.customer_organization_id,label:"Customer",required:!0}),a.jsx(w,{organizationId:e.principal_organization_id,label:"Principal",required:!0}),a.jsx(w,{organizationId:e.distributor_organization_id,label:"Distributor"})]})]}),a.jsxs("div",{className:"pt-2 border-t border-border flex gap-3 text-xs text-muted-foreground",children:[a.jsxs("span",{children:["Created ",b(e.created_at)]}),a.jsx("span",{children:"â€¢"}),a.jsxs("span",{children:["Updated ",b(e.updated_at)]})]})]})}function mi({record:e,mode:s,onModeToggle:n,isActiveTab:r}){const[i]=k(),o=N(),[l,c]=z.useState(!1),{data:d,isLoading:u}=C("opportunity_contacts",{filter:{opportunity_id:e.id},pagination:{page:1,perPage:100},sort:{field:"is_primary",order:"DESC"}},{enabled:r&&"view"===s}),p=d?.map(e=>e.contact_id)||[],{data:m}=C("contacts",{filter:{id:p},pagination:{page:1,perPage:100}},{enabled:r&&"view"===s&&p.length>0}),h=t(async a=>{c(!0);try{await i("opportunities",{id:e.id,data:{contact_ids:a.contact_ids||[]},previousData:e},{onSuccess:t(()=>{o("Contacts updated successfully",{type:"success"}),n&&n()},"onSuccess"),onError:t(e=>{o(e?.message||"Failed to update contacts",{type:"error"})},"onError")})}finally{c(!1)}},"handleSave"),g=t(()=>{n&&n()},"handleCancel");if("edit"===s)return a.jsxs(L,{defaultValues:{contact_ids:e.contact_ids||[]},onSubmit:h,className:"space-y-4",children:[a.jsx(Bn,{source:"contact_ids",reference:"contacts",children:a.jsx(As,{label:"Contacts",optionText:t(e=>e?`${e.firstName||""} ${e.lastName||""}`.trim():"","optionText"),filterToQuery:t(e=>({q:e}),"filterToQuery"),helperText:"Search and select contacts associated with this opportunity"})}),a.jsxs("div",{className:"flex gap-2 pt-4",children:[a.jsx(le,{type:"submit",disabled:l,className:"flex-1",children:l?"Saving...":"Save Changes"}),a.jsx(le,{type:"button",variant:"outline",onClick:g,disabled:l,children:"Cancel"})]})]});if(u)return a.jsx("div",{className:"space-y-3",children:[1,2,3].map(e=>a.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},e))});if(!d||0===d.length)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx(ht,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground"}),a.jsx("p",{className:"text-muted-foreground",children:"No contacts associated with this opportunity"})]});const x=new Map(d.map(e=>[e.contact_id,e]));return a.jsx("div",{className:"space-y-3",children:m?.map(e=>{const t=x.get(e.id);return a.jsx("div",{className:"border border-border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:a.jsx(ht,{className:"w-5 h-5 text-primary"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs(R,{to:`/contacts?view=${e.id}`,className:"text-base font-medium hover:underline",children:[e.firstName," ",e.lastName]}),e.title&&a.jsx("p",{className:"text-sm text-muted-foreground",children:e.title}),t?.role&&a.jsx("div",{className:"mt-2",children:a.jsx(ze,{variant:"outline",className:"text-xs",children:t.role})}),t?.notes&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 italic",children:t.notes})]})]}),t?.is_primary&&a.jsxs(ze,{variant:"default",className:"ml-2",children:[a.jsx(Dt,{className:"w-3 h-3 mr-1"}),"Primary"]})]})},e.id)})})}function hi({record:e,mode:s,onModeToggle:n,isActiveTab:r}){const[i]=k(),o=N(),[l,c]=z.useState(!1),{data:d,isLoading:u}=C("opportunity_products",{filter:{opportunity_id:e.id},pagination:{page:1,perPage:100},sort:{field:"created_at",order:"DESC"}},{enabled:r&&"view"===s}),p=d?.map(e=>e.product_id_reference)||[],{data:m}=C("products",{filter:{id:p},pagination:{page:1,perPage:100}},{enabled:r&&"view"===s&&p.length>0}),h=t(async a=>{c(!0);try{const s=(a.product_ids||[]).map(e=>({product_id_reference:e,notes:null}));await i("opportunities",{id:e.id,data:{products_to_sync:s},previousData:e},{onSuccess:t(()=>{o("Products updated successfully",{type:"success"}),n&&n()},"onSuccess"),onError:t(e=>{o(e?.message||"Failed to update products",{type:"error"})},"onError")})}finally{c(!1)}},"handleSave"),g=t(()=>{n&&n()},"handleCancel");if("edit"===s){const e=p;return a.jsxs(L,{defaultValues:{product_ids:e},onSubmit:h,className:"space-y-4",children:[a.jsx(Bn,{source:"product_ids",reference:"products",children:a.jsx(As,{label:"Products",optionText:"name",filterToQuery:t(e=>({q:e}),"filterToQuery"),helperText:"Search and select products for this opportunity"})}),a.jsxs("div",{className:"flex gap-2 pt-4",children:[a.jsx(le,{type:"submit",disabled:l,className:"flex-1",children:l?"Saving...":"Save Changes"}),a.jsx(le,{type:"button",variant:"outline",onClick:g,disabled:l,children:"Cancel"})]})]})}if(u)return a.jsx("div",{className:"space-y-3",children:[1,2,3].map(e=>a.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},e))});if(!d||0===d.length)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx(yt,{className:"w-12 h-12 mx-auto mb-3 text-muted-foreground"}),a.jsx("p",{className:"text-muted-foreground",children:"No products associated with this opportunity"})]});const x=new Map(d.map(e=>[e.product_id_reference,e]));return a.jsx("div",{className:"space-y-3",children:m?.map(e=>{const t=x.get(e.id);return a.jsx("div",{className:"border border-border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center shrink-0",children:a.jsx(yt,{className:"w-5 h-5 text-primary"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx(R,{to:`/products?view=${e.id}`,className:"text-base font-medium hover:underline block",children:e.name}),e.category&&a.jsx("div",{className:"mt-2",children:a.jsx(ze,{variant:"outline",className:"text-xs",children:e.category})}),t?.notes&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 italic",children:t.notes})]})]})},e.id)})})}function gi({record:e,mode:t}){return a.jsx(T,{value:e,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx(Ts,{target:"opportunity_id",reference:"opportunityNotes",sort:{field:"created_at",order:"DESC"},children:a.jsx($s,{reference:"opportunities"})}),a.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"view"===t?"Notes are visible to all team members":"Add notes to track important information about this opportunity"})]})})}function xi({recordId:e,isOpen:s,onClose:n,mode:r,onModeToggle:i}){const o=[{key:"details",label:"Details",component:pi,icon:Et},{key:"contacts",label:"Contacts",component:mi,icon:zt},{key:"products",label:"Products",component:hi,icon:yt},{key:"notes",label:"Notes",component:gi,icon:Vt}],l=t(e=>e.name||`Opportunity #${e.id}`,"recordRepresentation");return a.jsx(ts,{resource:"opportunities",recordId:e,isOpen:s,onClose:n,mode:r,onModeToggle:i,tabs:o,recordRepresentation:l})}t(pi,"OpportunitySlideOverDetailsTab"),t(mi,"OpportunityContactsTab"),t(hi,"OpportunityProductsTab"),t(gi,"OpportunityNotesTab"),t(xi,"OpportunitySlideOver");const fi=t(()=>{const{data:e}=_(),{filterValues:s,setFilters:n}=$(),{data:r}=C("organizations",{pagination:{page:1,perPage:50},sort:{field:"name",order:"ASC"},filter:{organization_type:"principal",deleted_at:null}}),{data:i}=C("organizations",{pagination:{page:1,perPage:50},sort:{field:"name",order:"ASC"},filter:{"organization_type@in":"(prospect,customer)",deleted_at:null}}),o=t(e=>{if("all"===e){const{principal_organization_id:e,...t}=s||{};n(t)}else n({...s,principal_organization_id:Number(e)})},"handlePrincipalChange"),l=t(e=>{if("all"===e){const{customer_organization_id:e,...t}=s||{};n(t)}else n({...s,customer_organization_id:Number(e)})},"handleCustomerChange"),c=t(e=>{if("all"===e){const{campaign:e,...t}=s||{};n(t)}else n({...s,campaign:e})},"handleCampaignChange"),d=s?.principal_organization_id?String(s.principal_organization_id):"all",u=s?.customer_organization_id?String(s.customer_organization_id):"all",p=s?.campaign||"all",{data:m}=C("opportunities",{pagination:{page:1,perPage:1e3}}),h=z.useMemo(()=>{if(!m)return[];const e=new Set;return m.forEach(t=>{t.campaign&&e.add(t.campaign)}),Array.from(e).sort()},[m]),g=new Date,x=Yt(g,30),f=t(e=>{n({...s,...e})},"handlePresetClick"),y=t(e=>Object.entries(e).every(([e,t])=>{const a=s?.[e];return Array.isArray(t)&&Array.isArray(a)?t.every(e=>a.includes(e)):a===t}),"isPresetActive");return a.jsxs("div",{className:"flex flex-col gap-4","data-tutorial":"opp-filters",children:[a.jsx(E,{children:a.jsx(W,{source:"q",placeholder:"Search opportunities..."})}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs(Va,{label:"Quick Filters",icon:a.jsx(Mt,{className:"h-4 w-4"}),defaultExpanded:!0,"data-tutorial":"opp-quick-filters",children:[a.jsxs(le,{type:"button",variant:y({opportunity_owner_id:e?.id})?"default":"outline",size:"sm",onClick:t(()=>f({opportunity_owner_id:e?.id}),"onClick"),className:"w-full justify-start",title:"Opportunities I manage",children:[a.jsx(ht,{className:"w-3.5 h-3.5 mr-2"}),"My Opportunities"]}),a.jsxs(le,{type:"button",variant:y({estimated_close_date_gte:g.toISOString().split("T")[0],estimated_close_date_lte:x.toISOString().split("T")[0]})?"default":"outline",size:"sm",onClick:t(()=>f({estimated_close_date_gte:g.toISOString().split("T")[0],estimated_close_date_lte:x.toISOString().split("T")[0]}),"onClick"),className:"w-full justify-start",title:"Opportunities with expected close date within 30 days",children:[a.jsx(gt,{className:"w-3.5 h-3.5 mr-2"}),"Closing This Month"]}),a.jsxs(le,{type:"button",variant:y({priority:["high","critical"]})?"default":"outline",size:"sm",onClick:t(()=>f({priority:["high","critical"]}),"onClick"),className:"w-full justify-start",title:"Critical and high priority opportunities",children:[a.jsx(ot,{className:"w-3.5 h-3.5 mr-2"}),"High Priority"]}),a.jsxs(le,{type:"button",variant:y({next_action_date_lte:g.toISOString().split("T")[0]})?"default":"outline",size:"sm",onClick:t(()=>f({next_action_date_lte:g.toISOString().split("T")[0]}),"onClick"),className:"w-full justify-start",title:"Opportunities with overdue or upcoming actions",children:[a.jsx(Rt,{className:"w-3.5 h-3.5 mr-2"}),"Needs Action"]}),a.jsxs(le,{type:"button",variant:y({stage:"closed_won",updated_at_gte:Yt(g,-30).toISOString().split("T")[0]})?"default":"outline",size:"sm",onClick:t(()=>f({stage:"closed_won",updated_at_gte:Yt(g,-30).toISOString().split("T")[0]}),"onClick"),className:"w-full justify-start",title:"Opportunities closed won in the last 30 days",children:[a.jsx(rt,{className:"w-3.5 h-3.5 mr-2"}),"Recent Wins"]})]}),a.jsx(Va,{label:"Stage",icon:a.jsx(jt,{className:"h-4 w-4"}),"data-tutorial":"opp-stage-filters",children:X.map(e=>a.jsx(Ra,{multiselect:!0,className:"w-full justify-between",label:e.label,value:{stage:e.value}},e.value))}),a.jsx(Va,{label:"Priority",icon:a.jsx(Rt,{className:"h-4 w-4"}),children:tr.map(e=>a.jsx(Ra,{multiselect:!0,className:"w-full justify-between",label:e.name,value:{priority:e.id}},e.id))}),a.jsx(Va,{label:"Principal",icon:a.jsx(It,{className:"h-4 w-4"}),children:a.jsxs(pe,{value:d,onValueChange:o,children:[a.jsx(me,{className:"w-full min-h-11 bg-background border-border text-foreground","aria-label":"Filter by principal",children:a.jsx(he,{placeholder:"All Principals"})}),a.jsxs(ge,{className:"max-h-60",children:[a.jsx(xe,{value:"all",className:"min-h-11",children:a.jsx("span",{className:"text-muted-foreground",children:"All Principals"})}),r?.map(e=>a.jsx(xe,{value:String(e.id),className:"min-h-11",children:a.jsx("span",{className:"truncate",title:e.name,children:e.name})},e.id))]})]})}),a.jsx(Va,{label:"Customer",icon:a.jsx(It,{className:"h-4 w-4"}),children:a.jsxs(pe,{value:u,onValueChange:l,children:[a.jsx(me,{className:"w-full min-h-11 bg-background border-border text-foreground","aria-label":"Filter by customer",children:a.jsx(he,{placeholder:"All Customers"})}),a.jsxs(ge,{className:"max-h-60",children:[a.jsx(xe,{value:"all",className:"min-h-11",children:a.jsx("span",{className:"text-muted-foreground",children:"All Customers"})}),i?.map(e=>a.jsx(xe,{value:String(e.id),className:"min-h-11",children:a.jsx("span",{className:"truncate",title:e.name,children:e.name})},e.id))]})]})}),a.jsx(Va,{label:"Campaign",icon:a.jsx(Ft,{className:"h-4 w-4"}),children:a.jsxs(pe,{value:p,onValueChange:c,children:[a.jsx(me,{className:"w-full min-h-11 bg-background border-border text-foreground","aria-label":"Filter by campaign",children:a.jsx(he,{placeholder:"All Campaigns"})}),a.jsxs(ge,{className:"max-h-60",children:[a.jsx(xe,{value:"all",className:"min-h-11",children:a.jsx("span",{className:"text-muted-foreground",children:"All Campaigns"})}),h.map(e=>a.jsx(xe,{value:e,className:"min-h-11",children:a.jsx("span",{className:"truncate",title:e,children:e})},e))]})]})}),a.jsx(Va,{icon:a.jsx(zt,{className:"h-4 w-4"}),label:"Owner",children:a.jsx(Ra,{className:"w-full justify-between",label:"Me",value:{opportunity_owner_id:e?.id}})})]})]})},"OpportunityListFilter");function yi(e){if(!e||"string"!=typeof e)return String(e);const t=new Date(e);return isNaN(t.getTime())?String(e):ea(t)?"Today":ta(t)?"This week":aa(t)?"This month":Qt(t,"MMM d, yyyy")}t(yi,"formatDateLabel");const bi=Bt([{key:"stage",label:"Stage",type:"multiselect",choices:[...Y]},{key:"principal_organization_id",label:"Principal",type:"reference",reference:"organizations"},{key:"customer_organization_id",label:"Customer",type:"reference",reference:"organizations"},{key:"campaign",label:"Campaign",type:"select"},{key:"opportunity_owner_id",label:"Owner",type:"reference",reference:"sales"},{key:"priority",label:"Priority",type:"multiselect",choices:[...tr]},{key:"estimated_close_date_gte",label:"Close after",type:"date-range",formatLabel:yi,removalGroup:"estimated_close_date_range"},{key:"estimated_close_date_lte",label:"Close before",type:"date-range",formatLabel:yi,removalGroup:"estimated_close_date_range"},{key:"next_action_date_gte",label:"Action after",type:"date-range",formatLabel:yi,removalGroup:"next_action_date_range"},{key:"next_action_date_lte",label:"Action before",type:"date-range",formatLabel:yi,removalGroup:"next_action_date_range"},{key:"updated_at_gte",label:"Updated after",type:"date-range",formatLabel:yi}]),vi=[{popover:{title:"ðŸŽ¯ Welcome to the Pipeline",description:"This is your sales pipeline - track deals from lead to close. Let me show you around!"}},{element:'[data-tutorial="opp-view-switcher"]',popover:{title:"View Options",description:"Switch between Kanban board (drag & drop), List view (table), or Campaign view (grouped).",side:"bottom",align:"start"}},{element:'[data-tutorial="opp-filters"]',popover:{title:"Filter Your Pipeline",description:"Use Quick Filters for common views, or filter by Stage, Priority, Principal, Customer, Campaign, or Owner.",side:"right",align:"start"}},{element:'[data-tutorial="opp-quick-filters"]',popover:{title:"Quick Filters",description:'"My Opportunities", "Closing This Month", "High Priority", "Needs Action", and "Recent Wins" - one click away.',side:"right",align:"start"}},{element:'[data-tutorial="opp-stage-filters"]',popover:{title:"Filter by Stage",description:"Toggle stages on/off to focus on specific parts of your pipeline.",side:"right",align:"start"}},{element:'[data-tutorial="opp-kanban-board"]',popover:{title:"Pipeline Stages",description:"7 stages from New Lead to Closed. Each column shows count, avg days, and stuck deals.",side:"top",align:"center"}},{element:'[data-tutorial="opp-card"]',popover:{title:"Opportunity Cards",description:"Each card shows deal name, activity status (green/yellow/red dot), and key details. Click to expand.",side:"left",align:"start"}},{element:'[data-tutorial="opp-drag-handle"]',popover:{title:"Drag & Drop",description:"Grab the handle to drag deals between stages. Moving to Closed stages prompts for win/loss reason.",side:"right",align:"start"}},{element:'[data-tutorial="opp-quick-add"]',popover:{title:"Quick Add",description:"Rapidly add new opportunities without leaving the pipeline.",side:"bottom",align:"end"}},{element:'[data-tutorial="opp-export"]',popover:{title:"Export Data",description:"Export your pipeline to CSV for reports or principal reviews.",side:"bottom",align:"end"}},{element:'[data-tutorial="create-opportunity-btn"]',popover:{title:"New Opportunity",description:"Open the full form to create a detailed opportunity with all fields.",side:"bottom",align:"end"}},{popover:{title:"âœ… Ready to Sell!",description:"You now know how to navigate the pipeline. Click the ? button anytime to replay this tour."}}];function ji(){const e=z.useRef(null),s=z.useCallback(()=>{e.current&&e.current.destroy(),e.current=We({showProgress:!0,animate:!0,smoothScroll:!0,overlayOpacity:.75,popoverClass:"tutorial-popover",nextBtnText:"Next â†’",prevBtnText:"â† Back",doneBtnText:"Done âœ“",steps:vi,onDestroyStarted:t(()=>{e.current?.destroy(),e.current=null},"onDestroyStarted")}),e.current.drive()},[]);return a.jsx("div",{className:"fixed bottom-4 left-4 z-50",children:a.jsxs(Le,{children:[a.jsx(De,{asChild:!0,children:a.jsx(le,{variant:"default",size:"icon",onClick:s,className:"h-11 w-11 rounded-full shadow-lg bg-primary text-primary-foreground hover:scale-105 transition-transform","aria-label":"Start pipeline tutorial",children:a.jsx(Wt,{className:"h-5 w-5"})})}),a.jsx(Ee,{side:"right",children:a.jsx("p",{children:"Learn to use the pipeline"})})]})})}t(ji,"OpportunityListTutorial");const Ni="opportunity.view.preference",wi=t(()=>{const e=localStorage.getItem(Ni);return"list"===e||"kanban"===e||"campaign"===e?e:"kanban"},"getViewPreference"),Ci=t(e=>{localStorage.setItem(Ni,e)},"saveViewPreference"),_i=t(()=>{const{data:e,isPending:s}=_(),[n,r]=z.useState(wi);te("opportunities");const{slideOverId:i,isOpen:o,mode:l,openSlideOver:c,closeSlideOver:d,toggleMode:u}=as(),p=t(e=>{r(e),Ci(e)},"handleViewChange");return s?a.jsx(ae,{rows:8,columns:5}):e?a.jsxs(a.Fragment,{children:[a.jsx("div",{"data-tutorial":"opportunities-list",children:a.jsxs(B,{perPage:100,filter:{"deleted_at@is":null},title:!1,sort:{field:"created_at",order:"DESC"},actions:a.jsx(ki,{view:n,onViewChange:p}),exporter:sr,pagination:null,children:[a.jsx(Si,{view:n,openSlideOver:c,isSlideOverOpen:o,slideOverId:i,closeSlideOver:d}),a.jsx(se,{})]})}),a.jsx(xi,{recordId:i,isOpen:o,onClose:d,mode:l,onModeToggle:u}),a.jsx(ji,{})]}):null},"OpportunityList"),Si=t(({view:e,openSlideOver:t,isSlideOverOpen:s,slideOverId:n,closeSlideOver:r})=>{const{data:i,isPending:o,filterValues:l}=$(),c=l&&Object.keys(l).length>0;return z.useEffect(()=>{l?.stage&&Array.isArray(l.stage)&&qt(l.stage)},[l?.stage]),o?a.jsx(Ut,{resource:"opportunities",filterComponent:a.jsx(fi,{}),children:a.jsx(ae,{rows:8,columns:5})}):i?.length||c?a.jsxs(Ut,{resource:"opportunities",filterComponent:a.jsx(fi,{}),children:[a.jsx(Ht,{filterConfig:bi}),a.jsxs("div",{className:"flex h-full min-h-0 w-full flex-1 flex-col overflow-hidden",children:["kanban"===e?a.jsx(Lr,{openSlideOver:t,slideOverId:n,closeSlideOver:r}):"campaign"===e?a.jsx(Mr,{openSlideOver:t}):a.jsx(Rr,{openSlideOver:t,isSlideOverOpen:s}),a.jsx(mr,{})]})]}):a.jsx(Ut,{resource:"opportunities",filterComponent:a.jsx(fi,{}),children:a.jsx(xr,{children:a.jsx(mr,{})})})},"OpportunityListLayout"),ki=t(({view:e,onViewChange:t})=>a.jsxs(Kt,{children:[a.jsx("span",{"data-tutorial":"opp-view-switcher",children:a.jsx(ci,{view:e,onViewChange:t})}),a.jsx("span",{"data-tutorial":"opp-export",children:a.jsx(q,{})}),a.jsx("span",{"data-tutorial":"opp-quick-add",children:a.jsx(pr,{})}),a.jsx("span",{"data-tutorial":"create-opportunity-btn",children:a.jsx(F,{label:"New Opportunity"})})]}),"OpportunityActions");export{_i as default};
