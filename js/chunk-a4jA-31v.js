var e=Object.defineProperty,t=(t,n)=>e(t,"name",{value:n,configurable:!0});import{r as n,R as s}from"./chunk-1NZFT-6z.js";import{Q as r,j as a}from"./chunk-ByJg_QQB.js";import{aa as o,ac as i,ad as l,ae as d,V as c,W as m,B as u,X as h,d as f,bb as p}from"../assets/index-BoLku8RR.js";import{T as x,a as w,b as v,c as b}from"./chunk-B5Y5c6gs.js";import{d as j}from"./chunk-C8K6x_Yi.js";import{y as g,X as y}from"./chunk-Bc6KM1xM.js";function S(){const e=window.location.hash,t=e.indexOf("?");return-1===t?new URLSearchParams:new URLSearchParams(e.slice(t+1))}function E(e){const t=window.location.hash,n=t.indexOf("?"),s=-1===n?t:t.slice(0,n),r=e.toString();return r?`${s}?${r}`:s}function N(){const[e,s]=n.useState(null),[r,a]=n.useState(!1),[o,i]=n.useState("view");n.useEffect(()=>{const e=S(),t=e.get("view"),n=e.get("edit");t?(s(Number(t)),i("view"),a(!0)):n&&(s(Number(n)),i("edit"),a(!0))},[]);const l=n.useCallback(()=>{a(!1),s(null);const e=S();e.delete("view"),e.delete("edit");const t=E(e);window.history.pushState(null,"",t)},[]);n.useEffect(()=>{const e=t(()=>{const e=S(),t=e.get("view"),n=e.get("edit");t?(s(Number(t)),i("view"),a(!0)):n?(s(Number(n)),i("edit"),a(!0)):(a(!1),s(null))},"handleHashChange");return window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}},[]),n.useEffect(()=>{const e=t(e=>{"Escape"===e.key&&r&&l()},"handleEsc");return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r,l]);const d=t((e,t="view")=>{s(e),i(t),a(!0);const n=S();n.delete("view"),n.delete("edit"),n.set(t,String(e));const r=E(n);window.history.pushState(null,"",r)},"openSlideOver"),c=t(()=>{const t="view"===o?"edit":"view";if(i(t),e){const n=S();n.delete("view"),n.delete("edit"),n.set(t,String(e));const s=E(n);window.history.replaceState(null,"",s)}},"toggleMode");return{slideOverId:e,isOpen:r,mode:o,openSlideOver:d,closeSlideOver:l,setMode:i,toggleMode:c}}t(S,"getHashParams"),t(E,"setHashParams"),t(N,"useSlideOverState");const k=t(()=>"undefined"!=typeof window&&/Mac|iPhone|iPod|iPad/.test(navigator.platform),"isMac"),C=t(e=>k()?e.metaKey:e.ctrlKey,"isModifierPressed"),L=t(e=>{if(!(e instanceof HTMLElement))return!1;const t=e.tagName.toLowerCase(),n=e.isContentEditable;if("input"===t||"textarea"===t||n)return!0;let s=e;for(;s;){if(s.isContentEditable)return!0;s=s.parentElement}return!1},"shouldPreventShortcut"),O=t(e=>e instanceof HTMLElement&&("textarea"===e.tagName.toLowerCase()||e.isContentEditable),"isTextarea"),D=t(e=>e instanceof HTMLElement&&null!==e.closest("form"),"isInForm"),M=t((e={})=>{const t=n.useCallback(t=>{const{key:n}=t,s=t.target;if("s"===n&&C(t))D(s)&&(t.preventDefault(),e.onSave?.());else if("n"===n&&C(t))L(s)||(t.preventDefault(),e.onNew?.());else if("k"===n&&C(t)||"/"===n){if(!L(s)){t.preventDefault(),e.onSearch?.();const n=document.querySelector('input[type="search"], input[placeholder*="Search" i]');n?.focus()}}else"Escape"!==n?"Enter"!==n?"Delete"!==n?"ArrowUp"!==n?"ArrowDown"!==n?"Enter"!==n||D(s)||L(s)||e.onEnter&&(t.preventDefault(),e.onEnter()):!L(s)&&e.onArrowDown&&(t.preventDefault(),e.onArrowDown()):!L(s)&&e.onArrowUp&&(t.preventDefault(),e.onArrowUp()):L(s)||e.onDelete?.():D(s)&&!O(s)&&e.onSubmit?.():e.onCancel?.()},[e]);return n.useEffect(()=>(document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}),[t]),{isMac:k(),modifierKey:k()?"⌘":"Ctrl"}},"useKeyboardShortcuts");function P(e,t=!1,n=!1){const s=k(),r=[];t&&r.push(s?"⌘":"Ctrl"),n&&r.push(s?"⇧":"Shift");return r.push("Esc"),s?r.join(""):r.join("+")}function R({resource:e,recordId:S,isOpen:E,onClose:N,mode:k="view",onModeToggle:C,tabs:L,recordRepresentation:O,breadcrumbComponent:D,loadingSkeleton:R=j}){const[T,$]=n.useState(L[0]?.key||"");M({onCancel:E?N:void 0});const{data:A,isLoading:F}=r(e,{id:S},{enabled:!!S}),H=t(()=>F?"Loading...":A?O?O(A):A.name||A.title||`${e} #${S}`:"Record Details","getRecordTitle"),U=L[0]?.key;return s.useEffect(()=>{E&&U&&$(U)},[E,U]),a.jsx(o,{open:E,onOpenChange:t(e=>!e&&N(),"onOpenChange"),children:a.jsx(i,{side:"right",className:"w-[78vw] min-w-[576px] max-w-[1024px] bg-card shadow-md p-0 flex flex-col",role:"dialog","aria-modal":"true","aria-labelledby":"slide-over-title",children:S?a.jsxs(a.Fragment,{children:[a.jsxs(l,{className:"!p-0 border-b border-border px-4 py-2 gap-1 flex flex-col shrink-0",children:[D&&A&&!F&&a.jsx("div",{className:"mb-1",children:a.jsx(D,{record:A})}),a.jsxs("div",{className:"flex flex-row items-center justify-between min-h-[28px] pr-10",children:[a.jsx(d,{id:"slide-over-title",className:"text-base font-semibold",children:H()}),C&&a.jsxs(c,{children:[a.jsx(m,{asChild:!0,children:a.jsx(u,{variant:"ghost",onClick:C,className:"h-11 px-3 text-sm","aria-label":"view"===k?"Switch to edit mode":"Switch to view mode",children:"view"===k?a.jsxs(a.Fragment,{children:[a.jsx(g,{className:"size-4 mr-1"}),"Edit"]}):a.jsxs(a.Fragment,{children:[a.jsx(y,{className:"size-4 mr-1"}),"Cancel"]})})}),a.jsx(h,{side:"bottom",children:"view"===k?"Edit record":`Cancel editing (${P()})`})]})]})]}),a.jsxs(x,{value:T,onValueChange:$,className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(w,{className:"border-b border-border h-11 rounded-none bg-transparent p-0 w-full justify-start gap-1 px-2",children:L.map(e=>{const t=A&&e.countFromRecord?e.countFromRecord(A):null,n=null!=t&&t>0;return a.jsxs(c,{children:[a.jsx(m,{asChild:!0,children:a.jsxs(v,{value:e.key,className:"h-11 min-w-11 px-2 rounded-none data-[state=active]:border-b-2 data-[state=active]:border-primary flex items-center justify-center gap-1 relative","aria-label":n?`${e.label} (${t})`:e.label,children:[e.icon?a.jsx(e.icon,{className:"size-5"}):a.jsx("span",{className:"text-sm font-medium",children:e.label.charAt(0)}),n&&a.jsx(f,{variant:"secondary",className:"h-5 min-w-5 px-1.5 text-xs font-medium",children:t>99?"99+":t})]})}),a.jsx(h,{side:"bottom",sideOffset:4,children:n?`${e.label} (${t})`:e.label})]},e.key)})}),L.map(e=>{const t=e.component,n=T===e.key;return a.jsx(b,{value:e.key,className:"flex-1 overflow-y-auto p-6 m-0",children:n&&a.jsx(a.Fragment,{children:F?a.jsx(R,{}):A?a.jsx(t,{record:A,mode:k,onModeToggle:C,isActiveTab:n}):a.jsx("p",{className:"text-muted-foreground",children:"Record not found"})})},e.key)})]}),"edit"===k&&a.jsxs(p,{className:"border-t border-border p-4 flex flex-row gap-2 justify-end items-center",children:[a.jsx(u,{variant:"outline",onClick:C,className:"h-11 px-4",children:"Cancel"}),a.jsx(u,{type:"submit",form:"slide-over-edit-form",className:"h-11 px-4",children:"Save Changes"})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("p",{className:"text-muted-foreground",children:"Select a record to view details"})})})})}t(P,"formatShortcut"),t(R,"ResourceSlideOver");export{R,N as u};
