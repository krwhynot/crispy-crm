{"version":3,"file":"ProductEdit-DaOeMAoy.js","sources":["../../src/atomic-crm/products/ProductEdit.tsx"],"sourcesContent":["import { EditBase, Form, useRecordContext, useGetIdentity } from \"ra-core\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { DeleteButton } from \"@/components/admin/delete-button\";\nimport { SaveButton } from \"@/components/admin/form\";\nimport { CancelButton } from \"@/components/admin/cancel-button\";\nimport { FormToolbar } from \"@/components/admin/simple-form\";\nimport { ProductInputs } from \"./ProductInputs\";\nimport type { Product } from \"../types\";\n\nconst ProductEdit = () => {\n  const queryClient = useQueryClient();\n\n  return (\n    <EditBase\n      redirect=\"show\"\n      mutationMode=\"pessimistic\"\n      mutationOptions={{\n        onSuccess: () => {\n          // Invalidate products cache\n          queryClient.invalidateQueries({ queryKey: [\"products\"] });\n        },\n      }}\n    >\n      <div className=\"mt-2\">\n        <ProductEditForm />\n      </div>\n    </EditBase>\n  );\n};\n\nconst ProductEditForm = () => {\n  const record = useRecordContext<Product>();\n  const { data: identity } = useGetIdentity();\n\n  // Wait for record to load before rendering form\n  if (!record) return null;\n\n  return (\n    <Form\n      defaultValues={{\n        ...record,\n        updated_by: identity?.id,\n      }}\n      key={record.id} // Force remount when record changes\n    >\n      <Card>\n        <CardContent>\n          <div className=\"mb-6\">\n            <h2 className=\"text-2xl font-semibold\">Edit {record.name}</h2>\n            <p className=\"text-sm text-muted-foreground mt-1\">Update product information</p>\n          </div>\n\n          <ProductInputs />\n\n          <FormToolbar>\n            <div className=\"flex flex-row gap-2 justify-between w-full\">\n              <DeleteButton />\n              <div className=\"flex gap-2\">\n                <CancelButton />\n                <SaveButton label=\"Save Changes\" />\n              </div>\n            </div>\n          </FormToolbar>\n        </CardContent>\n      </Card>\n    </Form>\n  );\n};\n\nexport { ProductEdit };\nexport default ProductEdit;\n"],"names":["ProductEdit","__name","queryClient","useQueryClient","jsx","EditBase","redirect","mutationMode","mutationOptions","onSuccess","invalidateQueries","queryKey","children","className","ProductEditForm","record","useRecordContext","data","identity","useGetIdentity","Form","defaultValues","updated_by","id","Card","jsxs","CardContent","name","ProductInputs","FormToolbar","DeleteButton","CancelButton","SaveButton","label"],"mappings":"q4BAUA,MAAMA,EAAcC,EAAA,KAClB,MAAMC,EAAcC,IAEpB,OACEC,EAAAA,IAACC,EAAA,CACCC,SAAS,OACTC,aAAa,cACbC,gBAAiB,CACfC,UAAWR,EAAA,KAETC,EAAYQ,kBAAkB,CAAEC,SAAU,CAAC,eAFlC,cAMbC,eAAC,MAAA,CAAIC,UAAU,OACbD,SAAAR,EAAAA,IAACU,WAfW,eAqBdA,EAAkBb,EAAA,KACtB,MAAMc,EAASC,KACPC,KAAMC,GAAaC,IAG3B,OAAKJ,EAGHX,EAAAA,IAACgB,EAAA,CACCC,cAAe,IACVN,EACHO,WAAYJ,GAAUK,IAIxBX,SAAAR,EAAAA,IAACoB,EAAA,CACCZ,SAAAa,OAACC,EAAA,CACCd,SAAA,GAAAa,KAAC,MAAA,CAAIZ,UAAU,OACbD,SAAA,GAAAa,KAAC,KAAA,CAAGZ,UAAU,yBAAyBD,SAAA,CAAA,QAAMG,EAAOY,QACpDvB,EAAAA,IAAC,IAAA,CAAES,UAAU,qCAAqCD,SAAA,wCAGnDgB,EAAA,IAEDxB,MAACyB,EAAA,CACCjB,SAAAa,EAAAA,KAAC,MAAA,CAAIZ,UAAU,6CACbD,SAAA,CAAAR,EAAAA,IAAC0B,EAAA,MACDL,KAAC,MAAA,CAAIZ,UAAU,aACbD,SAAA,CAAAR,EAAAA,IAAC2B,EAAA,MACD3B,IAAC4B,EAAA,CAAWC,MAAM,+BAhBvBlB,EAAOQ,IARI,MALE"}