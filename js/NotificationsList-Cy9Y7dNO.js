var s=Object.defineProperty,e=(e,a)=>s(e,"name",{value:a,configurable:!0});import{j as a,ak as t,al as i,W as r,u as n,w as o}from"./chunk-ByJg_QQB.js";import{B as c}from"./chunk-BndLoydo.js";import{L as l,S as d}from"./chunk-BBQ6yJWi.js";import{T as m}from"./chunk-BtJ7Qrct.js";import{C as x,B as f,q as h,s as u,d as j}from"../assets/index-BoLku8RR.js";import{F as p,T as N}from"./chunk-C6dCzd_-.js";import{L as y}from"./chunk-1NZFT-6z.js";import{t as g,C as k,E as w,s as b}from"./chunk-Bc6KM1xM.js";import{f as v}from"./chunk-DwAffUXc.js";import"./chunk-JxeXaC9i.js";import"./chunk-Dc4zIuSl.js";import"./chunk-B1s-jt27.js";import"./chunk-knA4lag3.js";import"./chunk-Tyyhsnez.js";import"./chunk-XoqkUGE_.js";import"./chunk-CRKBdUTG.js";const L=e(()=>a.jsx(l,{title:"Notifications",actions:a.jsx(_,{}),perPage:20,sort:{field:"created_at",order:"DESC"},empty:a.jsx(T,{}),children:a.jsx(S,{})}),"NotificationsList"),S=e(()=>{const{isPending:s}=t();return s?a.jsx("div",{className:"p-6 text-center",children:"Loading..."}):a.jsxs("div",{className:"flex flex-row gap-6",children:[a.jsx(E,{}),a.jsx("div",{className:"flex-1 flex flex-col gap-4",children:a.jsx(x,{className:"bg-card border border-border shadow-sm rounded-xl p-2",children:a.jsx($,{})})}),a.jsx(c,{children:a.jsx(C,{})})]})},"NotificationsListLayout"),_=e(()=>a.jsx(m,{}),"NotificationsListActions"),E=e(()=>a.jsx("div",{className:"w-52 min-w-52 order-first",children:a.jsx(x,{className:"bg-card border border-border shadow-sm rounded-xl p-4",children:a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(i,{children:a.jsx(d,{source:"q",placeholder:"Search notifications..."})}),a.jsx("div",{className:"border-b border-border"}),a.jsxs(p,{label:"Status",icon:a.jsx(g,{className:"h-4 w-4"}),children:[a.jsx(N,{className:"w-full justify-between",label:"Unread only",value:{read:!1}}),a.jsx(N,{className:"w-full justify-between",label:"Read only",value:{read:!0}})]})]})})}),"NotificationsListFilter"),$=e(()=>{const{data:s}=t();return s&&0!==s.length?a.jsx("div",{className:"divide-y divide-border",children:s.map(s=>a.jsx(A,{notification:s},s.id))}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[a.jsx(g,{className:"h-12 w-12 mb-4 opacity-50"}),a.jsx("p",{className:"text-lg font-medium",children:"No notifications"}),a.jsx("p",{className:"text-sm",children:"You're all caught up!"})]})},"NotificationsListContent"),A=e(({notification:s})=>{const[t]=r(),i=n(),c=o(),l=e(async()=>{await t("notifications",{id:s.id,data:{read:!0}},{onSuccess:e(()=>{i("Notification marked as read",{type:"success"}),c()},"onSuccess"),onError:e(()=>{i("Error marking notification as read",{type:"error"})},"onError")})},"markAsRead"),d=v(h(s.created_at)??new Date,{addSuffix:!0}),m=z(s.entity_type,s.entity_id);return a.jsxs("div",{className:u("flex items-start gap-4 p-4 hover:bg-muted/30 transition-colors",!s.read&&"bg-muted/20"),children:[a.jsx("div",{className:"flex-shrink-0 mt-2",children:a.jsx("div",{className:u("w-3 h-3 rounded-full",s.read?"bg-muted-foreground/30":"bg-primary")})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsx("p",{className:"text-sm",children:s.message}),a.jsx(j,{variant:"outline",className:"flex-shrink-0",children:F(s.type)})]}),a.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-muted-foreground",children:[a.jsx("span",{children:d}),m&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"â€¢"}),a.jsxs(y,{to:m,className:"hover:text-foreground transition-colors inline-flex items-center gap-1",children:["View ",s.entity_type,a.jsx(w,{className:"h-3 w-3"})]})]})]})]}),!s.read&&a.jsx(f,{variant:"ghost",size:"icon",className:"flex-shrink-0 h-11 w-11",onClick:l,"aria-label":"Mark as read",children:a.jsx(b,{className:"h-4 w-4"})})]})},"NotificationRow"),C=e(()=>{const[s]=r(),i=n(),c=o(),{selectedIds:l}=t(),d=e(async()=>{try{const e=await Promise.allSettled(l.map(e=>s("notifications",{id:e,data:{read:!0}}))),a=e.filter(s=>"fulfilled"===s.status).length,t=e.filter(s=>"rejected"===s.status).length;0===t?i(`${a} notification(s) marked as read`,{type:"success"}):a>0?i(`${a} notification(s) marked as read, ${t} failed`,{type:"warning"}):i("Failed to mark notifications as read",{type:"error"}),c()}catch{i("Error marking notifications as read",{type:"error"})}},"markAllAsRead");return a.jsxs(f,{variant:"ghost",size:"sm",onClick:d,className:"h-11 text-xs",children:[a.jsx(k,{className:"h-4 w-4 mr-2"}),"Mark as read"]})},"NotificationsBulkActions"),T=e(()=>a.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] text-muted-foreground",children:[a.jsx(g,{className:"h-16 w-16 mb-4 opacity-50"}),a.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"No notifications yet"}),a.jsx("p",{className:"text-sm",children:"Notifications will appear here when you have updates."})]}),"NotificationsEmpty"),z=e((s,e)=>{if(!s||!e)return null;return{task:`/tasks/${e}`,opportunity:`/opportunities/${e}/show`,contact:`/contacts/${e}/show`,organization:`/organizations/${e}/show`,product:`/products/${e}/show`}[s]||null},"getEntityLink"),F=e(s=>({task_overdue:"Overdue Task",task_assigned:"Task Assigned",mention:"Mention",opportunity_won:"Opportunity Won",opportunity_lost:"Opportunity Lost",system:"System"}[s]||s),"getNotificationTypeLabel");export{L as default};
