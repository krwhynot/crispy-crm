var s=Object.defineProperty,e=(e,n)=>s(e,"name",{value:n,configurable:!0});import{$ as n,U as t,j as r,au as i,u as a,J as o}from"./chunk-ByJg_QQB.js";import{r as c}from"./chunk-1NZFT-6z.js";import{O as d}from"./chunk-CypxJXwf.js";import{A as l,a as m,b as h,c as p,d as j,e as u}from"./chunk-D62ZQQIe.js";import{x,B as g,C as k,a as f}from"../assets/index-BoLku8RR.js";import{k as w,o as y}from"./chunk-Bc6KM1xM.js";import{R as N}from"./chunk-CFwunwMO.js";import{O as b}from"./chunk-RY-5-xkE.js";import{F as v}from"./chunk-C0lbEKTL.js";import"./chunk-JxeXaC9i.js";import"./chunk-DpghI3EP.js";import"./chunk-D6FmavVW.js";import"./chunk-nUtrHAIa.js";import"./chunk-CMQLDEz_.js";import"./chunk-knA4lag3.js";import"./chunk-Tyyhsnez.js";import"./chunk-C_u3nriX.js";import"./chunk-C5fZsuMg.js";import"./chunk-C4sNritB.js";import"./chunk-DsNwAyt-.js";import"./chunk-DhfTvo06.js";import"./chunk-B0BZInrb.js";import"./chunk-CIlS_x6D.js";import"./chunk-DwAffUXc.js";import"./chunk-XoqkUGE_.js";import"./chunk-CRKBdUTG.js";import"./chunk-DfGVVS-c.js";import"./chunk-DbeoRBEW.js";import"./chunk-BI4rbfTW.js";import"./chunk-DkiUngdk.js";import"./chunk-BY7AmvEs.js";import"./chunk-B1s-jt27.js";import"./chunk-j7Lqvg-1.js";import"./chunk-BM66RvuK.js";import"./chunk-6VRQ4sAj.js";const C=e(({open:s,onClose:e,newType:i})=>{const a=n(),{data:o,isLoading:c}=t("products",{filter:{principal_id:a?.id},pagination:{page:1,perPage:100},sort:{field:"name",order:"ASC"}},{enabled:s&&!!a?.id}),d=o?.length||0;return r.jsx(l,{open:s,onOpenChange:e,children:r.jsxs(m,{className:"max-w-2xl",children:[r.jsxs(h,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(w,{className:"h-6 w-6 text-destructive"}),r.jsx(p,{children:"Cannot Change Organization Type"})]}),r.jsxs(j,{className:"space-y-4",children:[r.jsxs("p",{className:"text-base",children:[r.jsx("strong",{children:a?.name})," is currently a ",r.jsx("strong",{children:"Principal"})," with"," ",r.jsxs("strong",{children:[d," product",1!==d?"s":""]})," ","assigned."]}),r.jsxs("p",{children:["You cannot change this organization to ",r.jsx("strong",{children:i})," while products are still assigned. Please reassign or remove these products first:"]}),c?r.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Loading products..."}):d>0?r.jsx(x,{className:"h-[300px] rounded-md border p-4",children:r.jsx("div",{className:"space-y-2",children:o?.map(s=>r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[r.jsx(y,{className:"w-4 h-4 mt-0.5 text-muted-foreground"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-sm",children:s.name}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:["SKU: ",s.sku]})]})]},s.id))})}):r.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No products found"}),r.jsxs("div",{className:"bg-warning/10 border border-warning/20 rounded-md p-3",children:[r.jsx("p",{className:"text-sm font-medium",children:"ðŸ’¡ To change this organization type:"}),r.jsxs("ol",{className:"text-sm text-muted-foreground mt-2 ml-4 list-decimal space-y-1",children:[r.jsx("li",{children:"Go to the Products page"}),r.jsxs("li",{children:["Reassign these ",d," products to a different principal"]}),r.jsx("li",{children:"Return here to change the organization type"})]})]})]})]}),r.jsx(u,{children:r.jsx(g,{variant:"outline",onClick:e,children:"Close"})})]})})},"PrincipalChangeWarning"),z=e(()=>{const[s,n]=c.useState(!1),[t,a]=c.useState("");return r.jsx(i,{actions:!1,redirect:"show",mutationOptions:{onMutate:e(async s=>{const{data:e,previousData:t}=s;if("principal"===t?.organization_type&&e?.organization_type&&"principal"!==e.organization_type)throw a(e.organization_type),n(!0),new Error("PRINCIPAL_VALIDATION_REQUIRED")},"onMutate")},transform:e(s=>(s.website&&!s.website.startsWith("http")&&(s.website=`https://${s.website}`),s),"transform"),children:r.jsx(O,{showWarning:s,setShowWarning:n,attemptedType:t})})},"OrganizationEdit"),O=e(({showWarning:s,setShowWarning:t,attemptedType:i})=>{const c=n(),l=a(),m=e(()=>{t(!1),c&&l("Organization type change cancelled. Please reassign products first.",{type:"warning"})},"handleWarningClose");return r.jsxs(r.Fragment,{children:[r.jsxs(N,{variant:"dashboard",className:"mt-2",children:[r.jsx("main",{role:"main","aria-label":"Edit organization",children:r.jsx(o,{className:"flex flex-col gap-4",children:r.jsx(k,{children:r.jsxs(f,{children:[r.jsx(d,{}),r.jsx(v,{})]})})})}),r.jsx("aside",{"aria-label":"Organization information",children:r.jsx(b,{link:"show"})})]}),r.jsx(C,{open:s,onClose:m,onConfirm:e(()=>{m()},"onConfirm"),newType:i})]})},"OrganizationEditContent");export{z as OrganizationEdit,z as default};
