var e=Object.defineProperty,s=(s,t)=>e(s,"name",{value:t,configurable:!0});import{i as t,u as r,c as a,j as i,at as o,J as c}from"./chunk-ByJg_QQB.js";import{c as n,u as l}from"./chunk-JxeXaC9i.js";import{r as u}from"./chunk-1NZFT-6z.js";import{u as d,Y as p,T as m,B as h,w as j}from"../assets/index-BoLku8RR.js";import{S as x}from"./chunk-C5fZsuMg.js";import{R as k}from"./chunk-D6FmavVW.js";import{A as y}from"./chunk-nUtrHAIa.js";import{F as f}from"./chunk-DpghI3EP.js";import{c as b}from"./chunk-X0dz3Jmp.js";import"./chunk-DwAffUXc.js";import"./chunk-knA4lag3.js";import"./chunk-Tyyhsnez.js";import"./chunk-Bc6KM1xM.js";import"./chunk-XoqkUGE_.js";import"./chunk-CRKBdUTG.js";import"./chunk-CMQLDEz_.js";import"./chunk-C_u3nriX.js";import"./chunk-B9H_70fs.js";function T(){const{data:e}=t(),{taskTypes:s}=d(),n=r(),l=a(),u={...p(),sales_id:e?.id};return i.jsx(o,{redirect:"list",children:i.jsx("div",{className:"bg-muted px-6 py-6",children:i.jsx("div",{className:"max-w-4xl mx-auto create-form-card",children:i.jsx(c,{defaultValues:u,children:i.jsx(g,{notify:n,redirect:l,taskTypes:s})})})})})}s(T,"TaskCreate");const g=s(({notify:e,redirect:s,taskTypes:t})=>{const{errors:r}=n();return i.jsxs(i.Fragment,{children:[i.jsx(f,{errors:r}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{"data-tutorial":"task-title",children:i.jsx(m,{source:"title",label:"Task Title",isRequired:!0,helperText:"What needs to be done?"})}),i.jsx(m,{source:"description",label:"Description",multiline:!0,rows:2,helperText:"Optional details"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx("div",{"data-tutorial":"task-due-date",children:i.jsx(m,{source:"due_date",label:"Due Date",type:"date",isRequired:!0,helperText:"When is this due?"})}),i.jsx(x,{source:"type",label:"Type",choices:t.map(e=>({id:e,name:e})),helperText:"Category of task"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(x,{source:"priority",label:"Priority",choices:[{id:"low",name:"Low"},{id:"medium",name:"Medium"},{id:"high",name:"High"},{id:"critical",name:"Critical"}],helperText:"How urgent?"}),i.jsx(k,{source:"opportunity_id",reference:"opportunities",children:i.jsx(y,{label:"Opportunity",optionText:"title",helperText:"Link to opportunity (optional)"})})]}),i.jsx(k,{source:"contact_id",reference:"contacts_summary",children:i.jsx(y,{label:"Contact",optionText:b,helperText:"Link to contact (optional)"})})]}),i.jsx(v,{notify:e,redirect:s})]})},"TaskFormContent"),v=s(({notify:e,redirect:t})=>{const{reset:r}=l(),{isDirty:a}=n(),o=u.useCallback(()=>{if(a){if(!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return}t("/tasks")},[a,t]),c=u.useCallback(s=>{e(s.message||"Failed to create task",{type:"error"})},[e]);return i.jsxs("div",{className:"sticky bottom-12 bg-card border-t border-border p-4 flex justify-between mt-6",children:[i.jsx(h,{variant:"outline",onClick:o,children:"Cancel"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(j,{type:"button",label:"Save & Close","data-tutorial":"task-save-btn",mutationOptions:{onSuccess:s(()=>{e("Task created successfully",{type:"success"}),t("/tasks")},"onSuccess"),onError:c}}),i.jsx(j,{type:"button",label:"Save & Add Another",mutationOptions:{onSuccess:s(()=>{e("Task created successfully",{type:"success"}),r()},"onSuccess"),onError:c}})]})]})},"TaskCreateFooter");export{T as default};
