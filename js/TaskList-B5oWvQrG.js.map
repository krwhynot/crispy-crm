{"version":3,"file":"TaskList-B5oWvQrG.js","sources":["../../src/components/ui/priority-badge.tsx","../../src/atomic-crm/tasks/TaskListFilter.tsx","../../src/atomic-crm/tasks/TaskSlideOverDetailsTab.tsx","../../src/atomic-crm/tasks/TaskRelatedItemsTab.tsx","../../src/atomic-crm/tasks/TaskSlideOver.tsx","../../src/atomic-crm/tasks/TaskEmpty.tsx","../../src/atomic-crm/tasks/taskFilterConfig.ts","../../src/atomic-crm/tasks/TaskList.tsx"],"sourcesContent":["/* eslint-disable react-refresh/only-export-components */\n// Component + constant pattern: PriorityBadge + priorityChoices for SelectInput\n\nimport { Badge } from \"@/components/ui/badge\";\n\n/**\n * PriorityBadge Component\n *\n * Displays a task priority level with consistent semantic color mapping.\n * Extracted to single location per DRY principle - used in:\n * - TaskList (table column)\n * - TaskSlideOverDetailsTab (slide-over view)\n * - TaskShow (card view)\n *\n * Variant mapping standardized:\n * - low: outline (subtle)\n * - medium: secondary (neutral)\n * - high: default (attention)\n * - critical: destructive (urgent)\n */\n\nconst priorityVariants = {\n  low: \"outline\",\n  medium: \"secondary\",\n  high: \"default\",\n  critical: \"destructive\",\n} as const;\n\ntype PriorityLevel = keyof typeof priorityVariants;\n\ninterface PriorityBadgeProps {\n  priority: string;\n  className?: string;\n}\n\nexport function PriorityBadge({ priority, className }: PriorityBadgeProps) {\n  const variant = priorityVariants[priority as PriorityLevel] || \"outline\";\n  const label = priority.charAt(0).toUpperCase() + priority.slice(1);\n\n  return (\n    <Badge variant={variant} className={className}>\n      {label}\n    </Badge>\n  );\n}\n\n/**\n * Priority choices for SelectInput components.\n * Centralized to prevent duplication across form components.\n */\nexport const priorityChoices = [\n  { id: \"low\", name: \"Low\" },\n  { id: \"medium\", name: \"Medium\" },\n  { id: \"high\", name: \"High\" },\n  { id: \"critical\", name: \"Critical\" },\n] as const;\n","import { Badge } from \"@/components/ui/badge\";\nimport { endOfToday, startOfToday, addDays } from \"date-fns\";\nimport { Calendar, CheckSquare, Star, Tag, Users } from \"lucide-react\";\nimport { FilterLiveForm, useGetIdentity } from \"ra-core\";\n\nimport { ToggleFilterButton } from \"@/components/admin/toggle-filter-button\";\nimport { SearchInput } from \"@/components/admin/search-input\";\nimport { FilterCategory } from \"../filters/FilterCategory\";\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\n\n/**\n * TaskListFilter Component\n *\n * Sidebar filter panel for tasks list using the collapsible FilterCategory pattern.\n * Filters: opportunity, due date, completion status, priority, type, assigned to\n */\nexport const TaskListFilter = () => {\n  const { data: identity } = useGetIdentity();\n  const { taskTypes } = useConfigurationContext();\n\n  const priorityColors: Record<string, string> = {\n    low: \"outline\",\n    medium: \"secondary\",\n    high: \"default\",\n    critical: \"destructive\",\n  };\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      {/* Search - Always visible */}\n      <FilterLiveForm>\n        <SearchInput source=\"q\" placeholder=\"Search tasks...\" />\n      </FilterLiveForm>\n\n      {/* Collapsible Filter Sections */}\n      <div className=\"flex flex-col gap-2\">\n        <FilterCategory label=\"Due Date\" icon={<Calendar className=\"h-4 w-4\" />}>\n          <ToggleFilterButton\n            className=\"w-full justify-between\"\n            label=\"Today\"\n            value={{\n              \"due_date@gte\": startOfToday().toISOString(),\n              \"due_date@lte\": endOfToday().toISOString(),\n            }}\n          />\n          <ToggleFilterButton\n            className=\"w-full justify-between\"\n            label=\"This Week\"\n            value={{\n              \"due_date@gte\": startOfToday().toISOString(),\n              \"due_date@lte\": addDays(startOfToday(), 7).toISOString(),\n            }}\n          />\n          <ToggleFilterButton\n            className=\"w-full justify-between\"\n            label=\"Overdue\"\n            value={{\n              \"due_date@lte\": startOfToday().toISOString(),\n              completed: false,\n            }}\n          />\n        </FilterCategory>\n\n        <FilterCategory label=\"Status\" icon={<CheckSquare className=\"h-4 w-4\" />}>\n          <ToggleFilterButton\n            className=\"w-full justify-between\"\n            label=\"Incomplete\"\n            value={{ completed: false }}\n          />\n          <ToggleFilterButton\n            className=\"w-full justify-between\"\n            label=\"Completed\"\n            value={{ completed: true }}\n          />\n        </FilterCategory>\n\n        <FilterCategory label=\"Priority\" icon={<Star className=\"h-4 w-4\" />}>\n          {[\"low\", \"medium\", \"high\", \"critical\"].map((priority) => (\n            <ToggleFilterButton\n              multiselect\n              key={priority}\n              className=\"w-full justify-between\"\n              label={\n                <Badge variant={priorityColors[priority] as any} className=\"text-xs px-1 py-0\">\n                  {priority.charAt(0).toUpperCase() + priority.slice(1)}\n                </Badge>\n              }\n              value={{ priority }}\n            />\n          ))}\n        </FilterCategory>\n\n        <FilterCategory label=\"Type\" icon={<Tag className=\"h-4 w-4\" />}>\n          {taskTypes.map((type) => (\n            <ToggleFilterButton\n              multiselect\n              key={type}\n              className=\"w-full justify-between\"\n              label={type}\n              value={{ type }}\n            />\n          ))}\n        </FilterCategory>\n\n        <FilterCategory icon={<Users className=\"h-4 w-4\" />} label=\"Assigned To\">\n          <ToggleFilterButton\n            className=\"w-full justify-between\"\n            label={\"Me\"}\n            value={{ sales_id: identity?.id }}\n          />\n        </FilterCategory>\n      </div>\n    </div>\n  );\n};\n","import { useUpdate, useNotify, RecordContextProvider } from \"ra-core\";\nimport { Form } from \"react-admin\";\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { DateField } from \"@/components/admin/date-field\";\nimport { TextInput } from \"@/components/admin/text-input\";\nimport { SelectInput } from \"@/components/admin/select-input\";\nimport { ReferenceInput } from \"@/components/admin/reference-input\";\nimport { AutocompleteInput } from \"@/components/admin/autocomplete-input\";\nimport { BooleanInput } from \"@/components/admin/boolean-input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { PriorityBadge } from \"@/components/ui/priority-badge\";\nimport { AsideSection } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport { contactOptionText } from \"../contacts/ContactOption\";\nimport type { Task } from \"../types\";\n\ninterface TaskSlideOverDetailsTabProps {\n  record: Task;\n  mode: \"view\" | \"edit\";\n  onModeToggle?: () => void;\n}\n\n/**\n * Details tab for TaskSlideOver.\n *\n * **View Mode**: Displays all task fields:\n * - Title, Description\n * - Due Date, Reminder Date\n * - Priority (badge with semantic colors)\n * - Type (badge)\n * - Completed (checkbox - inline interactive)\n * - Assigned To (ReferenceField to sales)\n * - Related Contact, Opportunity\n *\n * **Edit Mode**: Full form with save/cancel buttons\n */\nexport function TaskSlideOverDetailsTab({\n  record,\n  mode,\n  onModeToggle,\n}: TaskSlideOverDetailsTabProps) {\n  const [update] = useUpdate();\n  const notify = useNotify();\n  const { taskTypes } = useConfigurationContext();\n\n  // Handle save in edit mode\n  const handleSave = async (data: Partial<Task>) => {\n    try {\n      await update(\"tasks\", {\n        id: record.id,\n        data,\n        previousData: record,\n      });\n      notify(\"Task updated successfully\", { type: \"success\" });\n      onModeToggle?.(); // Return to view mode after successful save\n    } catch (error) {\n      notify(\"Error updating task\", { type: \"error\" });\n      console.error(\"Save error:\", error);\n    }\n  };\n\n  // Handle inline completion toggle in view mode\n  const handleCompletionToggle = async (checked: boolean) => {\n    try {\n      await update(\"tasks\", {\n        id: record.id,\n        data: {\n          completed: checked,\n          completed_at: checked ? new Date().toISOString() : null,\n        },\n        previousData: record,\n      });\n      notify(checked ? \"Task marked complete\" : \"Task marked incomplete\", { type: \"success\" });\n    } catch (error) {\n      notify(\"Error updating task\", { type: \"error\" });\n      console.error(\"Completion toggle error:\", error);\n    }\n  };\n\n  if (mode === \"edit\") {\n    return (\n      <RecordContextProvider value={record}>\n        <Form id=\"slide-over-edit-form\" onSubmit={handleSave} record={record}>\n          <div className=\"space-y-6\" role=\"form\" aria-label=\"Edit task form\">\n            <div className=\"space-y-4\">\n              <TextInput source=\"title\" label=\"Task Title\" />\n              <TextInput source=\"description\" label=\"Description\" multiline rows={3} />\n              <TextInput source=\"due_date\" label=\"Due Date\" type=\"date\" />\n              <TextInput source=\"reminder_date\" label=\"Reminder Date\" type=\"date\" />\n\n              <SelectInput\n                source=\"priority\"\n                label=\"Priority\"\n                choices={[\n                  { id: \"low\", name: \"Low\" },\n                  { id: \"medium\", name: \"Medium\" },\n                  { id: \"high\", name: \"High\" },\n                  { id: \"critical\", name: \"Critical\" },\n                ]}\n              />\n\n              <SelectInput\n                source=\"type\"\n                label=\"Type\"\n                choices={taskTypes.map((type) => ({ id: type, name: type }))}\n              />\n\n              <BooleanInput source=\"completed\" label=\"Completed\" />\n\n              <ReferenceInput source=\"sales_id\" reference=\"sales\">\n                <AutocompleteInput label=\"Assigned To\" />\n              </ReferenceInput>\n\n              <ReferenceInput source=\"contact_id\" reference=\"contacts_summary\">\n                <AutocompleteInput label=\"Contact\" optionText={contactOptionText} />\n              </ReferenceInput>\n\n              <ReferenceInput source=\"opportunity_id\" reference=\"opportunities\">\n                <AutocompleteInput label=\"Opportunity\" optionText=\"title\" />\n              </ReferenceInput>\n            </div>\n          </div>\n        </Form>\n      </RecordContextProvider>\n    );\n  }\n\n  // View mode - display all task fields\n  return (\n    <RecordContextProvider value={record}>\n      <div className=\"space-y-6\">\n        {/* Task Info Section */}\n        <AsideSection title=\"Task Details\">\n          <Card>\n            <CardContent className=\"p-4 space-y-3\">\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2\">{record.title}</h3>\n                {record.description && (\n                  <p className=\"text-sm text-muted-foreground whitespace-pre-wrap\">\n                    {record.description}\n                  </p>\n                )}\n              </div>\n\n              {/* Completion status - Interactive checkbox even in view mode */}\n              {/* min-h-11 ensures 44px touch target for WCAG AA compliance */}\n              <label className=\"flex items-center gap-2 pt-2 min-h-11 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={record.completed || false}\n                  onChange={(e) => handleCompletionToggle(e.target.checked)}\n                  className=\"h-4 w-4 rounded border-input\"\n                  aria-label={\n                    record.completed ? \"Mark task as incomplete\" : \"Mark task as complete\"\n                  }\n                />\n                <span className=\"text-sm font-medium\">\n                  {record.completed ? \"Completed\" : \"Mark as complete\"}\n                </span>\n                {record.completed_at && (\n                  <span className=\"text-xs text-muted-foreground\">\n                    on <DateField source=\"completed_at\" options={{ dateStyle: \"short\" }} />\n                  </span>\n                )}\n              </label>\n            </CardContent>\n          </Card>\n        </AsideSection>\n\n        {/* Dates Section */}\n        <AsideSection title=\"Schedule\">\n          <div className=\"space-y-2\">\n            <div className=\"text-sm\">\n              <span className=\"text-muted-foreground\">Due: </span>\n              <DateField\n                source=\"due_date\"\n                options={{ year: \"numeric\", month: \"long\", day: \"numeric\" }}\n                className=\"font-medium\"\n              />\n            </div>\n            {record.reminder_date && (\n              <div className=\"text-sm\">\n                <span className=\"text-muted-foreground\">Reminder: </span>\n                <DateField\n                  source=\"reminder_date\"\n                  options={{ year: \"numeric\", month: \"long\", day: \"numeric\" }}\n                  className=\"font-medium\"\n                />\n              </div>\n            )}\n          </div>\n        </AsideSection>\n\n        {/* Priority & Type Section */}\n        <AsideSection title=\"Classification\">\n          <div className=\"space-y-2\">\n            {record.priority && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm text-muted-foreground\">Priority:</span>\n                <PriorityBadge priority={record.priority} />\n              </div>\n            )}\n            {record.type && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm text-muted-foreground\">Type:</span>\n                <Badge variant=\"outline\">{record.type}</Badge>\n              </div>\n            )}\n          </div>\n        </AsideSection>\n\n        {/* Assignment Section */}\n        {record.sales_id && (\n          <AsideSection title=\"Assigned To\">\n            <ReferenceField source=\"sales_id\" reference=\"sales\">\n              <SaleName />\n            </ReferenceField>\n          </AsideSection>\n        )}\n\n        {/* Timestamps Section */}\n        <AsideSection title=\"Timeline\">\n          <div className=\"space-y-2\">\n            {record.created_at && (\n              <div className=\"text-sm\">\n                <span className=\"text-muted-foreground\">Created: </span>\n                <DateField\n                  source=\"created_at\"\n                  options={{ year: \"numeric\", month: \"short\", day: \"numeric\" }}\n                />\n              </div>\n            )}\n            {record.updated_at && (\n              <div className=\"text-sm\">\n                <span className=\"text-muted-foreground\">Updated: </span>\n                <DateField\n                  source=\"updated_at\"\n                  options={{ year: \"numeric\", month: \"short\", day: \"numeric\" }}\n                />\n              </div>\n            )}\n          </div>\n        </AsideSection>\n      </div>\n    </RecordContextProvider>\n  );\n}\n","import { RecordContextProvider } from \"ra-core\";\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { TextField } from \"@/components/admin/text-field\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { AsideSection } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport { Building2, UserCircle, Target } from \"lucide-react\";\nimport type { Task } from \"../types\";\nimport { contactOptionText } from \"../contacts/ContactOption\";\n\ninterface TaskRelatedItemsTabProps {\n  record: Task;\n  mode: \"view\" | \"edit\";\n}\n\n/**\n * Related Items tab for TaskSlideOver.\n *\n * Read-only tab showing:\n * - Related Organization (if organization_id exists)\n * - Related Contact (if contact_id exists)\n * - Related Opportunity (if opportunity_id exists)\n * - Assigned Sales Rep (if sales_id exists)\n *\n * No edit mode - relationships are edited in Details tab.\n */\nexport function TaskRelatedItemsTab({ record }: TaskRelatedItemsTabProps) {\n  const hasRelationships =\n    record.organization_id || record.contact_id || record.opportunity_id || record.sales_id;\n\n  return (\n    <RecordContextProvider value={record}>\n      <div className=\"space-y-6\">\n        {!hasRelationships && (\n          <Card>\n            <CardContent className=\"p-8 text-center\">\n              <p className=\"text-sm text-muted-foreground\">\n                No related items. Add relationships in the Details tab.\n              </p>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Related Organization */}\n        {record.organization_id && (\n          <AsideSection title=\"Related Organization\">\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Building2 className=\"size-5 text-muted-foreground\" />\n                  <ReferenceField source=\"organization_id\" reference=\"organizations\" link=\"show\">\n                    <TextField source=\"name\" className=\"font-medium\" />\n                  </ReferenceField>\n                </div>\n              </CardContent>\n            </Card>\n          </AsideSection>\n        )}\n\n        {/* Related Contact */}\n        {record.contact_id && (\n          <AsideSection title=\"Related Contact\">\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center gap-2\">\n                  <UserCircle className=\"size-5 text-muted-foreground\" />\n                  <ReferenceField source=\"contact_id\" reference=\"contacts_summary\" link=\"show\">\n                    <TextField source={contactOptionText} className=\"font-medium\" />\n                  </ReferenceField>\n                </div>\n              </CardContent>\n            </Card>\n          </AsideSection>\n        )}\n\n        {/* Related Opportunity */}\n        {record.opportunity_id && (\n          <AsideSection title=\"Related Opportunity\">\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Target className=\"size-5 text-muted-foreground\" />\n                  <ReferenceField source=\"opportunity_id\" reference=\"opportunities\" link=\"show\">\n                    <TextField source=\"title\" className=\"font-medium\" />\n                  </ReferenceField>\n                </div>\n              </CardContent>\n            </Card>\n          </AsideSection>\n        )}\n\n        {/* Assigned Sales Rep */}\n        {record.sales_id && (\n          <AsideSection title=\"Assigned To\">\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Building2 className=\"size-5 text-muted-foreground\" />\n                  <ReferenceField source=\"sales_id\" reference=\"sales\" link={false}>\n                    <SaleName />\n                  </ReferenceField>\n                </div>\n              </CardContent>\n            </Card>\n          </AsideSection>\n        )}\n      </div>\n    </RecordContextProvider>\n  );\n}\n","import { CheckSquareIcon, LinkIcon } from \"lucide-react\";\nimport type { TabConfig } from \"@/components/layouts/ResourceSlideOver\";\nimport { ResourceSlideOver } from \"@/components/layouts/ResourceSlideOver\";\nimport { TaskSlideOverDetailsTab } from \"./TaskSlideOverDetailsTab\";\nimport { TaskRelatedItemsTab } from \"./TaskRelatedItemsTab\";\nimport type { Task } from \"../types\";\n\ninterface TaskSlideOverProps {\n  recordId: number | null;\n  isOpen: boolean;\n  onClose: () => void;\n  mode: \"view\" | \"edit\";\n  onModeToggle: () => void;\n}\n\n/**\n * TaskSlideOver - Slide-over panel for viewing and editing tasks\n *\n * Features:\n * - Details tab: All task fields including inline completion checkbox\n * - Related Items tab: Contact, Opportunity, Sales rep links\n * - View/Edit mode toggle\n * - URL synchronization\n * - ESC key to close\n *\n * Design:\n * - 40vw width (480-720px)\n * - Slide-in from right\n * - Two tabs with icons\n */\nexport function TaskSlideOver({\n  recordId,\n  isOpen,\n  onClose,\n  mode,\n  onModeToggle,\n}: TaskSlideOverProps) {\n  // Tab configuration\n  const tabs: TabConfig[] = [\n    {\n      key: \"details\",\n      label: \"Details\",\n      component: TaskSlideOverDetailsTab,\n      icon: CheckSquareIcon,\n    },\n    {\n      key: \"related\",\n      label: \"Related Items\",\n      component: TaskRelatedItemsTab,\n      icon: LinkIcon,\n    },\n  ];\n\n  // Record representation function\n  const recordRepresentation = (record: Task) => {\n    return record.title || `Task #${record.id}`;\n  };\n\n  return (\n    <ResourceSlideOver\n      resource=\"tasks\"\n      recordId={recordId}\n      isOpen={isOpen}\n      onClose={onClose}\n      mode={mode}\n      onModeToggle={onModeToggle}\n      tabs={tabs}\n      recordRepresentation={recordRepresentation}\n    />\n  );\n}\n","import { CreateButton } from \"@/components/admin/create-button\";\nimport useAppBarHeight from \"../hooks/useAppBarHeight\";\n\nexport const TaskEmpty = () => {\n  const appbarHeight = useAppBarHeight();\n  return (\n    <div\n      className=\"flex flex-col justify-center items-center gap-3\"\n      style={{\n        height: `calc(100dvh - ${appbarHeight}px)`,\n      }}\n    >\n      <img src=\"./img/empty.svg\" alt=\"No tasks found\" />\n      <div className=\"flex flex-col gap-0 items-center\">\n        <h2 className=\"text-lg font-bold\">No tasks found</h2>\n        <p className=\"text-sm text-muted-foreground text-center mb-4\">\n          Your task list is empty. Create a task to get started.\n        </p>\n      </div>\n      <span data-tutorial=\"create-task-btn\">\n        <CreateButton label=\"New Task\" />\n      </span>\n    </div>\n  );\n};\n","/**\n * Task Filter Configuration\n *\n * Defines how task filters are displayed in the FilterChipBar.\n *\n * @module tasks/taskFilterConfig\n */\n\nimport { validateFilterConfig } from \"../filters/filterConfigSchema\";\nimport { format, isToday, isThisWeek, isThisMonth } from \"date-fns\";\n\n/**\n * Priority choices for tasks\n * Defined inline as TaskListFilter.tsx does not import from a constants file\n */\nconst PRIORITY_CHOICES = [\n  { id: \"low\", name: \"Low\" },\n  { id: \"medium\", name: \"Medium\" },\n  { id: \"high\", name: \"High\" },\n  { id: \"critical\", name: \"Critical\" },\n];\n\n/**\n * Format date values for chip display\n */\nfunction formatDateLabel(value: unknown): string {\n  if (!value || typeof value !== \"string\") return String(value);\n\n  const date = new Date(value);\n  if (isNaN(date.getTime())) return String(value);\n\n  if (isToday(date)) return \"Today\";\n  if (isThisWeek(date)) return \"This week\";\n  if (isThisMonth(date)) return \"This month\";\n  return format(date, \"MMM d, yyyy\");\n}\n\n/**\n * Dynamic task type choices callback\n * Task types come from ConfigurationContext at runtime\n */\nfunction getTaskTypeChoices(context: unknown): Array<{ id: string; name: string }> {\n  if (context && typeof context === \"object\" && \"taskTypes\" in context) {\n    const taskTypes = (context as { taskTypes: string[] }).taskTypes;\n    return taskTypes.map((type) => ({ id: type, name: type }));\n  }\n  return [];\n}\n\n/**\n * Filter configuration for Tasks list\n *\n * Matches filters available in TaskListFilter.tsx:\n * - due_date@gte/lte: Due date range (PRIMARY - includes \"Overdue\" preset)\n * - completed: Completion status (boolean)\n * - priority: Task priority level\n * - type: Task type (dynamic from ConfigurationContext)\n * - sales_id: Assigned user reference\n *\n * ⚠️ NOTE: Tasks use @gte/@lte format for date filters\n */\nexport const TASK_FILTER_CONFIG = validateFilterConfig([\n  // PRIMARY FILTERS: Due date ranges first\n  {\n    key: \"due_date@gte\",\n    label: \"Due after\",\n    type: \"date-range\",\n    formatLabel: formatDateLabel,\n    removalGroup: \"due_date_range\",\n  },\n  {\n    key: \"due_date@lte\",\n    label: \"Due before\",\n    type: \"date-range\",\n    formatLabel: formatDateLabel,\n    removalGroup: \"due_date_range\",\n  },\n  {\n    key: \"completed\",\n    label: \"Status\",\n    type: \"boolean\",\n    formatLabel: (value: unknown) => (value === true ? \"Completed\" : \"Incomplete\"),\n  },\n  {\n    key: \"priority\",\n    label: \"Priority\",\n    type: \"multiselect\",\n    choices: PRIORITY_CHOICES,\n  },\n  {\n    key: \"type\",\n    label: \"Type\",\n    type: \"multiselect\",\n    // Dynamic choices from ConfigurationContext - callback pattern\n    choices: getTaskTypeChoices,\n  },\n  {\n    key: \"sales_id\",\n    label: \"Assigned To\",\n    type: \"reference\",\n    reference: \"sales\",\n  },\n]);\n","import React from \"react\";\nimport {\n  useUpdate,\n  useNotify,\n  useGetIdentity,\n  useListContext,\n  downloadCSV,\n  type Exporter,\n} from \"ra-core\";\nimport jsonExport from \"jsonexport/dist\";\n\nimport { FunctionField } from \"react-admin\";\nimport { List } from \"@/components/admin/list\";\nimport { StandardListLayout } from \"@/components/layouts/StandardListLayout\";\nimport { PremiumDatagrid } from \"@/components/admin/PremiumDatagrid\";\nimport { BulkActionsToolbar } from \"@/components/admin/bulk-actions-toolbar\";\nimport { TextField } from \"@/components/admin/text-field\";\nimport { DateField } from \"@/components/admin/date-field\";\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { PriorityBadge } from \"@/components/ui/priority-badge\";\nimport { TaskListSkeleton } from \"@/components/ui/list-skeleton\";\nimport { useSlideOverState } from \"@/hooks/useSlideOverState\";\nimport { useFilterCleanup } from \"../hooks/useFilterCleanup\";\nimport { FilterChipBar } from \"../filters\";\nimport { useListKeyboardNavigation } from \"@/hooks/useListKeyboardNavigation\";\nimport { FloatingCreateButton } from \"@/components/admin/FloatingCreateButton\";\nimport { COLUMN_VISIBILITY } from \"../utils/listPatterns\";\nimport { TaskListFilter } from \"./TaskListFilter\";\nimport { TaskSlideOver } from \"./TaskSlideOver\";\nimport { TaskEmpty } from \"./TaskEmpty\";\nimport { SaleName } from \"../sales/SaleName\";\nimport { contactOptionText } from \"../contacts/ContactOption\";\nimport { TASK_FILTER_CONFIG } from \"./taskFilterConfig\";\nimport { PageTutorialTrigger } from \"../tutorial\";\nimport type { Task, Opportunity, Organization } from \"../types\";\n\n/**\n * TaskList - Standard list page for Task records\n *\n * Follows ContactList reference pattern:\n * - Identity-aware rendering with skeleton loading\n * - Keyboard navigation with slide-over integration\n * - BulkActionsToolbar for selection operations\n * - Responsive columns using COLUMN_VISIBILITY semantic presets\n *\n * Special features:\n * - Inline completion checkbox (prevents row click propagation)\n * - Edit mode by default in slide-over (tasks are action items)\n */\nexport default function TaskList() {\n  const { data: identity, isPending: isIdentityPending } = useGetIdentity();\n  const { slideOverId, isOpen, mode, openSlideOver, closeSlideOver, toggleMode } =\n    useSlideOverState();\n\n  // Clean up stale cached filters from localStorage\n  useFilterCleanup(\"tasks\");\n\n  if (isIdentityPending) {\n    return <TaskListSkeleton />;\n  }\n  if (!identity) {\n    return null;\n  }\n\n  return (\n    <>\n      <div data-tutorial=\"tasks-list\">\n        <List\n          title={false}\n          perPage={100}\n          sort={{ field: \"due_date\", order: \"ASC\" }}\n          exporter={exporter}\n        >\n          <TaskListLayout openSlideOver={openSlideOver} isSlideOverOpen={isOpen} />\n          <FloatingCreateButton />\n        </List>\n      </div>\n\n      <TaskSlideOver\n        recordId={slideOverId}\n        isOpen={isOpen}\n        mode={mode}\n        onClose={closeSlideOver}\n        onModeToggle={toggleMode}\n      />\n      <PageTutorialTrigger chapter=\"tasks\" position=\"bottom-left\" />\n    </>\n  );\n}\n\n/**\n * TaskListLayout - Handles loading, empty states, and datagrid rendering\n */\nconst TaskListLayout = ({\n  openSlideOver,\n  isSlideOverOpen,\n}: {\n  openSlideOver: (id: number, mode: \"view\" | \"edit\") => void;\n  isSlideOverOpen: boolean;\n}) => {\n  const { data, isPending, filterValues } = useListContext();\n\n  // Keyboard navigation for list rows\n  // Disabled when slide-over is open to prevent conflicts\n  const { focusedIndex } = useListKeyboardNavigation({\n    onSelect: (id) => openSlideOver(Number(id), \"edit\"),\n    enabled: !isSlideOverOpen,\n  });\n\n  const hasFilters = filterValues && Object.keys(filterValues).length > 0;\n\n  // Show skeleton during initial load\n  if (isPending) {\n    return (\n      <StandardListLayout resource=\"tasks\" filterComponent={<TaskListFilter />}>\n        <TaskListSkeleton />\n      </StandardListLayout>\n    );\n  }\n\n  if (!data?.length && !hasFilters) {\n    return <TaskEmpty />;\n  }\n\n  return (\n    <>\n      <StandardListLayout resource=\"tasks\" filterComponent={<TaskListFilter />}>\n        <FilterChipBar filterConfig={TASK_FILTER_CONFIG} />\n        <PremiumDatagrid\n          onRowClick={(id) => openSlideOver(Number(id), \"edit\")}\n          focusedIndex={focusedIndex}\n        >\n          {/* Column 1: Completion - Inline checkbox (non-sortable) - always visible */}\n          <FunctionField\n            label=\"Done\"\n            sortable={false}\n            render={(record: Task) => <CompletionCheckbox task={record} />}\n            {...COLUMN_VISIBILITY.alwaysVisible}\n          />\n\n          {/* Column 2: Title - Primary identifier (sortable) - always visible */}\n          <TextField source=\"title\" label=\"Title\" {...COLUMN_VISIBILITY.alwaysVisible} />\n\n          {/* Column 3: Due Date - Time-sensitive field (sortable) - always visible */}\n          <DateField\n            source=\"due_date\"\n            label=\"Due Date\"\n            sortable\n            {...COLUMN_VISIBILITY.alwaysVisible}\n          />\n\n          {/* Column 4: Priority - Visual indicator (sortable) - always visible */}\n          <FunctionField\n            label=\"Priority\"\n            sortBy=\"priority\"\n            render={(record: Task) =>\n              record.priority && <PriorityBadge priority={record.priority} />\n            }\n            {...COLUMN_VISIBILITY.alwaysVisible}\n          />\n\n          {/* Column 5: Type - Classification badge (sortable) - hidden on tablet/mobile */}\n          <FunctionField\n            label=\"Type\"\n            sortBy=\"type\"\n            render={(record: Task) => record.type && <Badge variant=\"outline\">{record.type}</Badge>}\n            {...COLUMN_VISIBILITY.desktopOnly}\n          />\n\n          {/* Column 6: Assigned To - Sales reference (sortable) - hidden on tablet/mobile */}\n          <ReferenceField\n            source=\"sales_id\"\n            reference=\"sales\"\n            label=\"Assigned To\"\n            link={false}\n            sortable\n            {...COLUMN_VISIBILITY.desktopOnly}\n          >\n            <SaleName />\n          </ReferenceField>\n\n          {/* Column 7: Contact - Contact reference (non-sortable) - hidden on tablet/mobile */}\n          <ReferenceField\n            source=\"contact_id\"\n            reference=\"contacts_summary\"\n            label=\"Contact\"\n            link={false}\n            sortable={false}\n            {...COLUMN_VISIBILITY.desktopOnly}\n          >\n            <TextField source={contactOptionText} />\n          </ReferenceField>\n\n          {/* Column 8: Opportunity - Opportunity reference (non-sortable) - hidden on tablet/mobile */}\n          <ReferenceField\n            source=\"opportunity_id\"\n            reference=\"opportunities\"\n            label=\"Opportunity\"\n            link={false}\n            sortable={false}\n            {...COLUMN_VISIBILITY.desktopOnly}\n          >\n            <TextField source=\"title\" />\n          </ReferenceField>\n        </PremiumDatagrid>\n      </StandardListLayout>\n      <BulkActionsToolbar />\n    </>\n  );\n};\n\n/**\n * CompletionCheckbox - Inline task completion toggle\n *\n * CRITICAL: Prevents row click propagation to allow independent checkbox interaction.\n * Memoized to prevent re-renders when other rows update.\n */\nconst CompletionCheckbox = React.memo(function CompletionCheckbox({ task }: { task: Task }) {\n  const [update] = useUpdate();\n  const notify = useNotify();\n\n  const handleToggle = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    // Prevent row click\n    e.stopPropagation();\n\n    const checked = e.target.checked;\n\n    try {\n      await update(\"tasks\", {\n        id: task.id,\n        data: {\n          completed: checked,\n          completed_at: checked ? new Date().toISOString() : null,\n        },\n        previousData: task,\n      });\n      notify(checked ? \"Task completed\" : \"Task reopened\", { type: \"success\" });\n    } catch (error) {\n      notify(\"Error updating task\", { type: \"error\" });\n      throw new Error(`Failed to update task ${task.id}: ${error}`);\n    }\n  };\n\n  return (\n    <label className=\"flex items-center justify-center h-11 w-11 cursor-pointer\">\n      <input\n        type=\"checkbox\"\n        checked={task.completed || false}\n        onChange={handleToggle}\n        onClick={(e) => e.stopPropagation()}\n        className=\"h-4 w-4 rounded border-input focus:ring-2 focus:ring-primary focus:ring-offset-2\"\n        aria-label={\n          task.completed ? `Mark \"${task.title}\" as incomplete` : `Mark \"${task.title}\" as complete`\n        }\n      />\n    </label>\n  );\n});\n\n/**\n * CSV exporter for Task records\n */\nconst exporter: Exporter<Task> = async (records, fetchRelatedRecords) => {\n  const opportunities = await fetchRelatedRecords<Opportunity>(\n    records,\n    \"opportunity_id\",\n    \"opportunities\"\n  );\n\n  const organizationIds = Array.from(\n    new Set(\n      opportunities.filter((opp) => opp.organization_id).map((opp) => opp.organization_id as number)\n    )\n  );\n\n  const organizations =\n    organizationIds.length > 0\n      ? await fetchRelatedRecords<Organization>(\n          organizationIds.map((id) => ({ id, organization_id: id })),\n          \"organization_id\",\n          \"organizations\"\n        )\n      : [];\n\n  const oppMap = new Map(opportunities.map((opp) => [opp.id, opp]));\n  const orgMap = new Map(organizations.map((org) => [org.id, org]));\n\n  const dataForExport = records.map((task) => {\n    const opp = task.opportunity_id ? oppMap.get(task.opportunity_id as number) : null;\n    const org = opp?.organization_id ? orgMap.get(opp.organization_id as number) : null;\n\n    return {\n      id: task.id,\n      title: task.title,\n      description: task.description,\n      type: task.type,\n      priority: task.priority,\n      due_date: task.due_date,\n      completed: task.completed ? \"Yes\" : \"No\",\n      completed_at: task.completed_at || \"\",\n      principal: org?.name || \"\",\n      opportunity_id: task.opportunity_id || \"\",\n      contact_id: task.contact_id || \"\",\n      created_at: task.created_at,\n    };\n  });\n\n  jsonExport(\n    dataForExport,\n    {\n      headers: [\n        \"id\",\n        \"title\",\n        \"description\",\n        \"type\",\n        \"priority\",\n        \"due_date\",\n        \"completed\",\n        \"completed_at\",\n        \"principal\",\n        \"opportunity_id\",\n        \"contact_id\",\n        \"created_at\",\n      ],\n    },\n    (err, csv) => {\n      if (err) {\n        throw new Error(`CSV export failed: ${err.message}`);\n      }\n      downloadCSV(csv, \"tasks\");\n    }\n  );\n};\n"],"names":["priorityVariants","low","medium","high","critical","PriorityBadge","priority","className","variant","label","charAt","toUpperCase","slice","jsx","Badge","children","__name","TaskListFilter","data","identity","useGetIdentity","taskTypes","useConfigurationContext","priorityColors","jsxs","FilterLiveForm","SearchInput","source","placeholder","FilterCategory","icon","Calendar","ToggleFilterButton","value","startOfToday","toISOString","endOfToday","addDays","completed","CheckSquare","Star","map","multiselect","Tag","type","Users","sales_id","id","TaskSlideOverDetailsTab","record","mode","onModeToggle","update","useUpdate","notify","useNotify","handleSave","previousData","error","handleCompletionToggle","checked","completed_at","Date","RecordContextProvider","Form","onSubmit","role","TextInput","multiline","rows","SelectInput","choices","name","BooleanInput","ReferenceInput","reference","AutocompleteInput","optionText","contactOptionText","AsideSection","title","Card","CardContent","description","onChange","e","target","DateField","options","dateStyle","year","month","day","reminder_date","ReferenceField","SaleName","created_at","updated_at","TaskRelatedItemsTab","hasRelationships","organization_id","contact_id","opportunity_id","Building2","link","TextField","UserCircle","Target","TaskSlideOver","recordId","isOpen","onClose","tabs","key","component","CheckSquareIcon","LinkIcon","recordRepresentation","ResourceSlideOver","resource","TaskEmpty","appbarHeight","useAppBarHeight","style","height","src","alt","CreateButton","formatDateLabel","String","date","isNaN","getTime","isToday","isThisWeek","isThisMonth","format","getTaskTypeChoices","context","TASK_FILTER_CONFIG","validateFilterConfig","formatLabel","removalGroup","TaskList","isPending","isIdentityPending","slideOverId","openSlideOver","closeSlideOver","toggleMode","useSlideOverState","useFilterCleanup","TaskListSkeleton","Fragment","List","perPage","sort","field","order","exporter","TaskListLayout","isSlideOverOpen","FloatingCreateButton","PageTutorialTrigger","chapter","position","filterValues","useListContext","focusedIndex","useListKeyboardNavigation","onSelect","Number","enabled","hasFilters","Object","keys","length","StandardListLayout","filterComponent","FilterChipBar","filterConfig","PremiumDatagrid","onRowClick","FunctionField","sortable","render","CompletionCheckbox","task","COLUMN_VISIBILITY","alwaysVisible","sortBy","desktopOnly","BulkActionsToolbar","React","memo","handleToggle","stopPropagation","Error","onClick","async","records","fetchRelatedRecords","opportunities","organizationIds","Array","from","Set","filter","opp","organizations","oppMap","Map","orgMap","org","dataForExport","get","due_date","principal","jsonExport","headers","err","csv","message","downloadCSV"],"mappings":"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"}