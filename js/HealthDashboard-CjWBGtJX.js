var e=Object.defineProperty,s=(s,t)=>e(s,"name",{value:t,configurable:!0});import{j as t}from"./chunk-ByJg_QQB.js";import{r}from"./chunk-1NZFT-6z.js";import{l as a,B as l,C as n,a as i,b as c,c as d,d as o}from"../assets/index-BoLku8RR.js";import{P as x}from"./chunk-ChZ4Kv6b.js";import{m,T as u,J as h,x as j,v as f,Z as p,O as g}from"./chunk-Bc6KM1xM.js";import"./chunk-JxeXaC9i.js";import"./chunk-DwAffUXc.js";import"./chunk-knA4lag3.js";import"./chunk-Tyyhsnez.js";import"./chunk-XoqkUGE_.js";import"./chunk-CRKBdUTG.js";const N=.5,v=1;function b(e){return e<N?"green":e<v?"yellow":"red"}function w(e){return e<N?"Healthy":e<v?"Degraded":"Critical"}function y({status:e,label:s}){return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`h-3 w-3 rounded-full ${{green:"bg-success",yellow:"bg-warning",red:"bg-destructive"}[e]} animate-pulse`}),t.jsx("span",{className:"text-sm font-medium",children:s})]})}function k({title:e,value:s,subtitle:r,icon:a,trend:l}){return t.jsxs(n,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(d,{className:"text-sm font-medium",children:e}),t.jsx(a,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(i,{children:[t.jsx("div",{className:"text-2xl font-bold",children:s}),r&&t.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:["up"===l&&t.jsx(g,{className:"h-3 w-3 text-success"}),"down"===l&&t.jsx(g,{className:"h-3 w-3 text-destructive rotate-180"}),r]})]})]})}function R(){const[e,R]=r.useState(null),[S,M]=r.useState(!1),[T,C]=r.useState(null),E=r.useCallback(()=>{M(!0),setTimeout(()=>{const e=a.getMetrics();R(e),C(new Date),M(!1)},300)},[]);if(r.useEffect(()=>{E();const e=setInterval(E,3e4);return()=>clearInterval(e)},[E]),!e)return t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx(m,{className:"h-8 w-8 animate-spin text-muted-foreground"})});const D=b(e.errorRate),H=w(e.errorRate),L=e.errorRate>v,F=e.recentMetrics.filter(e=>"api_latency"===e.name),O=F.length>0?Math.round(F.reduce((e,s)=>e+s.value,0)/F.length):0;return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Health Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor application health and error rates"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[T&&t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Updated ",T.toLocaleTimeString()]}),t.jsxs(l,{variant:"outline",size:"sm",onClick:E,disabled:S,children:[t.jsx(m,{className:"h-4 w-4 mr-2 "+(S?"animate-spin":"")}),"Refresh"]})]})]}),L&&t.jsx(n,{className:"border-destructive bg-destructive/10",children:t.jsxs(i,{className:"flex items-center gap-4 py-4",children:[t.jsx(u,{className:"h-6 w-6 text-destructive"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-semibold text-destructive",children:"High Error Rate Alert"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Error rate (",e.errorRate.toFixed(2),"%) exceeds the 1% threshold. Check Sentry for details."]})]}),t.jsx(l,{variant:"destructive",size:"sm",onClick:s(()=>window.open("https://sentry.io","_blank"),"onClick"),children:"View in Sentry"})]})}),t.jsxs(n,{children:[t.jsx(c,{children:t.jsxs(d,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"System Status"}),t.jsx(y,{status:D,label:H})]})}),t.jsx(i,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{children:"Error Rate"}),t.jsxs("span",{className:"font-medium",children:[e.errorRate.toFixed(2),"%"]})]}),t.jsx(x,{value:Math.min(10*e.errorRate,100),className:"h-2 "+("green"===D?"[&>div]:bg-success":"yellow"===D?"[&>div]:bg-warning":"[&>div]:bg-destructive")}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[t.jsx("span",{children:"0%"}),t.jsx("span",{children:"Target: <1%"}),t.jsx("span",{children:"10%"})]})]})})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsx(k,{title:"Total Requests",value:e.totalRequests.toLocaleString(),subtitle:"Last 60 minutes",icon:h}),t.jsx(k,{title:"Total Errors",value:e.totalErrors.toLocaleString(),subtitle:`${e.errorRate.toFixed(2)}% error rate`,icon:e.totalErrors>0?j:f,trend:e.totalErrors>0?"down":"neutral"}),t.jsx(k,{title:"Avg Latency",value:`${O}ms`,subtitle:F.length>0?`From ${F.length} samples`:"No data",icon:p,trend:O<200?"up":O>500?"down":"neutral"}),t.jsx(k,{title:"Health Score",value:Math.max(0,100-10*e.errorRate).toFixed(0),subtitle:"Out of 100",icon:g,trend:e.errorRate<1?"up":"down"})]}),t.jsxs(n,{children:[t.jsx(c,{children:t.jsx(d,{className:"text-base",children:"Alert Thresholds"})}),t.jsx(i,{children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{variant:"default",className:"bg-success text-success-foreground",children:"Healthy"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["< ",N,"% errors"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{variant:"default",className:"bg-warning text-warning-foreground",children:"Degraded"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[N,"% - ",v,"% errors"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{variant:"destructive",children:"Critical"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["> ",v,"% errors (alert triggered)"]})]})]})})]}),e.recentMetrics.length>0&&t.jsxs(n,{children:[t.jsx(c,{children:t.jsx(d,{className:"text-base",children:"Recent Metrics"})}),t.jsx(i,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 font-medium",children:"Metric"}),t.jsx("th",{className:"text-left py-2 font-medium",children:"Value"}),t.jsx("th",{className:"text-left py-2 font-medium",children:"Tags"}),t.jsx("th",{className:"text-left py-2 font-medium",children:"Time"})]})}),t.jsx("tbody",{children:e.recentMetrics.slice(-10).reverse().map((e,s)=>t.jsxs("tr",{className:"border-b last:border-0",children:[t.jsx("td",{className:"py-2 font-mono text-xs",children:e.name}),t.jsx("td",{className:"py-2",children:e.value}),t.jsx("td",{className:"py-2",children:e.tags?t.jsx("div",{className:"flex gap-1 flex-wrap",children:Object.entries(e.tags).map(([e,s])=>t.jsxs(o,{variant:"outline",className:"text-xs",children:[e,": ",s]},e))}):t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx("td",{className:"py-2 text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString()})]},s))})]})})})]})]})}s(b,"getStatusColor"),s(w,"getStatusText"),s(y,"StatusIndicator"),s(k,"MetricCard"),s(R,"HealthDashboard");export{R as HealthDashboard,R as default};
