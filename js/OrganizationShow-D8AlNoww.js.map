{"version":3,"file":"OrganizationShow-D8AlNoww.js","sources":["../../src/atomic-crm/activity-log/ActivityLogContext.tsx","../../src/atomic-crm/activity-log/ActivityLogOrganizationCreated.tsx","../../src/atomic-crm/activity-log/ActivityLogContactCreated.tsx","../../src/atomic-crm/activity-log/ActivityLogNote.tsx","../../src/atomic-crm/activity-log/ActivityLogContactNoteCreated.tsx","../../src/atomic-crm/activity-log/ActivityLogOpportunityCreated.tsx","../../src/atomic-crm/activity-log/ActivityLogOpportunityNoteCreated.tsx","../../src/atomic-crm/activity-log/ActivityLogIterator.tsx","../../src/atomic-crm/consts.ts","../../src/atomic-crm/activity-log/ActivityLog.tsx","../../src/components/admin/reference-array-field.tsx","../../src/atomic-crm/contacts/TagsList.tsx","../../src/atomic-crm/opportunities/opportunity.ts","../../src/atomic-crm/shared/components/Status.tsx","../../src/atomic-crm/organizations/ActivitiesTab.tsx","../../src/atomic-crm/organizations/OrganizationShow.tsx"],"sourcesContent":["import { createContext, useContext } from \"react\";\n\nexport type activityLogContextValue = \"company\" | \"contact\" | \"opportunity\" | \"all\";\n\nexport const ActivityLogContext = createContext<activityLogContextValue>(\"all\");\n\nexport const useActivityLogContext = () => {\n  const context = useContext(ActivityLogContext);\n\n  return context;\n};\n","import { Link } from \"react-router-dom\";\n\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { OrganizationAvatar } from \"../organizations/OrganizationAvatar\";\nimport { RelativeDate } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport type { ActivityOrganizationCreated } from \"../types\";\nimport { useActivityLogContext } from \"./ActivityLogContext\";\n\ninterface ActivityLogOrganizationCreatedProps {\n  activity: ActivityOrganizationCreated;\n}\n\nexport function ActivityLogOrganizationCreated({ activity }: ActivityLogOrganizationCreatedProps) {\n  const context = useActivityLogContext();\n  const { organization } = activity;\n  return (\n    <div className=\"p-0\">\n      <div className=\"flex flex-row space-x-1 items-center w-full\">\n        <OrganizationAvatar width={20} height={20} record={organization} />\n\n        <div className=\"text-sm text-muted-foreground flex-grow\">\n          <ReferenceField source=\"sales_id\" reference=\"sales\" record={activity}>\n            <SaleName />\n          </ReferenceField>{\" \"}\n          added organization{\" \"}\n          <Link to={`/organizations/${organization.id}/show`}>{organization.name}</Link>\n          {context === \"all\" && (\n            <>\n              <RelativeDate date={activity.date} />\n            </>\n          )}\n        </div>\n        {context === \"organization\" && (\n          <span className=\"text-muted-foreground text-sm\">\n            <RelativeDate date={activity.date} />\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { Link } from \"react-router-dom\";\n\nimport { ReferenceField } from \"@/components/admin/reference-field\";\nimport { Avatar } from \"../contacts/Avatar\";\nimport { RelativeDate } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport type { ActivityContactCreated } from \"../types\";\nimport { formatName } from \"../utils/formatName\";\nimport { useActivityLogContext } from \"./ActivityLogContext\";\n\ninterface ActivityLogContactCreatedProps {\n  activity: ActivityContactCreated;\n}\n\nexport function ActivityLogContactCreated({ activity }: ActivityLogContactCreatedProps) {\n  const context = useActivityLogContext();\n  const { contact } = activity;\n  return (\n    <div className=\"p-0\">\n      <div className=\"flex flex-row gap-2 items-center w-full\">\n        <Avatar width={20} height={20} record={contact} />\n        <span className=\"text-muted-foreground text-sm flex-grow\">\n          <ReferenceField source=\"sales_id\" reference=\"sales\" record={activity}>\n            <SaleName />\n          </ReferenceField>{\" \"}\n          added{\" \"}\n          <Link to={`/contacts/${contact.id}/show`}>\n            {formatName(contact.first_name, contact.last_name)}\n          </Link>{\" \"}\n          {context !== \"company\" && <>to organization {activity.customer_organization_id}</>}\n        </span>\n        {context === \"company\" && (\n          <span className=\"text-muted-foreground text-sm\">\n            <RelativeDate date={activity.date} />\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n","import type { ReactNode } from \"react\";\nimport { Fragment } from \"react\";\n\ninterface ActivityLogContactNoteCreatedProps {\n  header: ReactNode;\n  text: string;\n}\n\nexport function ActivityLogNote({ header, text }: ActivityLogContactNoteCreatedProps) {\n  if (!text) {\n    return null;\n  }\n  const paragraphs = text.split(\"\\n\");\n\n  return (\n    <div className=\"p-0\">\n      <div className=\"flex flex-col space-y-2 w-full\">\n        <div className=\"flex flex-row space-x-1 items-center w-full\">{header}</div>\n        <div>\n          <div className=\"text-sm line-clamp-3 overflow-hidden\">\n            {paragraphs.map((paragraph: string, index: number) => (\n              <Fragment key={index}>\n                {paragraph}\n                {index < paragraphs.length - 1 && <br />}\n              </Fragment>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { ReferenceField } from \"@/components/admin/reference-field\";\nimport { TextField } from \"@/components/admin/text-field\";\nimport { useRecordContext } from \"ra-core\";\nimport { Avatar } from \"../contacts/Avatar\";\nimport { RelativeDate } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport type { ActivityContactNoteCreated, Contact } from \"../types\";\nimport { useActivityLogContext } from \"./ActivityLogContext\";\nimport { ActivityLogNote } from \"./ActivityLogNote\";\n\ninterface ActivityLogContactNoteCreatedProps {\n  activity: ActivityContactNoteCreated;\n}\n\nfunction ContactAvatar() {\n  const record = useRecordContext<Contact>();\n  return <Avatar width={20} height={20} record={record} />;\n}\n\nexport function ActivityLogContactNoteCreated({ activity }: ActivityLogContactNoteCreatedProps) {\n  const context = useActivityLogContext();\n  const { contactNote } = activity;\n  return (\n    <ActivityLogNote\n      header={\n        <div className=\"flex items-center gap-2 w-full\">\n          <ReferenceField source=\"contact_id\" reference=\"contacts\" record={activity.contactNote}>\n            <ContactAvatar />\n          </ReferenceField>\n\n          <div className=\"flex flex-row flex-grow\">\n            <div className=\"text-sm text-muted-foreground flex-grow\">\n              <ReferenceField source=\"sales_id\" reference=\"sales\" record={activity}>\n                <SaleName />\n              </ReferenceField>{\" \"}\n              added a note about{\" \"}\n              <ReferenceField\n                source=\"contact_id\"\n                reference=\"contacts\"\n                record={activity.contactNote}\n              >\n                <TextField source=\"first_name\" /> <TextField source=\"last_name\" />\n              </ReferenceField>\n            </div>\n\n            {context === \"company\" && (\n              <span className=\"text-muted-foreground text-sm\">\n                <RelativeDate date={activity.date} />\n              </span>\n            )}\n          </div>\n        </div>\n      }\n      text={contactNote.text}\n    />\n  );\n}\n","import { Link } from \"react-router-dom\";\n\nimport type { RaRecord } from \"ra-core\";\nimport { RelativeDate } from \"@/components/ui\";\nimport type { ActivityOpportunityCreated } from \"../types\";\nimport { useActivityLogContext } from \"./ActivityLogContext\";\n\ninterface ActivityLogOpportunityCreatedProps {\n  activity: RaRecord & ActivityOpportunityCreated;\n}\n\nexport function ActivityLogOpportunityCreated({ activity }: ActivityLogOpportunityCreatedProps) {\n  const context = useActivityLogContext();\n  const { opportunity } = activity;\n  return (\n    <div className=\"p-0\">\n      <div className=\"flex flex-row space-x-1 items-center w-full\">\n        <div className=\"w-5 h-5 bg-loading-pulse rounded-full\" />\n        <div className=\"text-sm text-muted-foreground flex-grow\">\n          <span className=\"text-muted-foreground text-sm\">Sales ID: {activity.sales_id}</span> added\n          opportunity <Link to={`/opportunities/${opportunity.id}/show`}>{opportunity.name}</Link>{\" \"}\n          {context !== \"company\" && (\n            <>\n              to organization {activity.customer_organization_id}{\" \"}\n              <RelativeDate date={activity.date} />\n            </>\n          )}\n        </div>\n        {context === \"company\" && (\n          <span className=\"text-muted-foreground text-sm\">\n            <RelativeDate date={activity.date} />\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { ReferenceField } from \"@/components/admin/reference-field\";\n\nimport type { RaRecord } from \"ra-core\";\nimport { OrganizationAvatar } from \"../organizations/OrganizationAvatar\";\nimport { RelativeDate } from \"@/components/ui\";\nimport { SaleName } from \"../sales/SaleName\";\nimport type { ActivityOpportunityNoteCreated } from \"../types\";\nimport { useActivityLogContext } from \"./ActivityLogContext\";\nimport { ActivityLogNote } from \"./ActivityLogNote\";\n\ninterface ActivityLogOpportunityNoteCreatedProps {\n  activity: RaRecord & ActivityOpportunityNoteCreated;\n}\n\nexport function ActivityLogOpportunityNoteCreated({\n  activity,\n}: ActivityLogOpportunityNoteCreatedProps) {\n  const context = useActivityLogContext();\n  const { opportunityNote } = activity;\n  return (\n    <ActivityLogNote\n      header={\n        <div className=\"flex flex-row items-center gap-2 flex-grow\">\n          <ReferenceField\n            source=\"opportunity_id\"\n            reference=\"opportunities\"\n            record={opportunityNote}\n            link={false}\n          >\n            <ReferenceField\n              source=\"customer_organization_id\"\n              reference=\"organizations\"\n              link={false}\n            >\n              <OrganizationAvatar width={20} height={20} />\n            </ReferenceField>\n          </ReferenceField>\n\n          <span className=\"text-sm text-muted-foreground flex-grow\">\n            <ReferenceField source=\"sales_id\" reference=\"sales\" record={activity} link={false}>\n              <SaleName />\n            </ReferenceField>{\" \"}\n            added a note about opportunity{\" \"}\n            <ReferenceField\n              source=\"opportunity_id\"\n              reference=\"opportunities\"\n              record={opportunityNote}\n              link=\"show\"\n            />\n            {context !== \"company\" && (\n              <>\n                {\" at \"}\n                <ReferenceField\n                  source=\"opportunity_id\"\n                  reference=\"opportunities\"\n                  record={opportunityNote}\n                  link={false}\n                >\n                  <ReferenceField\n                    source=\"customer_organization_id\"\n                    reference=\"organizations\"\n                    link=\"show\"\n                  />\n                </ReferenceField>{\" \"}\n              </>\n            )}\n          </span>\n\n          {context === \"company\" && (\n            <span className=\"text-muted-foreground text-sm\">\n              <RelativeDate date={activity.date} />\n            </span>\n          )}\n        </div>\n      }\n      text={opportunityNote.text}\n    />\n  );\n}\n","import { Fragment, useState } from \"react\";\nimport { Separator } from \"@/components/ui/separator\";\n\nimport {\n  ORGANIZATION_CREATED,\n  CONTACT_CREATED,\n  CONTACT_NOTE_CREATED,\n  OPPORTUNITY_CREATED,\n  OPPORTUNITY_NOTE_CREATED,\n} from \"../consts\";\nimport type { Activity } from \"../types\";\nimport { ActivityLogOrganizationCreated } from \"./ActivityLogOrganizationCreated\";\nimport { ActivityLogContactCreated } from \"./ActivityLogContactCreated\";\nimport { ActivityLogContactNoteCreated } from \"./ActivityLogContactNoteCreated\";\nimport { ActivityLogOpportunityCreated } from \"./ActivityLogOpportunityCreated\";\nimport { ActivityLogOpportunityNoteCreated } from \"./ActivityLogOpportunityNoteCreated\";\n\ninterface ActivityLogIteratorProps {\n  activities: Activity[];\n  pageSize: number;\n}\n\nexport function ActivityLogIterator({ activities, pageSize }: ActivityLogIteratorProps) {\n  const [activitiesDisplayed, setActivityDisplayed] = useState(pageSize);\n\n  const filteredActivities = activities.slice(0, activitiesDisplayed);\n\n  return (\n    <div className=\"space-y-4\">\n      {filteredActivities.map((activity, index) => (\n        <Fragment key={index}>\n          <ActivityItem key={activity.id} activity={activity} />\n          <Separator />\n        </Fragment>\n      ))}\n\n      {activitiesDisplayed < activities.length && (\n        <button\n          type=\"button\"\n          onClick={() => {\n            setActivityDisplayed((activitiesDisplayed) => activitiesDisplayed + pageSize);\n          }}\n          className=\"flex w-full justify-center text-sm underline hover:no-underline\"\n        >\n          Load more activity\n        </button>\n      )}\n    </div>\n  );\n}\n\nfunction ActivityItem({ activity }: { activity: Activity }) {\n  if (activity.type === ORGANIZATION_CREATED) {\n    return <ActivityLogOrganizationCreated activity={activity} />;\n  }\n\n  if (activity.type === CONTACT_CREATED) {\n    return <ActivityLogContactCreated activity={activity} />;\n  }\n\n  if (activity.type === CONTACT_NOTE_CREATED) {\n    return <ActivityLogContactNoteCreated activity={activity} />;\n  }\n\n  if (activity.type === OPPORTUNITY_CREATED) {\n    return <ActivityLogOpportunityCreated activity={activity} />;\n  }\n\n  if (activity.type === OPPORTUNITY_NOTE_CREATED) {\n    return <ActivityLogOpportunityNoteCreated activity={activity} />;\n  }\n\n  return null;\n}\n","export const ORGANIZATION_CREATED = \"organization.created\" as const;\nexport const CONTACT_CREATED = \"contact.created\" as const;\nexport const CONTACT_NOTE_CREATED = \"contactNote.created\" as const;\nexport const OPPORTUNITY_CREATED = \"opportunity.created\" as const;\nexport const OPPORTUNITY_NOTE_CREATED = \"opportunityNote.created\" as const;\n","import { Alert } from \"@/components/ui/alert\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { Identifier } from \"ra-core\";\nimport { useDataProvider } from \"ra-core\";\n\nimport { ActivitiesService } from \"../services\";\nimport { ActivityLogContext } from \"./ActivityLogContext\";\nimport { ActivityLogIterator } from \"./ActivityLogIterator\";\n\ninterface ActivityLogProps {\n  organizationId?: Identifier;\n  pageSize?: number;\n  context?: \"organization\" | \"contact\" | \"opportunity\" | \"all\";\n}\n\nexport function ActivityLog({ organizationId, pageSize = 20, context = \"all\" }: ActivityLogProps) {\n  const dataProvider = useDataProvider();\n\n  // Create service instance using the base data provider\n  const activitiesService = new ActivitiesService(dataProvider);\n\n  const { data, isPending, error } = useQuery({\n    queryKey: [\"activityLog\", organizationId],\n    queryFn: () => activitiesService.getActivityLog(organizationId),\n  });\n\n  if (isPending) {\n    return (\n      <div className=\"mt-1\">\n        {Array.from({ length: 5 }).map((_, index) => (\n          <div className=\"space-y-2 mt-1\" key={index}>\n            <div className=\"flex flex-row space-x-2 items-center\">\n              <Skeleton className=\"w-5 h-5 rounded-full\" />\n              <Skeleton className=\"w-full h-4\" />\n            </div>\n            <Skeleton className=\"w-full h-12\" />\n            <Separator />\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (error) {\n    return <Alert>Failed to load activity log</Alert>;\n  }\n\n  return (\n    <div data-testid=\"activity-log\">\n      <ActivityLogContext.Provider value={context}>\n        <ActivityLogIterator activities={data} pageSize={pageSize} />\n      </ActivityLogContext.Provider>\n    </div>\n  );\n}\n","import { memo, type ReactElement, type ReactNode } from \"react\";\nimport type { ExtractRecordPaths, HintedString } from \"ra-core\";\nimport {\n  ReferenceArrayFieldBase,\n  useListContext,\n  type FilterPayload,\n  type ListControllerResult,\n  type RaRecord,\n  type SortPayload,\n} from \"ra-core\";\nimport type { UseQueryOptions } from \"@tanstack/react-query\";\nimport { SingleFieldList } from \"@/components/admin/single-field-list\";\n\n/**\n * A container component that fetches records from another resource specified\n * by an array of *ids* in current record.\n *\n * You must define the fields to be passed to the iterator component as children.\n *\n * @example Display all the categories of the current product as a list of chips (the default)\n * // product = {\n * //   id: 456,\n * //   category_ids: [11, 22, 33],\n * // }\n * <ReferenceArrayField label=\"Categories\" reference=\"categories\" source=\"category_ids\"/ >\n *\n * @example Display all the products of the current order as DataTable\n * // order = {\n * //   id: 123,\n * //   product_ids: [456, 457, 458],\n * // }\n * <ReferenceArrayField label=\"Products\" reference=\"products\" source=\"product_ids\">\n *     <DataTable>\n *         <DataTable.Col source=\"id\" />\n *         <DataTable.Col source=\"description\" />\n *         <DataTable.NumberCol source=\"quantity\" options={{ maximumFractionDigits: 0 }} />\n *         <DataTable.Col><EditButton /></DataTable.Col>\n *     </DataTable>\n * </ReferenceArrayField>\n *\n * By default, restricts the displayed values to 1000. You can extend this limit\n * by setting the `perPage` prop.\n *\n * @example\n * <ReferenceArrayField perPage={10} reference=\"categories\" source=\"category_ids\">\n *    ...\n * </ReferenceArrayField>\n *\n * By default, the field displays the results in the order in which they are referenced\n * (i.e. in the order of the list of ids). You can change this order\n * by setting the `sort` prop (an object with `field` and `order` properties).\n *\n * @example\n * <ReferenceArrayField sort={{ field: 'name', order: 'ASC' }} reference=\"categories\" source=\"category_ids\">\n *    ...\n * </ReferenceArrayField>\n *\n * Also, you can filter the results to display only a subset of values. Use the\n * `filter` prop for that.\n *\n * @example\n * <ReferenceArrayField filter={{ is_published: true }} reference=\"categories\" source=\"category_ids\">\n *    ...\n * </ReferenceArrayField>\n */\nexport const ReferenceArrayField = <\n  RecordType extends RaRecord = RaRecord,\n  ReferenceRecordType extends RaRecord = RaRecord,\n>(\n  props: ReferenceArrayFieldProps<RecordType, ReferenceRecordType>\n) => {\n  const {\n    filter,\n    page = 1,\n    perPage,\n    reference,\n    resource,\n    sort,\n    source,\n    queryOptions,\n    render,\n    // Filter out React Admin-specific props that shouldn't be passed to child components\n    label: _label,\n    sortable: _sortable,\n    sortBy: _sortBy,\n    textAlign: _textAlign,\n    rowClassName: _rowClassName,\n    cellClassName: _cellClassName,\n    headerClassName: _headerClassName,\n    ...rest\n  } = props;\n  return (\n    <ReferenceArrayFieldBase\n      filter={filter}\n      page={page}\n      perPage={perPage}\n      reference={reference}\n      resource={resource}\n      sort={sort}\n      source={source}\n      queryOptions={queryOptions}\n      render={render}\n    >\n      <PureReferenceArrayFieldView {...rest} />\n    </ReferenceArrayFieldBase>\n  );\n};\nexport interface ReferenceArrayFieldProps<\n  RecordType extends RaRecord = RaRecord,\n  ReferenceRecordType extends RaRecord = RaRecord,\n> extends ReferenceArrayFieldViewProps {\n  filter?: FilterPayload;\n  page?: number;\n  pagination?: ReactElement;\n  perPage?: number;\n  reference: string;\n  resource?: string;\n  source: NoInfer<HintedString<ExtractRecordPaths<RecordType>>>;\n  sort?: SortPayload;\n  queryOptions?: Omit<UseQueryOptions<ReferenceRecordType[], Error>, \"queryFn\" | \"queryKey\">;\n  render?: (props: ListControllerResult<ReferenceRecordType>) => ReactElement;\n}\n\nexport interface ReferenceArrayFieldViewProps {\n  children?: ReactNode;\n  className?: string;\n  empty?: ReactNode;\n  error?: ReactNode;\n  loading?: ReactNode;\n  pagination?: ReactNode;\n}\n\nexport const ReferenceArrayFieldView = (props: ReferenceArrayFieldViewProps) => {\n  const {\n    children = defaultChildren,\n    className,\n    empty,\n    error: errorElement,\n    loading,\n    pagination,\n  } = props;\n  const { isPending, error, total, hasPreviousPage, hasNextPage, data, filterValues } =\n    useListContext();\n\n  return (\n    <div className={className}>\n      {isPending && loading !== false ? (\n        loading\n      ) : error && errorElement !== false ? (\n        errorElement\n      ) : (total === 0 ||\n          (total == null &&\n            hasPreviousPage === false &&\n            hasNextPage === false &&\n            // @ts-expect-error FIXME total may be undefined when using partial pagination but the ListControllerResult type is wrong about it\n            data.length === 0 &&\n            // the user didn't set any filters\n            !Object.keys(filterValues).length)) &&\n        empty !== false ? (\n        empty\n      ) : (\n        <span>\n          {children}\n          {pagination && total !== undefined ? pagination : null}\n        </span>\n      )}\n    </div>\n  );\n};\n\nconst defaultChildren = <SingleFieldList />;\nconst PureReferenceArrayFieldView = memo(ReferenceArrayFieldView);\n","import { ReferenceArrayField } from \"@/components/admin/reference-array-field\";\nimport { SingleFieldList } from \"@/components/admin/single-field-list\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\nimport { useRecordContext } from \"ra-core\";\nimport { getTagColorClass } from \"../tags/tag-colors\";\n\nconst ColoredBadge = (props: any) => {\n  const record = useRecordContext();\n  if (!record) return null;\n\n  // Filter out React Admin props before spreading to Badge\n  const {\n    source: _source,\n    label: _label,\n    sortable: _sortable,\n    sortBy: _sortBy,\n    textAlign: _textAlign,\n    rowClassName: _rowClassName,\n    cellClassName: _cellClassName,\n    headerClassName: _headerClassName,\n    resource: _resource,\n    ...badgeProps\n  } = props;\n\n  return (\n    <Badge\n      {...badgeProps}\n      variant=\"outline\"\n      className={cn(\"font-normal border-0\", getTagColorClass(record.color), props.className)}\n    >\n      {record.name}\n    </Badge>\n  );\n};\n\nexport const TagsList = () => (\n  <ReferenceArrayField className=\"inline-block\" resource=\"contacts\" source=\"tags\" reference=\"tags\">\n    <SingleFieldList>\n      <ColoredBadge source=\"name\" />\n    </SingleFieldList>\n  </ReferenceArrayField>\n);\n","import type { OpportunityStage } from \"./constants/stageConstants\";\nimport { getOpportunityStageLabel } from \"./constants/stageConstants\";\n\nexport type { OpportunityStage } from \"./constants/stageConstants\";\n\nexport const findOpportunityLabel = (\n  opportunityStages: OpportunityStage[],\n  opportunityValue: string\n) => {\n  // Use centralized stage label lookup instead of array search\n  return getOpportunityStageLabel(opportunityValue);\n};\n\n// Legacy compatibility - use centralized lookup\nexport { findOpportunityLabel as legacyFindOpportunityLabel } from \"./constants/stageConstants\";\n","import { cn } from \"@/lib/utils.ts\";\nimport { useConfigurationContext } from \"../../root/ConfigurationContext\";\n\n/**\n * Maps status value to semantic CSS class for background color\n */\nfunction getStatusBackgroundClass(status: string): string {\n  const statusMap: Record<string, string> = {\n    cold: \"bg-info-default\",\n    warm: \"bg-warning-default\",\n    hot: \"bg-error-default\",\n    \"in-contract\": \"bg-success-default\",\n  };\n  return statusMap[status] || \"bg-muted\";\n}\n\nexport const Status = ({ status, className }: { status: string; className?: string }) => {\n  const { noteStatuses } = useConfigurationContext();\n  if (!status || !noteStatuses) return null;\n  const statusObject = noteStatuses.find((s: any) => s.value === status);\n\n  if (!statusObject) return null;\n  return (\n    <div className={cn(\"group relative inline-block mr-2\", className)}>\n      <span\n        className={cn(\"inline-block w-2.5 h-2.5 rounded-full\", getStatusBackgroundClass(status))}\n      />\n      <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs bg-popover text-popover-foreground border border-border rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10 shadow-sm\">\n        {statusObject.label}\n      </div>\n    </div>\n  );\n};\n","import { useState } from \"react\";\nimport { Plus } from \"lucide-react\";\nimport { useGetList } from \"ra-core\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { QuickLogActivityDialog, ActivityTimelineEntry } from \"../activities\";\nimport type { ActivityRecord } from \"../types\";\nimport { ACTIVITY_PAGE_SIZE } from \"../activities/constants\";\n\ninterface ActivitiesTabProps {\n  organizationId: string | number;\n}\n\nexport const ActivitiesTab = ({ organizationId }: ActivitiesTabProps) => {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n\n  const { data, isPending, error, refetch } = useGetList<ActivityRecord>(\"activities\", {\n    filter: { organization_id: organizationId },\n    sort: { field: \"created_at\", order: \"DESC\" },\n    pagination: { page: 1, perPage: ACTIVITY_PAGE_SIZE },\n  });\n\n  // Convert organizationId to number for the dialog (handles both string and number)\n  const numericOrganizationId =\n    typeof organizationId === \"string\" ? parseInt(organizationId, 10) : organizationId;\n\n  if (isPending) {\n    return (\n      <div className=\"space-y-4\">\n        {[1, 2, 3].map((i) => (\n          <div key={i} className=\"p-4 border border-border rounded-lg\">\n            <Skeleton className=\"h-4 w-32 mb-2\" />\n            <Skeleton className=\"h-3 w-full mb-1\" />\n            <Skeleton className=\"h-3 w-3/4\" />\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (error) {\n    return <div className=\"text-center py-8 text-destructive\">Failed to load activities</div>;\n  }\n\n  const activities = data || [];\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Log Activity button - opens QuickLogActivityDialog pre-filled with organization */}\n      <div className=\"flex justify-end\">\n        <Button variant=\"outline\" className=\"h-11 gap-2\" onClick={() => setIsDialogOpen(true)}>\n          <Plus className=\"h-4 w-4\" />\n          Log Activity\n        </Button>\n      </div>\n\n      {activities.length === 0 ? (\n        <div className=\"text-center py-8 text-muted-foreground\">No activities recorded yet</div>\n      ) : (\n        <div className=\"space-y-3\">\n          {activities.map((activity) => (\n            <ActivityTimelineEntry key={activity.id} activity={activity} />\n          ))}\n        </div>\n      )}\n\n      {/* Activity logging dialog - pre-fills organization */}\n      <QuickLogActivityDialog\n        open={isDialogOpen}\n        onOpenChange={setIsDialogOpen}\n        entityContext={{ organizationId: numericOrganizationId }}\n        config={{\n          enableDraftPersistence: false, // No drafts for slide-over context\n          showSaveAndNew: false, // Single activity at a time\n        }}\n        onSuccess={() => {\n          refetch(); // Refresh the activity list\n        }}\n      />\n    </div>\n  );\n};\n\nexport default ActivitiesTab;\n","/**\n * @deprecated Use OrganizationSlideOver instead.\n * This component will be removed in a future release.\n * See docs/decisions/ADR-005-organization-detail-view.md for migration details.\n *\n * Deprecation Timeline:\n * - Phase A (Current): This deprecation notice\n * - Phase B: Redirect to list with SlideOver\n * - Phase C: Remove this file\n */\n\nimport { formatDistance } from \"date-fns\";\nimport { UserPlus, Briefcase } from \"lucide-react\";\nimport {\n  RecordContextProvider,\n  ShowBase,\n  useListContext,\n  useRecordContext,\n  useShowContext,\n} from \"ra-core\";\nimport { Link as RouterLink, useLocation, useMatch, useNavigate } from \"react-router-dom\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \"@/components/ui/tabs\";\nimport { ReferenceManyField } from \"@/components/admin/reference-many-field\";\nimport { SortButton } from \"@/components/admin/sort-button\";\nimport { ResponsiveGrid } from \"@/components/design-system\";\n\nimport { ActivityLog } from \"../activity-log/ActivityLog\";\nimport { Avatar } from \"../contacts/Avatar\";\nimport { TagsList } from \"../contacts/TagsList\";\nimport { findOpportunityLabel } from \"../opportunities/opportunity\";\nimport { Status } from \"../shared/components/Status\";\nimport { useConfigurationContext } from \"../root/ConfigurationContext\";\nimport type { Company, Contact, Opportunity } from \"../types\";\nimport { formatName } from \"../utils/formatName\";\nimport { OrganizationAside } from \"./OrganizationAside\";\nimport { OrganizationAvatar } from \"./OrganizationAvatar\";\nimport { ActivitiesTab } from \"./ActivitiesTab\";\nimport { AuthorizationsTab } from \"./AuthorizationsTab\";\n\nconst OrganizationShow = () => (\n  <ShowBase>\n    <OrganizationShowContent />\n  </ShowBase>\n);\n\nconst OrganizationShowContent = () => {\n  const { record, isPending } = useShowContext<Company>();\n  const navigate = useNavigate();\n\n  // Get tab from URL or default to \"activity\"\n  const tabMatch = useMatch(\"/organizations/:id/show/:tab\");\n  const currentTab = tabMatch?.params?.tab || \"activity\";\n\n  const handleTabChange = (value: string) => {\n    if (value === currentTab) return;\n    if (value === \"activity\") {\n      navigate(`/organizations/${record?.id}/show`);\n      return;\n    }\n    navigate(`/organizations/${record?.id}/show/${value}`);\n  };\n\n  if (isPending || !record) return null;\n\n  // Check if this organization is a distributor (shows Authorizations tab)\n  const isDistributor = record.organization_type === \"distributor\";\n  // Determine grid columns based on organization type\n  const tabGridCols = isDistributor ? \"grid-cols-5\" : \"grid-cols-4\";\n\n  return (\n    <ResponsiveGrid variant=\"dashboard\" className=\"mt-2 mb-2\">\n      <main role=\"main\" aria-label=\"Organization details\">\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex mb-3\">\n              <OrganizationAvatar />\n              <h2 className=\"text-xl ml-2 flex-1\">{record.name}</h2>\n            </div>\n            <Tabs defaultValue={currentTab} onValueChange={handleTabChange}>\n              <TabsList className={`grid w-full ${tabGridCols}`}>\n                <TabsTrigger value=\"activity\">Activity</TabsTrigger>\n                <TabsTrigger value=\"contacts\">\n                  {record.nb_contacts\n                    ? record.nb_contacts === 1\n                      ? \"1 Contact\"\n                      : `${record.nb_contacts} Contacts`\n                    : \"No Contacts\"}\n                </TabsTrigger>\n                <TabsTrigger value=\"opportunities\">\n                  {record.nb_opportunities\n                    ? record.nb_opportunities === 1\n                      ? \"1 opportunity\"\n                      : `${record.nb_opportunities} opportunities`\n                    : \"No Opportunities\"}\n                </TabsTrigger>\n                <TabsTrigger value=\"activities\">Activities</TabsTrigger>\n                {isDistributor && <TabsTrigger value=\"authorizations\">Authorizations</TabsTrigger>}\n              </TabsList>\n              <TabsContent value=\"activity\" className=\"pt-2\">\n                <ActivityLog organizationId={record.id} context=\"organization\" />\n              </TabsContent>\n              <TabsContent value=\"activities\" className=\"pt-2\">\n                <ActivitiesTab organizationId={record.id} />\n              </TabsContent>\n              <TabsContent value=\"contacts\">\n                {record.nb_contacts ? (\n                  <ReferenceManyField\n                    reference=\"contacts_summary\"\n                    target=\"organization_id\"\n                    sort={{ field: \"last_name\", order: \"ASC\" }}\n                  >\n                    <div className=\"flex flex-col gap-4\">\n                      <div className=\"flex flex-row justify-end space-x-2 mt-1\">\n                        {!!record.nb_contacts && (\n                          <SortButton fields={[\"last_name\", \"first_name\", \"last_seen\"]} />\n                        )}\n                        <CreateRelatedContactButton />\n                      </div>\n                      <ContactsIterator />\n                    </div>\n                  </ReferenceManyField>\n                ) : (\n                  <div className=\"flex flex-col gap-4\">\n                    <div className=\"flex flex-row justify-end space-x-2 mt-1\">\n                      <CreateRelatedContactButton />\n                    </div>\n                  </div>\n                )}\n              </TabsContent>\n              <TabsContent value=\"opportunities\">\n                {record.nb_opportunities ? (\n                  <ReferenceManyField\n                    reference=\"opportunities\"\n                    target=\"customer_organization_id\"\n                    sort={{ field: \"name\", order: \"ASC\" }}\n                  >\n                    <OpportunitiesIterator />\n                  </ReferenceManyField>\n                ) : (\n                  <div className=\"flex flex-col gap-4\">\n                    <div className=\"flex flex-row justify-end space-x-2 mt-1\">\n                      <CreateRelatedOpportunityButton />\n                    </div>\n                  </div>\n                )}\n              </TabsContent>\n              {isDistributor && (\n                <TabsContent value=\"authorizations\" className=\"pt-2\">\n                  <AuthorizationsTab distributorId={record.id} />\n                </TabsContent>\n              )}\n            </Tabs>\n          </CardContent>\n        </Card>\n      </main>\n\n      <aside aria-label=\"Organization information\">\n        <OrganizationAside />\n      </aside>\n    </ResponsiveGrid>\n  );\n};\n\nconst ContactsIterator = () => {\n  const location = useLocation();\n  const { data: contacts, error, isPending } = useListContext<Contact>();\n\n  if (isPending || error) return null;\n\n  const now = Date.now();\n  return (\n    <div className=\"pt-0\">\n      {contacts.map((contact) => (\n        <RecordContextProvider key={contact.id} value={contact}>\n          <div className=\"p-0 text-sm\">\n            <RouterLink\n              to={`/contacts/${contact.id}/show`}\n              state={{ from: location.pathname }}\n              className=\"flex items-center justify-between hover:bg-accent/10 py-2 transition-colors\"\n            >\n              <div className=\"mr-4\">\n                <Avatar />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"font-medium\">\n                  {formatName(contact.first_name, contact.last_name)}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  {contact.title}\n                  {contact.nb_tasks\n                    ? ` - ${contact.nb_tasks} task${contact.nb_tasks > 1 ? \"s\" : \"\"}`\n                    : \"\"}\n                  &nbsp; &nbsp;\n                  <TagsList />\n                </div>\n              </div>\n              {contact.last_seen && (\n                <div className=\"text-right\">\n                  <div className=\"text-sm text-muted-foreground\">\n                    last activity {formatDistance(contact.last_seen, now)} ago{\" \"}\n                    <Status status={contact.status} />\n                  </div>\n                </div>\n              )}\n            </RouterLink>\n          </div>\n        </RecordContextProvider>\n      ))}\n    </div>\n  );\n};\n\nconst CreateRelatedContactButton = () => {\n  const organization = useRecordContext<Company>();\n  return (\n    <Button variant=\"outline\" asChild size=\"sm\" className=\"h-11\">\n      <RouterLink\n        to=\"/contacts/create\"\n        state={organization ? { record: { organization_id: organization.id } } : undefined}\n        className=\"flex items-center gap-2\"\n      >\n        <UserPlus className=\"h-4 w-4\" />\n        Add contact\n      </RouterLink>\n    </Button>\n  );\n};\n\nconst CreateRelatedOpportunityButton = () => {\n  const organization = useRecordContext<Company>();\n  return (\n    <Button variant=\"outline\" asChild size=\"sm\" className=\"h-11\">\n      <RouterLink\n        to=\"/opportunities/create\"\n        state={organization ? { record: { customer_organization_id: organization.id } } : undefined}\n        className=\"flex items-center gap-2\"\n      >\n        <Briefcase className=\"h-4 w-4\" />\n        Add opportunity\n      </RouterLink>\n    </Button>\n  );\n};\n\nconst OpportunitiesIterator = () => {\n  const { data: opportunities, error, isPending } = useListContext<Opportunity>();\n  const { opportunityStages } = useConfigurationContext();\n  if (isPending || error) return null;\n\n  const now = Date.now();\n  return (\n    <div>\n      <div>\n        {opportunities.map((opportunity) => (\n          <div key={opportunity.id} className=\"p-0 text-sm\">\n            <RouterLink\n              to={`/opportunities/${opportunity.id}/show`}\n              className=\"flex items-center justify-between hover:bg-accent/10 py-2 px-4 transition-colors\"\n            >\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"font-medium\">{opportunity.name}</div>\n                <div className=\"text-sm text-muted-foreground\">\n                  {findOpportunityLabel(opportunityStages, opportunity.stage)}\n                  {opportunity.estimated_close_date\n                    ? `, Expected close: ${new Date(\n                        opportunity.estimated_close_date\n                      ).toLocaleDateString(\"en-US\", {\n                        month: \"short\",\n                        day: \"numeric\",\n                        year: \"numeric\",\n                      })}`\n                    : \"\"}\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"text-sm text-muted-foreground\">\n                  last activity {formatDistance(opportunity.updated_at, now)} ago{\" \"}\n                </div>\n              </div>\n            </RouterLink>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport { OrganizationShow };\nexport default OrganizationShow;\n"],"names":["ActivityLogContext","createContext","useActivityLogContext","__name","useContext","ActivityLogOrganizationCreated","activity","context","organization","className","children","jsxs","jsx","OrganizationAvatar","width","height","record","ReferenceField","source","reference","SaleName","Link","to","id","name","Fragment","RelativeDate","date","ActivityLogContactCreated","contact","Avatar","formatName","first_name","last_name","customer_organization_id","ActivityLogNote","header","text","paragraphs","split","map","paragraph","index","length","ContactAvatar","useRecordContext","ActivityLogContactNoteCreated","contactNote","TextField","ActivityLogOpportunityCreated","opportunity","sales_id","ActivityLogOpportunityNoteCreated","opportunityNote","link","ActivityLogIterator","activities","pageSize","activitiesDisplayed","setActivityDisplayed","useState","filteredActivities","slice","ActivityItem","Separator","type","onClick","ActivityLog","organizationId","dataProvider","useDataProvider","activitiesService","ActivitiesService","data","isPending","error","useQuery","queryKey","queryFn","getActivityLog","Array","from","_","Skeleton","Alert","Provider","value","ReferenceArrayField","props","filter","page","perPage","resource","sort","queryOptions","render","label","_label","sortable","_sortable","sortBy","_sortBy","textAlign","_textAlign","rowClassName","_rowClassName","cellClassName","_cellClassName","headerClassName","_headerClassName","rest","ReferenceArrayFieldBase","PureReferenceArrayFieldView","ReferenceArrayFieldView","defaultChildren","empty","errorElement","loading","pagination","total","hasPreviousPage","hasNextPage","filterValues","useListContext","Object","keys","SingleFieldList","memo","ColoredBadge","_source","_resource","badgeProps","Badge","variant","cn","getTagColorClass","color","TagsList","findOpportunityLabel","opportunityStages","opportunityValue","getOpportunityStageLabel","getStatusBackgroundClass","status","cold","warm","hot","Status","noteStatuses","useConfigurationContext","statusObject","find","s","ActivitiesTab","isDialogOpen","setIsDialogOpen","refetch","useGetList","organization_id","field","order","ACTIVITY_PAGE_SIZE","numericOrganizationId","parseInt","i","Button","Plus","ActivityTimelineEntry","QuickLogActivityDialog","open","onOpenChange","entityContext","config","enableDraftPersistence","showSaveAndNew","onSuccess","OrganizationShow","ShowBase","OrganizationShowContent","useShowContext","navigate","useNavigate","tabMatch","useMatch","currentTab","params","tab","handleTabChange","isDistributor","organization_type","tabGridCols","ResponsiveGrid","role","Card","CardContent","Tabs","defaultValue","onValueChange","TabsList","TabsTrigger","nb_contacts","nb_opportunities","TabsContent","ReferenceManyField","target","SortButton","fields","CreateRelatedContactButton","ContactsIterator","OpportunitiesIterator","CreateRelatedOpportunityButton","AuthorizationsTab","distributorId","OrganizationAside","location","useLocation","contacts","now","Date","RecordContextProvider","RouterLink","state","pathname","title","nb_tasks","last_seen","formatDistance","asChild","size","UserPlus","Briefcase","opportunities","stage","estimated_close_date","toLocaleDateString","month","day","year","updated_at"],"mappings":"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"}