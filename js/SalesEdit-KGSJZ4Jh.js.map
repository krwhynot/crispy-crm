{"version":3,"file":"SalesEdit-KGSJZ4Jh.js","sources":["../../src/atomic-crm/sales/SalesEdit.tsx"],"sourcesContent":["import { SimpleForm } from \"@/components/admin/simple-form\";\nimport { CancelButton } from \"@/components/admin/cancel-button\";\nimport { SaveButton } from \"@/components/admin/form\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport {\n  useDataProvider,\n  useEditController,\n  useNotify,\n  useRecordContext,\n  useRedirect,\n} from \"ra-core\";\nimport type { SubmitHandler } from \"react-hook-form\";\nimport { SalesService } from \"../services\";\nimport type { Sale, SalesFormData } from \"../types\";\nimport { formatName } from \"../utils/formatName\";\nimport { SalesInputs } from \"./SalesInputs\";\n\nfunction EditToolbar() {\n  return (\n    <div className=\"flex justify-end gap-4\">\n      <CancelButton />\n      <SaveButton />\n    </div>\n  );\n}\n\nexport default function SalesEdit() {\n  const { record } = useEditController();\n\n  const dataProvider = useDataProvider();\n  const notify = useNotify();\n  const redirect = useRedirect();\n\n  // Create service instance using the base data provider\n  const salesService = new SalesService(dataProvider);\n\n  const { mutate } = useMutation({\n    mutationKey: [\"signup\"],\n    mutationFn: async (data: SalesFormData) => {\n      if (!record) {\n        throw new Error(\"Record not found\");\n      }\n      return salesService.salesUpdate(record.id, data);\n    },\n    onSuccess: () => {\n      redirect(\"/sales\");\n      notify(\"User updated successfully\");\n    },\n    onError: () => {\n      notify(\"An error occurred. Please try again.\");\n    },\n  });\n\n  const onSubmit: SubmitHandler<SalesFormData> = async (data) => {\n    mutate(data);\n  };\n\n  return (\n    <div className=\"max-w-lg w-full mx-auto mt-8\">\n      <Card>\n        <CardContent>\n          <SimpleForm\n            toolbar={<EditToolbar />}\n            onSubmit={onSubmit as SubmitHandler<any>}\n            record={record}\n          >\n            <SaleEditTitle />\n            <SalesInputs />\n          </SimpleForm>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nconst SaleEditTitle = () => {\n  const record = useRecordContext<Sale>();\n  if (!record) return null;\n  return (\n    <h2 className=\"text-lg font-semibold mb-4\">\n      Edit {formatName(record?.first_name, record?.last_name)}\n    </h2>\n  );\n};\n"],"names":["EditToolbar","jsxs","className","children","jsx","CancelButton","SaveButton","SalesEdit","record","useEditController","dataProvider","useDataProvider","notify","useNotify","redirect","useRedirect","salesService","SalesService","mutate","useMutation","mutationKey","mutationFn","data","Error","salesUpdate","id","onSuccess","__name","onError","onSubmit","Card","CardContent","SimpleForm","toolbar","SaleEditTitle","SalesInputs","useRecordContext","formatName","first_name","last_name"],"mappings":"6oBAkBA,SAASA,IACP,SACEC,KAAC,MAAA,CAAIC,UAAU,yBACbC,SAAA,CAAAC,EAAAA,IAACC,EAAA,UACAC,EAAA,CAAA,KAGP,CAEA,SAAwBC,IACtB,MAAMC,OAAEA,GAAWC,IAEbC,EAAeC,IACfC,EAASC,IACTC,EAAWC,IAGXC,EAAe,IAAIC,EAAaP,IAEhCQ,OAAEA,GAAWC,EAAY,CAC7BC,YAAa,CAAC,UACdC,mBAAmBC,IACjB,IAAKd,EACH,MAAM,IAAIe,MAAM,oBAElB,OAAOP,EAAaQ,YAAYhB,EAAOiB,GAAIH,IAJjC,cAMZI,UAAWC,EAAA,KACTb,EAAS,UACTF,EAAO,8BAFE,aAIXgB,QAASD,EAAA,KACPf,EAAO,yCADA,aAKLiB,UAAgDP,IACpDJ,EAAOI,IADsC,YAI/C,aACG,MAAA,CAAIpB,UAAU,+BACbC,SAAAC,EAAAA,IAAC0B,EAAA,CACC3B,eAAC4B,EAAA,CACC5B,SAAAF,EAAAA,KAAC+B,EAAA,CACCC,cAAUjC,EAAA,IACV6B,WACArB,SAEAL,SAAA,CAAAC,EAAAA,IAAC8B,EAAA,UACAC,EAAA,CAAA,WAMb,CAxDSR,EAAA3B,EAAA,eASe2B,EAAApB,EAAA,aAiDxB,MAAM2B,EAAgBP,EAAA,KACpB,MAAMnB,EAAS4B,IACf,OAAK5B,IAEHP,KAAC,KAAA,CAAGC,UAAU,6BAA6BC,SAAA,CAAA,QACnCkC,EAAW7B,GAAQ8B,WAAY9B,GAAQ+B,cAH7B,MAFA"}