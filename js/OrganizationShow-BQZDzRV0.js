var s=Object.defineProperty,t=(t,e)=>s(t,"name",{value:e,configurable:!0});import{j as e,bo as a,bp as n,ay as i,aT as r,bd as o}from"./chunk-DWisBx5Y.js";import{e as c,s as l,L as d,d as m}from"./chunk-CPNr-gD1.js";import{a as x,d as u,O as h,A as j,g as p,h as f,u as v}from"../assets/index-BMLg8LT4.js";import{T as g,a as N,b,c as y}from"./chunk-CQf6o72Z.js";import{R as _}from"./chunk-D5BivTro.js";import{S as k}from"./chunk-B95zjXFR.js";import{T as w}from"./chunk-CsuUTTMk.js";import{f as C}from"./chunk-CL0ACbxq.js";import{S as z}from"./chunk-D3G-UbTO.js";import{O as S}from"./chunk-Ttem0o8C.js";import{a1 as $}from"./chunk-BePsjq0D.js";import{p as A}from"./chunk-DOHniRee.js";import"./chunk-DAbVPE3R.js";import"./chunk-CLB8yy76.js";import"./chunk-8CWr9u5d.js";import"./chunk-DBZxM7AY.js";import"./chunk--io5iQ_d.js";import"./chunk-Caaz7sLq.js";import"./chunk-Ifmr_1lo.js";import"./chunk-DlK383r0.js";import"./chunk-DKgfbnVd.js";import"./chunk-C55trUSB.js";const D=t(()=>e.jsx(a,{children:e.jsx(O,{})}),"OrganizationShow"),O=t(()=>{const{record:s,isPending:a}=n(),i=c(),r=l("/organizations/:id/show/:tab"),o=r?.params?.tab||"activity",d=t(t=>{t!==o&&i("activity"!==t?`/organizations/${s?.id}/show/${t}`:`/organizations/${s?.id}/show`)},"handleTabChange");return a||!s?null:e.jsxs("div",{className:"mt-2 flex pb-2 gap-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx(x,{children:e.jsxs(u,{children:[e.jsxs("div",{className:"flex mb-3",children:[e.jsx(h,{}),e.jsx("h5",{className:"text-xl ml-2 flex-1",children:s.name})]}),e.jsxs(g,{defaultValue:o,onValueChange:d,children:[e.jsxs(N,{className:"grid w-full grid-cols-3",children:[e.jsx(b,{value:"activity",children:"Activity"}),e.jsx(b,{value:"contacts",children:s.nb_contacts?1===s.nb_contacts?"1 Contact":`${s.nb_contacts} Contacts`:"No Contacts"}),s.nb_opportunities?e.jsx(b,{value:"opportunities",children:1===s.nb_opportunities?"1 opportunity":`${s.nb_opportunities} opportunities`}):null]}),e.jsx(y,{value:"activity",className:"pt-2",children:e.jsx(j,{organizationId:s.id,context:"organization"})}),e.jsx(y,{value:"contacts",children:s.nb_contacts?e.jsx(_,{reference:"contacts_summary",target:"organization_id",sort:{field:"last_name",order:"ASC"},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row justify-end space-x-2 mt-1",children:[!!s.nb_contacts&&e.jsx(k,{fields:["last_name","first_name","last_seen"]}),e.jsx(T,{})]}),e.jsx(P,{})]})}):e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex flex-row justify-end space-x-2 mt-1",children:e.jsx(T,{})})})}),e.jsx(y,{value:"opportunities",children:s.nb_opportunities?e.jsx(_,{reference:"opportunities",target:"customer_organization_id",sort:{field:"name",order:"ASC"},children:e.jsx(I,{})}):null})]})]})})}),e.jsx(S,{})]})},"OrganizationShowContent"),P=t(()=>{const s=m(),{data:t,error:a,isPending:n}=r();if(n||a)return null;const i=Date.now();return e.jsx("div",{className:"pt-0",children:t.map(t=>e.jsx(o,{value:t,children:e.jsx("div",{className:"p-0 text-sm",children:e.jsxs(d,{to:`/contacts/${t.id}/show`,state:{from:s.pathname},className:"flex items-center justify-between hover:bg-muted py-2 transition-colors",children:[e.jsx("div",{className:"mr-4",children:e.jsx(f,{})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:`${t.first_name} ${t.last_name}`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.title,t.nb_tasks?` - ${t.nb_tasks} task${t.nb_tasks>1?"s":""}`:"","   ",e.jsx(w,{})]})]}),t.last_seen&&e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["last activity ",A(t.last_seen,i)," ago"," ",e.jsx(z,{status:t.status})]})})]})})},t.id))})},"ContactsIterator"),T=t(()=>{const s=i();return e.jsx(p,{variant:"outline",asChild:!0,size:"sm",className:"h-9",children:e.jsxs(d,{to:"/contacts/create",state:s?{record:{organization_id:s.id}}:void 0,className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Add contact"]})})},"CreateRelatedContactButton"),I=t(()=>{const{data:s,error:t,isPending:a}=r(),{opportunityStages:n}=v();if(a||t)return null;const i=Date.now();return e.jsx("div",{children:e.jsx("div",{children:s.map(s=>e.jsx("div",{className:"p-0 text-sm",children:e.jsxs(d,{to:`/opportunities/${s.id}/show`,className:"flex items-center justify-between hover:bg-muted py-2 px-4 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[C(n,s.stage),","," ",s.amount.toLocaleString("en-US",{notation:"compact",style:"currency",currency:"USD",currencyDisplay:"narrowSymbol",minimumSignificantDigits:3}),s.category?`, ${s.category}`:""]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["last activity ",A(s.updated_at,i)," ","ago"," "]})})]})},s.id))})})},"OpportunitiesIterator");export{D as OrganizationShow,D as default};
