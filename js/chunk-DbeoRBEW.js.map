{"version":3,"file":"chunk-DbeoRBEW.js","sources":["../../src/components/admin/reference-field.tsx"],"sourcesContent":["import type { LinkToType, RaRecord, ExtractRecordPaths } from \"ra-core\";\nimport {\n  ReferenceFieldBase,\n  type UseReferenceFieldControllerResult,\n  useFieldValue,\n  useGetRecordRepresentation,\n  useReferenceFieldContext,\n  useTranslate,\n} from \"ra-core\";\nimport type { MouseEvent, ReactNode } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport type { UseQueryOptions } from \"@tanstack/react-query\";\n\nexport const ReferenceField = <\n  RecordType extends RaRecord = RaRecord,\n  ReferenceRecordType extends RaRecord = RaRecord,\n>(\n  props: ReferenceFieldProps<RecordType, ReferenceRecordType>\n) => {\n  const {\n    loading,\n    error,\n    empty,\n    render,\n    // Filter out React Admin-specific props that shouldn't be passed to child components\n    label: _label,\n    sortable: _sortable,\n    sortBy: _sortBy,\n    textAlign: _textAlign,\n    rowClassName: _rowClassName,\n    cellClassName: _cellClassName,\n    headerClassName: _headerClassName,\n    ...rest\n  } = props;\n  const id = useFieldValue<RecordType>(props);\n  const translate = useTranslate();\n\n  return id == null ? (\n    typeof empty === \"string\" ? (\n      <>{empty && translate(empty, { _: empty })}</>\n    ) : (\n      empty\n    )\n  ) : (\n    <ReferenceFieldBase {...rest}>\n      <ReferenceFieldView<ReferenceRecordType>\n        render={render}\n        loading={loading}\n        error={error}\n        {...rest}\n      />\n    </ReferenceFieldBase>\n  );\n};\n\nexport interface ReferenceFieldProps<\n  RecordType extends RaRecord = RaRecord,\n  ReferenceRecordType extends RaRecord = RaRecord,\n> extends Partial<ReferenceFieldViewProps<ReferenceRecordType>> {\n  children?: ReactNode;\n  queryOptions?: UseQueryOptions<RaRecord[], Error> & {\n    meta?: any;\n  };\n  record?: RecordType;\n  reference: string;\n  translateChoice?: ((record: ReferenceRecordType) => string) | boolean;\n  link?: LinkToType;\n  source: ExtractRecordPaths<RecordType>;\n  // Datagrid column props - passed by Datagrid, filtered internally\n  label?: ReactNode;\n  sortable?: boolean;\n  sortBy?: string;\n  textAlign?: \"left\" | \"center\" | \"right\";\n  cellClassName?: string;\n  headerClassName?: string;\n  rowClassName?: string;\n}\n\n// useful to prevent click bubbling in a datagrid with rowClick\nconst stopPropagation = (e: MouseEvent<HTMLAnchorElement>) => e.stopPropagation();\n\nexport const ReferenceFieldView = <ReferenceRecordType extends RaRecord = RaRecord>(\n  props: ReferenceFieldViewProps<ReferenceRecordType>\n) => {\n  const { children, className, empty, error: errorElement, render, reference, loading } = props;\n  const referenceFieldContext = useReferenceFieldContext();\n  const { error, link, isPending, referenceRecord } = referenceFieldContext;\n  const getRecordRepresentation = useGetRecordRepresentation(reference);\n  const translate = useTranslate();\n\n  if (error && errorElement !== false) {\n    return errorElement;\n  }\n  if (isPending && loading !== false) {\n    return loading;\n  }\n  if (!referenceRecord && empty !== false) {\n    return typeof empty === \"string\" ? <>{empty && translate(empty, { _: empty })}</> : empty;\n  }\n\n  const child = render\n    ? render(referenceFieldContext)\n    : children || <span>{getRecordRepresentation(referenceRecord)}</span>;\n\n  if (link) {\n    return (\n      <div className={className}>\n        <Link to={link} onClick={stopPropagation}>\n          {child}\n        </Link>\n      </div>\n    );\n  }\n\n  return <>{child}</>;\n};\n\nexport interface ReferenceFieldViewProps<ReferenceRecordType extends RaRecord = RaRecord> {\n  children?: ReactNode;\n  className?: string;\n  empty?: ReactNode;\n  loading?: ReactNode;\n  render?: (props: UseReferenceFieldControllerResult) => ReactNode;\n  reference: string;\n  source: string;\n  resource?: string;\n  translateChoice?: ((record: ReferenceRecordType) => string) | boolean;\n  resourceLinkPath?: LinkToType;\n  error?: ReactNode;\n}\n"],"names":["ReferenceField","props","loading","error","empty","render","label","_label","sortable","_sortable","sortBy","_sortBy","textAlign","_textAlign","rowClassName","_rowClassName","cellClassName","_cellClassName","headerClassName","_headerClassName","rest","id","useFieldValue","translate","useTranslate","jsx","Fragment","children","_","ReferenceFieldBase","ReferenceFieldView","stopPropagation","__name","e","className","errorElement","reference","referenceFieldContext","useReferenceFieldContext","link","isPending","referenceRecord","getRecordRepresentation","useGetRecordRepresentation","child","Link","to","onClick"],"mappings":"iMAaO,MAAMA,IAIXC,IAEA,MAAMC,QACJA,EAAAC,MACAA,EAAAC,MACAA,EAAAC,OACAA,EAEAC,MAAOC,EACPC,SAAUC,EACVC,OAAQC,EACRC,UAAWC,EACXC,aAAcC,EACdC,cAAeC,EACfC,gBAAiBC,KACdC,GACDnB,EACEoB,EAAKC,EAA0BrB,GAC/BsB,EAAYC,IAElB,OAAa,MAANH,EACY,iBAAVjB,EACLqB,MAAAC,EAAAA,SAAA,CAAGC,YAASJ,EAAUnB,EAAO,CAAEwB,EAAGxB,MAElCA,EAGFqB,MAACI,EAAA,IAAuBT,EACtBO,SAAAF,EAAAA,IAACK,EAAA,CACCzB,SACAH,UACAC,WACIiB,OApCkB,kBAkExBW,EAAkBC,EAACC,GAAqCA,EAAEF,kBAAxC,mBAEXD,IACX7B,IAEA,MAAM0B,SAAEA,YAAUO,EAAA9B,MAAWA,EAAOD,MAAOgC,EAAA9B,OAAcA,EAAA+B,UAAQA,EAAAlC,QAAWA,GAAYD,EAClFoC,EAAwBC,KACxBnC,MAAEA,EAAAoC,KAAOA,EAAAC,UAAMA,EAAAC,gBAAWA,GAAoBJ,EAC9CK,EAA0BC,EAA2BP,GACrDb,EAAYC,IAElB,GAAIrB,IAA0B,IAAjBgC,EACX,OAAOA,EAET,GAAIK,IAAyB,IAAZtC,EACf,OAAOA,EAET,IAAKuC,IAA6B,IAAVrC,EACtB,MAAwB,iBAAVA,IAAqBqB,IAAAC,EAAAA,SAAA,CAAGC,SAAAvB,GAASmB,EAAUnB,EAAO,CAAEwB,EAAGxB,MAAeA,EAGtF,MAAMwC,EAAQvC,EACVA,EAAOgC,GACPV,GAAYF,MAAC,OAAA,CAAME,SAAAe,EAAwBD,KAE/C,OAAIF,IAEAd,IAAC,MAAA,CAAIS,YACHP,WAAAF,IAACoB,EAAA,CAAKC,GAAIP,EAAMQ,QAAShB,EACtBJ,SAAAiB,wBAMCjB,SAAAiB,KAjCsB"}