var e=Object.defineProperty,t=(t,s)=>e(t,"name",{value:s,configurable:!0});const s={MAX_FILE_SIZE:10485760,MAX_ROWS:1e4,MAX_CELL_LENGTH:1e3,ALLOWED_MIME_TYPES:["text/csv","text/plain","application/vnd.ms-excel"],ALLOWED_EXTENSIONS:[".csv"]};async function r(e){const t=[],r=[];e.size>s.MAX_FILE_SIZE&&t.push({field:"size",message:`File size (${o(e.size)}) exceeds limit of ${o(s.MAX_FILE_SIZE)}`,code:"SIZE"}),0===e.size&&t.push({field:"size",message:"File is empty",code:"SIZE"});s.ALLOWED_EXTENSIONS.some(t=>e.name.toLowerCase().endsWith(t))||t.push({field:"extension",message:`File must have .csv extension. Got: ${e.name}`,code:"MIME"}),e.type&&!s.ALLOWED_MIME_TYPES.includes(e.type)&&r.push(`MIME type "${e.type}" is unusual for CSV. Expected: text/csv`);try{const s=await e.slice(0,1024).text();n(s)&&t.push({field:"content",message:"File appears to be binary, not text. Only CSV text files allowed.",code:"BINARY"}),/[,\t;|]/.test(s)||t.push({field:"structure",message:"File does not appear to be CSV format (no delimiters found)",code:"STRUCTURE"}),/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]/.test(s)&&r.push("File may contain control characters or binary data")}catch{t.push({field:"encoding",message:"Unable to read file. Ensure it is valid UTF-8 encoded text.",code:"ENCODING"})}return{valid:0===t.length,errors:t.length>0?t:void 0,warnings:r.length>0?r:void 0}}function n(e){return["ÿØÿ","PNG","GIF8","","PK","PK","\0\0\0","MZ","ELF","%PDF","ÐÏà"].some(t=>e.startsWith(t))}function i(){return{header:!0,dynamicTyping:!1,skipEmptyLines:!0,preview:s.MAX_ROWS,transformHeader:t(e=>e.trim().toLowerCase().replace(/[^a-z0-9_\s]/g,"_").substring(0,100),"transformHeader"),transform:t((e,t)=>{if("string"!=typeof e)return e;const r=e.trim();return/^[=+\-@\t\r]/.test(r)?"'"+r:r.length>s.MAX_CELL_LENGTH?r.substring(0,s.MAX_CELL_LENGTH)+"...":r},"transform"),error:t(e=>{throw new Error(`CSV parsing failed: ${e.message}`)},"error")}}function a(e){if(!e||"string"!=typeof e)return"";let t=e.trim();return/^[=+\-@\t\r]/.test(t)&&(t="'"+t),t=t.replace(/[\x00-\x1F\x7F]/g,""),t=t.replace(/<[^>]*>/g,""),t.length>s.MAX_CELL_LENGTH&&(t=t.substring(0,s.MAX_CELL_LENGTH)),t}function o(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]}t(r,"validateCsvFile"),t(n,"isBinaryFile"),t(i,"getSecurePapaParseConfig"),t(a,"sanitizeCsvValue"),t(o,"formatBytes");export{i as g,a as s,r as v};
