{"version":3,"file":"ActivityCreate-Bq8DnNNv.js","sources":["../../src/components/admin/form/FormGrid.tsx","../../src/components/admin/form/FormSection.tsx","../../src/atomic-crm/activities/ActivitySinglePage.tsx","../../src/atomic-crm/activities/ActivityCreate.tsx"],"sourcesContent":["import React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface FormGridProps {\n  children: React.ReactNode;\n  columns?: 2 | 4;\n  className?: string;\n}\n\nexport function FormGrid({ children, columns = 2, className }: FormGridProps) {\n  return (\n    <div\n      data-testid=\"form-grid\"\n      className={cn(\n        \"grid\",\n        \"grid-cols-1\",\n        columns === 2 ? \"md:grid-cols-2\" : \"md:grid-cols-4\",\n        \"gap-x-6\",\n        \"gap-y-5\",\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface FormSectionProps {\n  title: string;\n  description?: string;\n  children: React.ReactNode;\n  className?: string;\n}\n\nfunction FormSection({ title, description, children, className }: FormSectionProps) {\n  return (\n    <div data-slot=\"form-section\" className={cn(\"space-y-6\", className)}>\n      <div data-slot=\"form-section-header\" className=\"border-b border-border pb-2\">\n        <h2 className=\"text-xs font-semibold uppercase tracking-wider text-muted-foreground\">\n          {title}\n        </h2>\n        {description && (\n          <p data-slot=\"form-section-description\" className=\"text-muted-foreground text-sm mt-1\">\n            {description}\n          </p>\n        )}\n      </div>\n      <div className=\"mb-6\">{children}</div>\n    </div>\n  );\n}\n\nexport { FormSection };\nexport type { FormSectionProps };\n","import { useState } from \"react\";\nimport { TextInput } from \"@/components/admin/text-input\";\nimport { SelectInput } from \"@/components/admin/select-input\";\nimport { ReferenceInput } from \"@/components/admin/reference-input\";\nimport { AutocompleteInput } from \"@/components/admin/autocomplete-input\";\nimport { FormGrid, FormSection } from \"@/components/admin/form\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\nimport { ChevronDown, ChevronRight } from \"lucide-react\";\nimport { contactOptionText } from \"../contacts/ContactOption\";\nimport { INTERACTION_TYPE_OPTIONS } from \"../validation/activities\";\n\nconst sentimentChoices = [\n  { id: \"positive\", name: \"Positive\" },\n  { id: \"neutral\", name: \"Neutral\" },\n  { id: \"negative\", name: \"Negative\" },\n];\n\nexport default function ActivitySinglePage() {\n  const [followUpOpen, setFollowUpOpen] = useState(false);\n  const [outcomeOpen, setOutcomeOpen] = useState(false);\n\n  return (\n    <div className=\"space-y-6\">\n      <FormSection title=\"Activity Details\">\n        <FormGrid>\n          <div data-tutorial=\"activity-type\">\n            <SelectInput\n              source=\"type\"\n              label=\"Interaction Type\"\n              choices={INTERACTION_TYPE_OPTIONS.map((option) => ({\n                id: option.value,\n                name: option.label,\n              }))}\n              helperText=\"Choose how this interaction occurred\"\n              isRequired\n            />\n          </div>\n        </FormGrid>\n\n        <TextInput\n          source=\"subject\"\n          label=\"Subject\"\n          isRequired\n          helperText=\"Summarize the outcome or topic\"\n        />\n\n        <FormGrid>\n          <TextInput source=\"activity_date\" label=\"Date\" type=\"date\" isRequired />\n          <TextInput\n            source=\"duration_minutes\"\n            label=\"Duration (minutes)\"\n            type=\"number\"\n            helperText=\"Optional length of the activity\"\n          />\n        </FormGrid>\n\n        <div data-tutorial=\"activity-description\">\n          <TextInput\n            source=\"description\"\n            label=\"Notes\"\n            multiline\n            rows={4}\n            helperText=\"Optional narrative for this interaction\"\n          />\n        </div>\n      </FormSection>\n\n      <FormSection title=\"Relationships\">\n        <FormGrid>\n          <div data-tutorial=\"activity-opportunity\">\n            <ReferenceInput source=\"opportunity_id\" reference=\"opportunities\">\n              <AutocompleteInput\n                label=\"Opportunity\"\n                optionText=\"name\"\n                helperText=\"Required for interaction activities\"\n                placeholder=\"Search opportunities\"\n              />\n            </ReferenceInput>\n          </div>\n          <ReferenceInput source=\"contact_id\" reference=\"contacts_summary\">\n            <AutocompleteInput\n              label=\"Contact\"\n              optionText={contactOptionText}\n              helperText=\"Optional contact involved\"\n              placeholder=\"Search contacts\"\n            />\n          </ReferenceInput>\n        </FormGrid>\n\n        <ReferenceInput source=\"organization_id\" reference=\"organizations\">\n          <AutocompleteInput\n            label=\"Organization\"\n            optionText=\"name\"\n            helperText=\"Optional organization context\"\n            placeholder=\"Search organizations\"\n          />\n        </ReferenceInput>\n      </FormSection>\n\n      <Collapsible open={followUpOpen} onOpenChange={setFollowUpOpen}>\n        <CollapsibleTrigger asChild>\n          <button\n            type=\"button\"\n            className=\"flex items-center gap-2 w-full border-b border-border pb-2\"\n            aria-label=\"Follow-up\"\n          >\n            {followUpOpen ? (\n              <ChevronDown className=\"h-4 w-4\" />\n            ) : (\n              <ChevronRight className=\"h-4 w-4\" />\n            )}\n            <h3 className=\"text-xs font-semibold uppercase tracking-wider text-muted-foreground\">\n              Follow-up\n            </h3>\n          </button>\n        </CollapsibleTrigger>\n        <CollapsibleContent className=\"pt-6\">\n          <div className=\"space-y-6\">\n            <FormGrid>\n              <SelectInput\n                source=\"sentiment\"\n                label=\"Sentiment\"\n                choices={sentimentChoices}\n                helperText=\"How did the contact respond?\"\n              />\n            </FormGrid>\n\n            <FormGrid>\n              <TextInput source=\"follow_up_date\" label=\"Follow-up Date\" type=\"date\" />\n              <TextInput\n                source=\"follow_up_notes\"\n                label=\"Follow-up Notes\"\n                multiline\n                rows={3}\n                helperText=\"Optional next steps summary\"\n              />\n            </FormGrid>\n          </div>\n        </CollapsibleContent>\n      </Collapsible>\n\n      <Collapsible open={outcomeOpen} onOpenChange={setOutcomeOpen}>\n        <CollapsibleTrigger asChild>\n          <button\n            type=\"button\"\n            className=\"flex items-center gap-2 w-full border-b border-border pb-2\"\n            aria-label=\"Outcome\"\n          >\n            {outcomeOpen ? (\n              <ChevronDown className=\"h-4 w-4\" />\n            ) : (\n              <ChevronRight className=\"h-4 w-4\" />\n            )}\n            <h3 className=\"text-xs font-semibold uppercase tracking-wider text-muted-foreground\">\n              Outcome\n            </h3>\n          </button>\n        </CollapsibleTrigger>\n        <CollapsibleContent className=\"pt-6\">\n          <div className=\"space-y-6\">\n            <FormGrid>\n              <TextInput source=\"location\" label=\"Location\" helperText=\"Where did this occur?\" />\n              <TextInput source=\"outcome\" label=\"Outcome\" helperText=\"Optional result summary\" />\n            </FormGrid>\n          </div>\n        </CollapsibleContent>\n      </Collapsible>\n    </div>\n  );\n}\n","import { useMemo } from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { CreateBase, Form, useInput, useGetIdentity } from \"ra-core\";\nimport { useFormState } from \"react-hook-form\";\nimport { FormErrorSummary } from \"@/components/admin/FormErrorSummary\";\nimport { FormToolbar } from \"@/atomic-crm/layout/FormToolbar\";\nimport { activitiesSchema } from \"../validation/activities\";\nimport ActivitySinglePage from \"./ActivitySinglePage\";\n\nconst HiddenActivityTypeField = () => {\n  const { field } = useInput({\n    source: \"activity_type\",\n    defaultValue: \"interaction\",\n  });\n\n  return <input type=\"hidden\" {...field} value={field.value ?? \"interaction\"} />;\n};\n\nexport default function ActivityCreate() {\n  const { identity } = useGetIdentity();\n  const defaultValues = useMemo(\n    () => ({\n      ...activitiesSchema.partial().parse({}),\n      // Set current user as creator - ensures proper audit trail\n      created_by: identity?.id,\n    }),\n    [identity?.id]\n  );\n\n  return (\n    <CreateBase redirect=\"list\">\n      <div className=\"bg-muted mt-2 flex justify-center px-6 py-6\">\n        <div className=\"w-full max-w-5xl\">\n          <Form defaultValues={defaultValues}>\n            <Card>\n              <CardContent className=\"space-y-6 p-6\">\n                <ActivityFormContent />\n              </CardContent>\n            </Card>\n          </Form>\n        </div>\n      </div>\n    </CreateBase>\n  );\n}\n\nconst ActivityFormContent = () => {\n  const { errors } = useFormState();\n\n  return (\n    <>\n      <FormErrorSummary errors={errors} />\n      <HiddenActivityTypeField />\n      <ActivitySinglePage />\n      <FormToolbar dataTutorial=\"activity-save-btn\" />\n    </>\n  );\n};\n"],"names":["FormGrid","children","columns","className","jsx","cn","FormSection","title","description","jsxs","__name","sentimentChoices","id","name","ActivitySinglePage","followUpOpen","setFollowUpOpen","useState","outcomeOpen","setOutcomeOpen","SelectInput","source","label","choices","INTERACTION_TYPE_OPTIONS","map","option","value","helperText","isRequired","TextInput","type","multiline","rows","ReferenceInput","reference","AutocompleteInput","optionText","placeholder","contactOptionText","Collapsible","open","onOpenChange","CollapsibleTrigger","asChild","ChevronDown","ChevronRight","CollapsibleContent","HiddenActivityTypeField","field","useInput","defaultValue","ActivityCreate","identity","useGetIdentity","defaultValues","useMemo","activitiesSchema","partial","parse","created_by","CreateBase","redirect","Form","Card","CardContent","ActivityFormContent","errors","useFormState","Fragment","FormErrorSummary","FormToolbar","dataTutorial"],"mappings":"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"}