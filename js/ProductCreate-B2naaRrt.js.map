{"version":3,"file":"ProductCreate-B2naaRrt.js","sources":["../../src/atomic-crm/products/ProductFormTutorial.tsx","../../src/atomic-crm/products/ProductCreate.tsx"],"sourcesContent":["import { useRef, useCallback } from \"react\";\nimport { driver, type DriveStep } from \"driver.js\";\nimport \"driver.js/dist/driver.css\";\nimport { HelpCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\n\n/**\n * Tutorial steps for the Product Create form.\n * Guides users through all 3 tabs and highlights required fields.\n */\nconst FORM_TUTORIAL_STEPS: DriveStep[] = [\n  {\n    popover: {\n      title: \"ðŸ“¦ Create a Product\",\n      description:\n        \"Let's add a new product. Required fields are marked with *. We'll go through each tab.\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-tab-general\"]',\n    popover: {\n      title: \"General Information\",\n      description: \"This tab contains basic product details. Let's start here.\",\n      side: \"bottom\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-name\"]',\n    popover: {\n      title: \"Product Name *\",\n      description: \"Enter the product name. This is how it will appear in searches and reports.\",\n      side: \"right\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-tab-relationships\"]',\n    popover: {\n      title: \"Relationships\",\n      description: \"Click this tab to link the product to organizations.\",\n      side: \"bottom\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-principal\"]',\n    popover: {\n      title: \"Principal/Supplier *\",\n      description: \"Select which principal manufactures this product. Start typing to search.\",\n      side: \"right\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-tab-classification\"]',\n    popover: {\n      title: \"Classification\",\n      description: \"Click this tab to categorize the product.\",\n      side: \"bottom\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-category\"]',\n    popover: {\n      title: \"Category *\",\n      description: \"Choose an F&B category or type to create a custom one.\",\n      side: \"right\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-status\"]',\n    popover: {\n      title: \"Status\",\n      description: \"Set product availability: Active, Coming Soon, or Discontinued.\",\n      side: \"right\",\n      align: \"start\",\n    },\n  },\n  {\n    element: '[data-tutorial=\"product-save-btn\"]',\n    popover: {\n      title: \"Create Product\",\n      description: \"Click to save the product. You'll be taken to the product detail page.\",\n      side: \"top\",\n      align: \"end\",\n    },\n  },\n  {\n    popover: {\n      title: \"âœ… Ready to Go!\",\n      description:\n        \"You now know how to create a product. Fill in the required fields across all tabs and click Create Product.\",\n    },\n  },\n];\n\n/**\n * Standalone tutorial component for the Product Create form.\n * Displays a floating help button that triggers a Driver.js tutorial\n * walking users through all form tabs and fields.\n *\n * Only renders on the /products/create page (where ProductCreate mounts this).\n */\nexport function ProductFormTutorial() {\n  const driverRef = useRef<ReturnType<typeof driver> | null>(null);\n\n  const startTutorial = useCallback(() => {\n    // Clean up any existing instance\n    if (driverRef.current) {\n      driverRef.current.destroy();\n    }\n\n    // Create new Driver.js instance\n    driverRef.current = driver({\n      showProgress: true,\n      animate: true,\n      smoothScroll: true,\n      overlayOpacity: 0.75,\n      popoverClass: \"tutorial-popover\",\n      nextBtnText: \"Next â†’\",\n      prevBtnText: \"â† Back\",\n      doneBtnText: \"Done âœ“\",\n      steps: FORM_TUTORIAL_STEPS,\n      onDestroyStarted: () => {\n        // Cleanup on close\n        driverRef.current?.destroy();\n        driverRef.current = null;\n      },\n    });\n\n    driverRef.current.drive();\n  }, []);\n\n  return (\n    <div className=\"fixed bottom-4 left-4 z-50\">\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            variant=\"default\"\n            size=\"icon\"\n            onClick={startTutorial}\n            className=\"h-11 w-11 rounded-full shadow-lg bg-primary text-primary-foreground hover:scale-105 transition-transform\"\n            aria-label=\"Start product form tutorial\"\n          >\n            <HelpCircle className=\"h-5 w-5\" />\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent side=\"right\">\n          <p>Learn how to create a product</p>\n        </TooltipContent>\n      </Tooltip>\n    </div>\n  );\n}\n","import { CreateBase, Form, useGetIdentity } from \"ra-core\";\nimport { useFormState } from \"react-hook-form\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { CancelButton } from \"@/components/admin/cancel-button\";\nimport { SaveButton } from \"@/components/admin/form\";\nimport { FormErrorSummary } from \"@/components/admin/FormErrorSummary\";\nimport { FormToolbar } from \"@/components/admin/simple-form\";\n\nimport { ProductInputs } from \"./ProductInputs\";\nimport { productSchema } from \"../validation/products\";\nimport { ProductFormTutorial } from \"./ProductFormTutorial\";\n\n// Human-readable field labels for error messages\nconst PRODUCT_FIELD_LABELS: Record<string, string> = {\n  name: \"Product Name\",\n  description: \"Description\",\n  principal_id: \"Principal/Supplier\",\n  category: \"Category\",\n  status: \"Status\",\n};\n\nconst ProductCreate = () => {\n  const { data: identity } = useGetIdentity();\n\n  // Constitution Rule #4: Form state from schema\n  const defaultValues = {\n    ...productSchema.partial().parse({}),\n    created_by: identity?.id,\n  };\n\n  return (\n    <CreateBase redirect=\"show\">\n      <div className=\"bg-muted mt-2 flex lg:mr-72 px-6 py-6\">\n        <div className=\"flex-1\">\n          <Form defaultValues={defaultValues}>\n            <Card>\n              <CardContent>\n                <ProductFormContent />\n              </CardContent>\n            </Card>\n          </Form>\n        </div>\n      </div>\n      <ProductFormTutorial />\n    </CreateBase>\n  );\n};\n\nconst ProductFormContent = () => {\n  const { errors } = useFormState();\n\n  return (\n    <>\n      <FormErrorSummary\n        errors={errors}\n        fieldLabels={PRODUCT_FIELD_LABELS}\n        defaultExpanded={Object.keys(errors).length <= 3}\n      />\n      <ProductInputs />\n      <FormToolbar>\n        <div className=\"flex flex-row gap-2 justify-end\">\n          <CancelButton />\n          <SaveButton label=\"Create Product\" data-tutorial=\"product-save-btn\" />\n        </div>\n      </FormToolbar>\n    </>\n  );\n};\n\nexport { ProductCreate };\nexport default ProductCreate;\n"],"names":["FORM_TUTORIAL_STEPS","popover","title","description","element","side","align","ProductFormTutorial","driverRef","useRef","startTutorial","useCallback","current","destroy","driver","showProgress","animate","smoothScroll","overlayOpacity","popoverClass","nextBtnText","prevBtnText","doneBtnText","steps","onDestroyStarted","__name","drive","jsx","className","children","Tooltip","TooltipTrigger","asChild","Button","variant","size","onClick","HelpCircle","TooltipContent","PRODUCT_FIELD_LABELS","name","principal_id","category","status","ProductCreate","data","identity","useGetIdentity","defaultValues","productSchema","partial","parse","created_by","id","jsxs","CreateBase","redirect","Form","Card","CardContent","ProductFormContent","errors","useFormState","Fragment","FormErrorSummary","fieldLabels","defaultExpanded","Object","keys","length","ProductInputs","FormToolbar","CancelButton","SaveButton","label"],"mappings":"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"}