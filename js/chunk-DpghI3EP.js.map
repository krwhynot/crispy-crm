{"version":3,"file":"chunk-DpghI3EP.js","sources":["../../src/components/admin/FormErrorSummary.tsx"],"sourcesContent":["import { AlertCircle, ChevronDown, ChevronUp } from \"lucide-react\";\nimport { useState } from \"react\";\nimport type { FieldErrors } from \"react-hook-form\";\nimport { cn } from \"@/lib/utils\";\n\ninterface FormErrorSummaryProps {\n  /**\n   * Errors object from react-hook-form's formState.errors\n   */\n  errors: FieldErrors;\n  /**\n   * Optional custom class name\n   */\n  className?: string;\n  /**\n   * Whether to show expanded error list by default\n   * @default false\n   */\n  defaultExpanded?: boolean;\n  /**\n   * Optional field label map for user-friendly error messages\n   * Maps field names to display labels\n   * @example { first_name: \"First Name\", organization_id: \"Organization\" }\n   */\n  fieldLabels?: Record<string, string>;\n}\n\n/**\n * Extracts all error messages from nested react-hook-form errors object.\n * Handles nested objects (like address.city) and arrays (like email[0].value).\n */\nfunction extractErrors(\n  errors: FieldErrors,\n  fieldLabels: Record<string, string> = {},\n  prefix = \"\"\n): Array<{ field: string; message: string }> {\n  const result: Array<{ field: string; message: string }> = [];\n\n  for (const [key, value] of Object.entries(errors)) {\n    const fieldPath = prefix ? `${prefix}.${key}` : key;\n\n    if (value?.message && typeof value.message === \"string\") {\n      // Direct error message\n      const label = fieldLabels[fieldPath] || fieldLabels[key] || formatFieldName(key);\n      result.push({ field: label, message: value.message });\n    } else if (value && typeof value === \"object\") {\n      // Nested errors (objects or arrays)\n      result.push(...extractErrors(value as FieldErrors, fieldLabels, fieldPath));\n    }\n  }\n\n  return result;\n}\n\n/**\n * Converts field_name to \"Field Name\" format\n */\nfunction formatFieldName(field: string): string {\n  return field\n    .replace(/_/g, \" \")\n    .replace(/([a-z])([A-Z])/g, \"$1 $2\")\n    .replace(/\\b\\w/g, (char) => char.toUpperCase())\n    .replace(/Id$/, \"\");\n}\n\n/**\n * FormErrorSummary - Accessible validation error banner for forms\n *\n * Displays a summary banner at the top of forms showing validation errors.\n * Features:\n * - Accessible aria-live region for screen readers\n * - Collapsible error list for forms with many errors\n * - Click to focus on errored field (scrollIntoView)\n * - Semantic error styling with destructive colors\n *\n * @example\n * ```tsx\n * const { formState: { errors } } = useForm();\n *\n * <FormErrorSummary\n *   errors={errors}\n *   fieldLabels={{ first_name: \"First Name\", organization_id: \"Organization\" }}\n * />\n * ```\n */\nexport function FormErrorSummary({\n  errors,\n  className,\n  defaultExpanded = false,\n  fieldLabels = {},\n}: FormErrorSummaryProps) {\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded);\n\n  // Extract all errors from the nested errors object\n  const errorList = extractErrors(errors, fieldLabels);\n\n  // Don't render if no errors\n  if (errorList.length === 0) {\n    return null;\n  }\n\n  const errorCount = errorList.length;\n\n  /**\n   * Attempts to focus and scroll to the field with an error\n   */\n  const focusField = (fieldName: string) => {\n    // Try to find the input by name attribute (react-hook-form pattern)\n    const input = document.querySelector<\n      HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement\n    >(`[name=\"${fieldName}\"], [id=\"${fieldName}\"]`);\n\n    if (input) {\n      input.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\n      input.focus();\n    }\n  };\n\n  return (\n    <div\n      role=\"alert\"\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n      className={cn(\"rounded-lg border border-destructive/50 bg-destructive/10 p-4\", className)}\n    >\n      {/* Header with count and expand toggle */}\n      <div className=\"flex items-center justify-between gap-2\">\n        <div className=\"flex items-center gap-2 text-destructive\">\n          <AlertCircle className=\"h-5 w-5 shrink-0\" aria-hidden=\"true\" />\n          <span className=\"font-medium text-sm\">\n            {errorCount === 1 ? \"1 validation error\" : `${errorCount} validation errors`}\n          </span>\n        </div>\n\n        {errorCount > 1 && (\n          <button\n            type=\"button\"\n            onClick={() => setIsExpanded(!isExpanded)}\n            className=\"flex items-center gap-1 text-xs text-destructive/80 hover:text-destructive transition-colors\"\n            aria-expanded={isExpanded}\n            aria-controls=\"error-list\"\n          >\n            {isExpanded ? (\n              <>\n                Hide details\n                <ChevronUp className=\"h-4 w-4\" />\n              </>\n            ) : (\n              <>\n                Show details\n                <ChevronDown className=\"h-4 w-4\" />\n              </>\n            )}\n          </button>\n        )}\n      </div>\n\n      {/* Error list (collapsible when multiple) */}\n      {(errorCount === 1 || isExpanded) && (\n        <ul\n          id=\"error-list\"\n          className=\"mt-2 space-y-1 text-sm text-destructive/90\"\n          aria-label=\"Form validation errors\"\n        >\n          {errorList.map(({ field, message }, index) => (\n            <li key={`${field}-${index}`} className=\"flex items-start gap-2\">\n              <span className=\"shrink-0\">â€¢</span>\n              <button\n                type=\"button\"\n                onClick={() => focusField(field)}\n                className=\"text-left hover:underline focus:underline focus:outline-none\"\n              >\n                <span className=\"font-medium\">{field}:</span> {message}\n              </button>\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n"],"names":["extractErrors","errors","fieldLabels","prefix","result","key","value","Object","entries","fieldPath","message","label","formatFieldName","push","field","replace","char","toUpperCase","FormErrorSummary","className","defaultExpanded","isExpanded","setIsExpanded","useState","errorList","length","errorCount","focusField","fieldName","input","document","querySelector","scrollIntoView","behavior","block","focus","jsxs","role","cn","children","jsx","AlertCircle","type","onClick","__name","Fragment","ChevronUp","ChevronDown","id","map","index"],"mappings":"4PA+BA,SAASA,EACPC,EACAC,EAAsC,CAAA,EACtCC,EAAS,IAET,MAAMC,EAAoD,GAE1D,IAAA,MAAYC,EAAKC,KAAUC,OAAOC,QAAQP,GAAS,CACjD,MAAMQ,EAAYN,EAAS,GAAGA,KAAUE,IAAQA,EAEhD,GAAIC,GAAOI,SAAoC,iBAAlBJ,EAAMI,QAAsB,CAEvD,MAAMC,EAAQT,EAAYO,IAAcP,EAAYG,IAAQO,EAAgBP,GAC5ED,EAAOS,KAAK,CAAEC,MAAOH,EAAOD,QAASJ,EAAMI,SAC7C,MAAWJ,GAA0B,iBAAVA,GAEzBF,EAAOS,QAAQb,EAAcM,EAAsBJ,EAAaO,GAEpE,CAEA,OAAOL,CACT,CAKA,SAASQ,EAAgBE,GACvB,OAAOA,EACJC,QAAQ,KAAM,KACdA,QAAQ,kBAAmB,SAC3BA,QAAQ,QAAUC,GAASA,EAAKC,eAChCF,QAAQ,MAAO,GACpB,CAsBO,SAASG,GAAiBjB,OAC/BA,EAAAkB,UACAA,EAAAC,gBACAA,GAAkB,EAAAlB,YAClBA,EAAc,CAAA,IAEd,MAAOmB,EAAYC,GAAiBC,EAAAA,SAASH,GAGvCI,EAAYxB,EAAcC,EAAQC,GAGxC,GAAyB,IAArBsB,EAAUC,OACZ,OAAO,KAGT,MAAMC,EAAaF,EAAUC,OAKvBE,IAAcC,IAElB,MAAMC,EAAQC,SAASC,cAErB,UAAUH,aAAqBA,OAE7BC,IACFA,EAAMG,eAAe,CAAEC,SAAU,SAAUC,MAAO,WAClDL,EAAMM,UARS,cAYnB,OACEC,EAAAA,KAAC,MAAA,CACCC,KAAK,QACL,YAAU,SACV,cAAY,OACZlB,UAAWmB,EAAG,gEAAiEnB,GAG/EoB,SAAA,GAAAH,KAAC,MAAA,CAAIjB,UAAU,0CACboB,SAAA,GAAAH,KAAC,MAAA,CAAIjB,UAAU,2CACboB,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAYtB,UAAU,mBAAmB,cAAY,SACtDqB,EAAAA,IAAC,QAAKrB,UAAU,sBACboB,SAAe,MAAI,qBAAuB,GAAGb,2BAIjDA,EAAa,GACZc,EAAAA,IAAC,SAAA,CACCE,KAAK,SACLC,QAASC,EAAA,IAAMtB,GAAeD,GAArB,WACTF,UAAU,+FACV,gBAAeE,EACf,gBAAc,aAEbkB,WACCH,EAAAA,KAAAS,EAAAA,SAAA,CAAEN,SAAA,CAAA,iBAEAC,IAACM,EAAA,CAAU3B,UAAU,eAGvBiB,EAAAA,KAAAS,EAAAA,SAAA,CAAEN,SAAA,CAAA,iBAEAC,IAACO,EAAA,CAAY5B,UAAU,qBAQhB,IAAfO,GAAoBL,IACpBmB,EAAAA,IAAC,KAAA,CACCQ,GAAG,aACH7B,UAAU,6CACV,aAAW,yBAEVoB,SAAAf,EAAUyB,IAAI,EAAGnC,QAAOJ,WAAWwC,MAClCd,KAAC,KAAA,CAA6BjB,UAAU,yBACtCoB,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAKrB,UAAU,WAAWoB,SAAA,MAC3BH,EAAAA,KAAC,SAAA,CACCM,KAAK,SACLC,QAASC,EAAA,IAAMjB,EAAWb,GAAjB,WACTK,UAAU,+DAEVoB,SAAA,GAAAH,KAAC,OAAA,CAAKjB,UAAU,cAAeoB,SAAA,CAAAzB,EAAM,OAAQ,IAAEJ,OAP1C,GAAGI,KAASoC,UAejC,CArJSN,EAAA5C,EAAA,iBA0BA4C,EAAAhC,EAAA,mBA4BOgC,EAAA1B,EAAA"}