var e=Object.defineProperty,r=(r,a)=>e(r,"name",{value:a,configurable:!0});import{a1 as a,ak as l,j as s,al as n,bd as o,bM as i,au as t,v as c}from"./chunk-DWisBx5Y.js";import{r as d}from"./chunk-CPNr-gD1.js";import{u}from"./chunk-DBZxM7AY.js";import{i as m,a9 as p,j as h,k as f,aa as x,v,g as j}from"../assets/index-BMLg8LT4.js";import{v as b}from"./chunk-BePsjq0D.js";const g=r(e=>{const{alwaysOn:t,defaultValue:c,format:j,label:b,helperText:g,name:y,onBlur:k,onChange:N,parse:F,resource:R,source:C,validate:A,readOnly:O,disabled:P,accept:S,maxSize:I,minSize:z,multiple:V=!1,options:L={},children:U,className:B,inputProps:D,onRemove:T,validateFileRemoval:_,placeholder:q,labelMultiple:E="ra.input.file.upload_several",labelSingle:M="ra.input.file.upload_single",removeIcon:G,...H}=e,{onDrop:J}=L,K=a(),Q=r(e=>{if(!(e instanceof File))return e;return{rawFile:e,src:URL.createObjectURL(e),title:e.name}},"transformFile"),W=r(e=>e?Array.isArray(e)?e.map(Q):Q(e):V?[]:null,"transformFiles"),{id:X,field:{onChange:Y,onBlur:Z,value:$,name:ee},isRequired:re}=l({alwaysOn:t,defaultValue:c,format:j||W,label:b,helperText:g,name:y,onBlur:k,onChange:N,parse:F||W,resource:R,source:C,validate:A,readOnly:O,disabled:P}),ae=$?Array.isArray($)?$:[$]:[],le=r((e,r,a)=>{const l=V?[...ae,...e]:[...e];V?(Y(l),Z()):(Y(l[0]),Z()),J&&J(e,r,a)},"onDrop"),se=r(e=>async()=>{if(_)try{await _(e)}catch{return}if(V){const r=ae.filter(r=>!i(r,e));Y(r),Z()}else Y(null),Z();T&&T(e)},"onRemove"),ne=U&&d.isValidElement(d.Children.only(U))?d.Children.only(U):void 0,{getRootProps:oe,getInputProps:ie}=u({accept:S,maxSize:I,minSize:z,multiple:V,disabled:P||O,...L,onDrop:le});return s.jsxs(m,{id:X,name:ee,className:h("w-full",B),...p(H),children:[s.jsx(f,{htmlFor:X,className:P||O?"cursor-default":"cursor-pointer",children:s.jsx(n,{label:b,source:C,resource:R,isRequired:re})}),s.jsxs("div",{...oe({className:h("border-2 border-dashed border-muted rounded-lg p-6 text-center transition-colors","hover:border-sidebar-ring focus:outline-none",P||O?"bg-muted cursor-not-allowed":"bg-muted text-muted-foreground cursor-pointer")}),children:[s.jsx("input",{id:X,name:ee,...ie({...D})}),q||(V?s.jsx("p",{className:"text-sm",children:K(E)}):s.jsx("p",{className:"text-sm",children:K(M)}))]}),s.jsx(x,{helperText:g}),s.jsx(v,{}),U&&s.jsx("div",{className:"previews flex flex-col gap-1",children:ae.map((e,r)=>s.jsx(w,{file:e,onRemove:se(e),removeIcon:G,children:s.jsx(o,{value:e,children:ne})},r))})]})},"FileInput"),w=r(e=>{const{className:r,children:l,file:n,onRemove:o,removeIcon:i=b,...t}=e,c=a();return d.useEffect(()=>()=>{const e=n.rawFile?n.rawFile.preview:n.preview;e&&window.URL.revokeObjectURL(e)},[n]),s.jsxs("div",{className:h("flex flex-row gap-1",r),...t,children:[s.jsx(j,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full shadow-sm cursor-pointer",onClick:o,"aria-label":c("ra.action.delete"),title:c("ra.action.delete"),children:s.jsx(i,{className:"h-4 w-4"})}),l]})},"FileInputPreview"),y=r(e=>{const{className:l,empty:n,title:o,src:i,target:d,download:u,defaultValue:m,source:p,record:f,...x}=e,v=t({defaultValue:m,source:p,record:f}),j=t({...e,source:o})?.toString()??o,b=a();return null==v||Array.isArray(v)&&0===v.length?n?s.jsx("div",{className:h("inline-block",l),...x,children:"string"==typeof n?b(n,{_:n}):n}):null:Array.isArray(v)?s.jsx("ul",{className:h("inline-block",l),...x,children:v.map((e,a)=>{const l=o?c(e,o,o):o,n=i?c(e,i,o):o;return s.jsx("li",{children:s.jsx("a",{href:n,title:l,target:d,download:u,onClick:r(e=>e.stopPropagation(),"onClick"),children:l})},a)})}):s.jsx("div",{className:h("inline-block",l),...x,children:s.jsx("a",{href:v?.toString(),title:j,target:d,download:u,onClick:r(e=>e.stopPropagation(),"onClick"),children:j})})},"FileField");export{g as F,y as a};
