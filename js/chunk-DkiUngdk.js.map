{"version":3,"file":"chunk-DkiUngdk.js","sources":["../../src/lib/genericMemo.ts","../../src/components/admin/date-field.tsx"],"sourcesContent":["import type { FunctionComponent} from \"react\";\nimport { memo } from \"react\";\n\n/**\n * A version of React.memo that preserves the original component type allowing it to accept generics.\n * See {@link https://stackoverflow.com/a/70890101}\n * @deprecated Use genericMemo from \"ra-core\" when available.\n */\nexport function genericMemo<T>(component: T): T {\n  const result = memo(component as FunctionComponent);\n\n  // We have to set the displayName on both the field implementation and the memoized version.\n  // On the implementation so that the memoized version can pick them up and users may reference the defaultProps in their components.\n  // On the memoized version so that components that inspect their children props may read them.\n  // @ts-expect-error: genericMemo does not have a displayName property\n  result.displayName = component.displayName?.replace(\"Impl\", \"\");\n  return result as unknown as T;\n}\n","import type { HTMLAttributes } from \"react\";\nimport { useFieldValue, useTranslate } from \"ra-core\";\n\nimport { genericMemo } from \"@/lib/genericMemo\";\nimport type { FieldProps } from \"@/lib/field.type\";\n\n/**\n * Display a date value as a locale string.\n *\n * Uses Intl.DateTimeFormat() if available, passing the locales and options props as arguments.\n * If Intl is not available, it outputs date as is (and ignores the locales and options props).\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString\n * @example\n * <DateField source=\"published_at\" />\n * // renders the record { id: 1234, published_at: new Date('2012-11-07') } as\n * <span>07/11/2012</span>\n *\n * <DateField source=\"published_at\" className=\"red\" />\n * // renders the record { id: 1234, new Date('2012-11-07') } as\n * <span class=\"red\">07/11/2012</span>\n *\n * <DateField source=\"share\" options={{ weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }} />\n * // renders the record { id: 1234, new Date('2012-11-07') } as\n * <span>Wednesday, November 7, 2012</span>\n *\n * <DateField source=\"created_at\" locales=\"fr-FR\" options={{ weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }} />\n * // renders the record { id: 1234, new Date('2012-11-07') } as\n * <span>mercredi 7 novembre 2012</span>\n */\nconst DateFieldImpl = <RecordType extends Record<string, any> = Record<string, any>>(\n  inProps: DateFieldProps<RecordType>\n) => {\n  const {\n    empty,\n    locales,\n    options,\n    showTime = false,\n    showDate = true,\n    transform = defaultTransform,\n    source,\n    record,\n    defaultValue,\n    // Filter out React Admin-specific props that shouldn't be passed to DOM elements\n    label: _label,\n    sortable: _sortable,\n    sortBy: _sortBy,\n    textAlign: _textAlign,\n    rowClassName: _rowClassName,\n    cellClassName: _cellClassName,\n    headerClassName: _headerClassName,\n    resource: _resource,\n    ...rest\n  } = inProps;\n  const translate = useTranslate();\n\n  if (!showTime && !showDate) {\n    throw new Error(\"<DateField> cannot have showTime and showDate false at the same time\");\n  }\n\n  const value = useFieldValue({ source, record, defaultValue });\n  if (value == null || value === \"\") {\n    if (!empty) {\n      return null;\n    }\n\n    return (\n      <span {...rest}>{typeof empty === \"string\" ? translate(empty, { _: empty }) : empty}</span>\n    );\n  }\n\n  const date = transform(value);\n\n  let dateString = \"\";\n  if (date) {\n    if (showTime && showDate) {\n      dateString = toLocaleStringSupportsLocales\n        ? date.toLocaleString(locales, options)\n        : date.toLocaleString();\n    } else if (showDate) {\n      // If input is a date string (e.g. '2022-02-15') without time and time zone,\n      // force timezone to UTC to fix issue with people in negative time zones\n      // who may see a different date when calling toLocaleDateString().\n      const dateOptions =\n        options ??\n        (typeof value === \"string\" && value.length <= 10 ? { timeZone: \"UTC\" } : undefined);\n      dateString = toLocaleStringSupportsLocales\n        ? date.toLocaleDateString(locales, dateOptions)\n        : date.toLocaleDateString();\n    } else if (showTime) {\n      dateString = toLocaleStringSupportsLocales\n        ? date.toLocaleTimeString(locales, options)\n        : date.toLocaleTimeString();\n    }\n  }\n\n  return <span {...rest}>{dateString}</span>;\n};\nDateFieldImpl.displayName = \"DateFieldImpl\";\n\nexport const DateField = genericMemo(DateFieldImpl);\n\nexport interface DateFieldProps<RecordType extends Record<string, any> = Record<string, any>>\n  extends FieldProps<RecordType>,\n    HTMLAttributes<HTMLSpanElement> {\n  locales?: Intl.LocalesArgument;\n  options?: Intl.DateTimeFormatOptions;\n  showTime?: boolean;\n  showDate?: boolean;\n  transform?: (value: unknown) => Date;\n}\n\nconst defaultTransform = (value: unknown) =>\n  value instanceof Date\n    ? value\n    : typeof value === \"string\" || typeof value === \"number\"\n      ? new Date(value)\n      : undefined;\n\nconst toLocaleStringSupportsLocales = (() => {\n  // from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString\n  try {\n    new Date().toLocaleString(\"i\");\n  } catch (error) {\n    return error instanceof RangeError;\n  }\n  return false;\n})();\n"],"names":["genericMemo","component","result","memo","displayName","replace","__name","DateFieldImpl","inProps","empty","locales","options","showTime","showDate","transform","defaultTransform","source","record","defaultValue","label","_label","sortable","_sortable","sortBy","_sortBy","textAlign","_textAlign","rowClassName","_rowClassName","cellClassName","_cellClassName","headerClassName","_headerClassName","resource","_resource","rest","translate","useTranslate","Error","value","useFieldValue","jsx","children","_","date","dateString","toLocaleStringSupportsLocales","toLocaleString","dateOptions","length","timeZone","toLocaleDateString","toLocaleTimeString","DateField","Date","error","RangeError"],"mappings":"yKAQO,SAASA,EAAeC,GAC7B,MAAMC,EAASC,EAAAA,KAAKF,GAOpB,OADAC,EAAOE,YAAcH,EAAUG,aAAaC,QAAQ,OAAQ,IACrDH,CACT,CATgBI,EAAAN,EAAA,eCsBhB,MAAMO,IACJC,IAEA,MAAMC,MACJA,EAAAC,QACAA,EAAAC,QACAA,EAAAC,SACAA,GAAW,EAAAC,SACXA,GAAW,EAAAC,UACXA,EAAYC,EAAAC,OACZA,EAAAC,OACAA,EAAAC,aACAA,EAEAC,MAAOC,EACPC,SAAUC,EACVC,OAAQC,EACRC,UAAWC,EACXC,aAAcC,EACdC,cAAeC,EACfC,gBAAiBC,EACjBC,SAAUC,KACPC,GACD3B,EACE4B,EAAYC,IAElB,IAAKzB,IAAaC,EAChB,MAAM,IAAIyB,MAAM,wEAGlB,MAAMC,EAAQC,EAAc,CAAExB,SAAQC,SAAQC,iBAC9C,GAAa,MAATqB,GAA2B,KAAVA,EACnB,OAAK9B,IAKHgC,IAAC,OAAA,IAASN,EAAOO,SAAiB,iBAAVjC,EAAqB2B,EAAU3B,EAAO,CAAEkC,EAAGlC,IAAWA,IAJvE,KAQX,MAAMmC,EAAO9B,EAAUyB,GAEvB,IAAIM,EAAa,GACjB,GAAID,EACF,GAAIhC,GAAYC,EACdgC,EAAaC,EACTF,EAAKG,eAAerC,EAASC,GAC7BiC,EAAKG,yBACAlC,EAAU,CAInB,MAAMmC,EACJrC,IACkB,iBAAV4B,GAAsBA,EAAMU,QAAU,GAAK,CAAEC,SAAU,YAAU,GAC3EL,EAAaC,EACTF,EAAKO,mBAAmBzC,EAASsC,GACjCJ,EAAKO,oBACX,MAAWvC,IACTiC,EAAaC,EACTF,EAAKQ,mBAAmB1C,EAASC,GACjCiC,EAAKQ,sBAIb,OAAOX,EAAAA,IAAC,OAAA,IAASN,EAAOO,SAAAG,KAlEJ,iBAoEtBtC,EAAcH,YAAc,gBAErB,MAAMiD,EAAYrD,EAAYO,GAY/BQ,EAAmBT,EAACiC,GACxBA,aAAiBe,KACbf,EACiB,iBAAVA,GAAuC,iBAAVA,EAClC,IAAIe,KAAKf,QACT,EALiB,oBAOnBO,QAEJ,KACE,IAAIQ,MAAOP,eAAe,IAC5B,OAASQ,GACP,OAAOA,aAAiBC,UAC1B,CACA,OAAO,CACT"}