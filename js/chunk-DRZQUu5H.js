var e=Object.defineProperty,a=(a,s)=>e(a,"name",{value:s,configurable:!0});import{aF as s,G as n,l as o,aG as r,av as l,ae as i,j as t,H as u}from"./chunk-ByJg_QQB.js";import{r as c}from"./chunk-1NZFT-6z.js";import{F as d,H as p,bs as f,d as h,I as m,J as x}from"../assets/index-BoLku8RR.js";import{C as g,_ as v,b,d as j,e as k}from"./chunk-CMQLDEz_.js";import{X as w}from"./chunk-Bc6KM1xM.js";const y=a(e=>{const{filterToQuery:y=C,inputText:N}=e,{allChoices:D=[],source:F,resource:T,isFromReference:V,setFilters:R}=s(e),{id:S,field:M,isRequired:q}=n({...e,source:F}),A=o(),{placeholder:B=A("ra.action.search",{_:"Search..."})}=e,I=r(T),{getChoiceText:K,getChoiceValue:P}=l({optionText:e.optionText??(V?I:"name"),optionValue:e.optionValue??"id",disableValue:e.disableValue,translateChoice:e.translateChoice??!V}),_=c.useRef(null),[E,G]=c.useState(!1),H=i(e=>{M.onChange(M.value.filter(a=>a!==P(e)))}),Q=i(e=>{const a=_.current;a&&("Delete"!==e.key&&"Backspace"!==e.key||""===a.value&&M.onChange(M.value.slice(0,-1)),"Escape"===e.key&&a.blur())}),z=D.filter(e=>!M.value.includes(P(e))),J=D.filter(e=>M.value.includes(P(e))),[O,L]=c.useState(""),U=c.useCallback(e=>"function"==typeof N?N(e):void 0!==N?N:K(e),[N,K]);return t.jsxs(d,{className:e.className,id:S,name:M.name,children:[!1!==e.label&&t.jsx(p,{children:t.jsx(u,{label:e.label,source:e.source??F,resource:T,isRequired:q})}),t.jsx(f,{children:t.jsxs(g,{onKeyDown:Q,shouldFilter:!V,className:"overflow-visible bg-transparent",children:[t.jsx("div",{className:"group rounded-md bg-transparent dark:bg-input/30 border border-input px-3 py-1.75 text-sm transition-all ring-offset-background focus-within:border-ring focus-within:ring-ring/50 focus-within:ring-[3px] aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40",children:t.jsxs("div",{className:"flex flex-wrap gap-1",children:[J.map(e=>t.jsxs(h,{variant:"outline",children:[U(e),t.jsxs("button",{className:"ml-1 rounded-full outline-none ring-offset-background focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:a(a=>{"Enter"===a.key&&H(e)},"onKeyDown"),onMouseDown:a(e=>{e.preventDefault(),e.stopPropagation()},"onMouseDown"),onClick:a(a=>{a.preventDefault(),H(e)},"onClick"),children:[t.jsx("span",{className:"sr-only",children:A("ra.action.remove",{_:"Remove"})}),t.jsx(w,{className:"h-3 w-3"})]})]},P(e))),t.jsx(v.Input,{ref:_,value:O,onValueChange:a(e=>{L(e),V&&R(y(e),void 0,!0)},"onValueChange"),onBlur:a(()=>G(!1),"onBlur"),onFocus:a(()=>G(!0),"onFocus"),placeholder:B,className:"ml-2 flex-1 bg-transparent outline-none placeholder:text-muted-foreground"})]})}),t.jsx("div",{className:"relative",children:t.jsx(b,{children:E&&z.length>0?t.jsx("div",{className:"absolute top-2 z-10 w-full rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in",children:t.jsx(j,{className:"h-full overflow-auto",children:z.map(e=>t.jsx(k,{onMouseDown:a(e=>{e.preventDefault(),e.stopPropagation()},"onMouseDown"),onSelect:a(()=>{L(""),V&&R(y("")),M.onChange([...M.value,P(e)])},"onSelect"),className:"cursor-pointer",children:K(e)},P(e)))})}):null})})]})}),t.jsx(m,{helperText:e.helperText}),t.jsx(x,{})]})},"AutocompleteArrayInput"),C=a(e=>({q:e}),"DefaultFilterToQuery");export{y as A};
